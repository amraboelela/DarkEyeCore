<!DOCTYPE html>
<html lang="was" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>cracks:snippets [Wizardry and Steamworks]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="cracks,snippets"/>
<link rel="search" type="application/opensearchdescription+xml" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/opensearch.php" title="Wizardry and Steamworks"/>
<link rel="start" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/"/>
<link rel="contents" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets?do=index" title="Sitemap"/>
<link rel="manifest" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Changes" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/feed.php?mode=list&amp;ns=cracks"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_export/xhtml/cracks/snippets"/>
<link rel="canonical" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets"/>
<link rel="stylesheet" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/css.php?t=was&amp;tseed=24551d22639bdaeb736aec3dca86fd82"/>
<!--[if gte IE 9]><!-->
<script >/*<![CDATA[*/var NS='cracks';var JSINFO = {"plugin_imagemap_mldummy":"http:\/\/3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion\/_media\/wiki\/dokuwiki-128.png","isadmin":0,"isauth":0,"plugin_pdfjs":{"hide_download_button":0},"plugins":{"vshare":{"youtube":"youtube\\.com\/.*[&?]v=([a-z0-9_\\-]+)","vimeo":"vimeo\\.com\\\/(\\d+)","slideshare":"slideshare.*id=(\\d+)","dailymotion":"dailymotion\\.com\/video\/([a-z0-9]+)","archiveorg":"archive\\.org\/(?:embed|details)\/([a-zA-Z0-9_\\-]+)","soundcloud":"soundcloud\\.com\/([\\w-]+\/[\\w-]+)","niconico":"nicovideo\\.jp\/watch\/(sm[0-9]+)","bitchute":"bitchute\\.com\\\/video\\\/([a-zA-Z0-9_\\-]+)","coub":"coub\\.com\\\/view\\\/([a-zA-Z0-9_\\-]+)","odysee":"odysee\\.com\/\\$\/(?:embed|download)\/([-%_?=\/a-zA-Z0-9]+)","youku":"v\\.youku\\.com\/v_show\/id_([0-9A-Za-z=]+)\\.html","bilibili":"bilibili\\.com\\\/video\\\/(BV[0-9A-Za-z]+)","msoffice":"(?:office\\.com.*[&?]videoid=([a-z0-9\\-]+))","msstream":"microsoftstream\\.com\\\/video\\\/([a-f0-9\\-]{36})"}},"id":"cracks:snippets","namespace":"cracks","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script charset="utf-8" src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/jquery.php?tseed=34a552433bc33cc9c3bc32527289a0b2"></script>
<script charset="utf-8" src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/js.php?t=was&amp;tseed=24551d22639bdaeb736aec3dca86fd82&amp;template=was"></script>
<!--<![endif]-->
    <!-- <link rel="shortcut icon" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/favicon.ico" />
<link rel="apple-touch-icon" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/apple-touch-icon.png" />
 -->
    <!-- Viewport -->
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!-- Favicon -->
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png?v=2">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png?v=2">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png?v=2">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png?v=2">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png?v=2">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png?v=2">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png?v=2">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png?v=2">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png?v=2">
<link rel="icon" type="image/png" href="/favicon-32x32.png?v=2" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png?v=2" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png?v=2" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png?v=2" sizes="16x16">
<link rel="manifest" href="/manifest.json?v=2">
<link rel="shortcut icon" href="/favicon.ico?v=2">
<meta name="apple-mobile-web-app-title" content="[Wizardry and Steamworks]">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png?v=2">
<meta name="application-name" content="[Wizardry and Steamworks]">
<meta name="theme-color" content="#ffffff">
    <!-- <script async type="text/javascript" src="/lib/tpl/was/loadCSS.js"></script>
    <script async type="text/javascript" src="/lib/tpl/was/cssrelpreload.js"></script> -->
</head>

<body>
    <!--[if lte IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_was     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header">

	    
	<!-- ********** TOP BAR ********** -->
	<div class="bar" id="bar__top">
		<div class="bar-left" id="bar__topleft">
			<form class="button btn_login" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="" /><button type="submit" title="Log In">Log In</button></div></form>						<form class="button btn_revs" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets"><div class="no"><input type="hidden" name="do" value="revisions" /><button type="submit" accesskey="o" title="Revisions [O]">Revisions</button></div></form>						<form class="button btn_pdf" action="?do=export_pdf" method="POST">
			    <button type="submit" title="PDF">PDF</button>
                        </form>
		</div>
		<div class="bar-center">
		        <form class="button btn_home" action="/" method="POST">
                            <button type="submit" title="Home">Home</button>
                        </form>
			<form action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="cracks:snippets" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			<!-- <form id="osssearchform" method="get" action="renderer">
        <input type="hidden" name="use" value="grimore.org">
        <input type="hidden" name="name" value="default">
        <input type="text" id="osssearchbox" name="query">
        <input type="hidden" name="login" value="search">
        <input type="hidden" name="key" value="1a5f74ab3f4df6ce883c4c158540e25e">
        <input type="submit" value="Search">
</form>
 -->
		</div>
		<div class="bar-right" id="bar__topright">
		        <form class="button btn_contact" action="mailto:%6F%66%66%69%63%65%40%67%72%69%6D%6F%72%65%2E%6F%72%67" method="POST">
			    <button type="submit" title="Contact">Contact</button>
                        </form>
                        <form class="button btn_news" action="/feed.php?type=rss2&amp;ns=cracks:snippets&amp;linkto=page&amp;content=abstract" method="POST">
			    <button type="submit" title="News">News</button>
                        </form>
			<form class="button btn_admin" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets"><div class="no"><input type="hidden" name="do" value="admin" /><button type="submit" title="Admin">Admin</button></div></form>								</div>
			</div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks" class="wikilink1" title="cracks" data-wiki-id="cracks">cracks</a></bdi> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets" class="wikilink1" title="cracks:snippets" data-wiki-id="cracks:snippets">snippets</a></bdi></div>
                                </div>
    
    <hr class="a11y" />
</div><!-- /header -->

        <div class="wrapper group">

            <!--  -->

            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <!-- <div class="pageId"><span>cracks:snippets</span></div> -->

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc" class="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#shortnote">Shortnote</a></div></li>
<li class="level1"><div class="li"><a href="#endless_trial">Endless Trial</a></div></li>
<li class="level1"><div class="li"><a href="#on_launch_license_check">On Launch License Check</a></div></li>
<li class="level1"><div class="li"><a href="#disable_trial_start_and_stop_timer">Disable Trial Start and Stop Timer</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#start">Start</a></div></li>
<li class="level2"><div class="li"><a href="#stop">Stop</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#getting_rid_of_the_registration_menu">Getting Rid of the Registration Menu</a></div></li>
<li class="level1"><div class="li"><a href="#registration_menu">Registration Menu</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="shortnote">Shortnote</h1>
<div class="level1">

<p>
Snippets is a snippet manager that allows you to search previous snippets and then paste them conveniently using a spotlight-like search bar. The application costs USD15 and it is fairly poor in features and easily replaced by <a href="http://www.clipmenu.com/" class="urlextern" title="http://www.clipmenu.com/" rel="ugc nofollow">ClipMenu</a>.
</p>

<p>
The difference between Snippets and ClipMenu is that Snippets costs money and offers less and obtrusive features compared to ClipMenu. There is no reason to use Snippets over ClipMenu. After we cracked Snippets, we threw it into the trash, where it belongs, after a few minutes of use.
</p>

<p>
The copy-protection is also insanely easy to circumvent. When the application starts it triggers a few trial-based checks based on boolean calls such as <code>isTrial</code>.
</p>

</div>

<h1 class="sectionedit2" id="endless_trial">Endless Trial</h1>
<div class="level1">

<p>
Insanely easy, just find <code>updateTrialControls</code> and shortwire the procedure so it does nothing. We just jump from <code>0x1000072b0</code> to <code>0x10000746a</code> where the procedure just returns. The trial stuff is never even activated.
</p>
<pre class="code asm">                                            methImpl_MainWindowController_updateTrialControls<span class="sy1">:</span>
<span class="co2">00000001</span>000072a1 <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">rbp</span>
<span class="co2">00000001</span>000072a2 <span class="nu0">4889E5</span>                          <span class="kw1">mov</span>        <span class="kw4">rbp</span><span class="sy1">,</span> <span class="kw4">rsp</span>
<span class="co2">00000001</span>000072a5 <span class="nu0">4157</span>                            <span class="kw1">push</span>       <span class="kw4">r15</span>
<span class="co2">00000001</span>000072a7 <span class="nu0">4156</span>                            <span class="kw1">push</span>       <span class="kw4">r14</span>
<span class="co2">00000001</span>000072a9 <span class="nu0">4154</span>                            <span class="kw1">push</span>       <span class="kw4">r12</span>
<span class="co2">00000001</span>000072ab <span class="nu0">53</span>                              <span class="kw1">push</span>       <span class="kw4">rbx</span>
<span class="co2">00000001</span>000072ac 4883EC10                        <span class="kw1">sub</span>        <span class="kw4">rsp</span><span class="sy1">,</span> <span class="nu0">0x10</span>
<span class="co2">00000001</span>000072b0 E9B5010000                      <span class="kw1">jmp</span>        <span class="nu0">0x10000746a</span>
<span class="sy1">...</span>
<span class="co2">00000001</span>0000746a 4883C410                        <span class="kw1">add</span>        <span class="kw4">rsp</span><span class="sy1">,</span> <span class="nu0">0x10</span>                     <span class="co1">; XREF=0x1000072ec, 0x10000732d, 0x1000072b0</span>
<span class="co2">00000001</span>0000746e 5B                              <span class="kw1">pop</span>        <span class="kw4">rbx</span>
<span class="co2">00000001</span><span class="nu0">0000746f</span> 415C                            <span class="kw1">pop</span>        <span class="kw4">r12</span>
<span class="co2">00000001</span><span class="nu0">00007471</span> 415E                            <span class="kw1">pop</span>        <span class="kw4">r14</span>
<span class="co2">00000001</span><span class="nu0">00007473</span> <span class="nu0">415F</span>                            <span class="kw1">pop</span>        <span class="kw4">r15</span>
<span class="co2">00000001</span><span class="nu0">00007475</span> 5D                              <span class="kw1">pop</span>        <span class="kw4">rbp</span>
<span class="co2">00000001</span><span class="nu0">00007476</span> C3                              <span class="kw1">ret</span></pre>

<p>
That&#039;s it (yes, really) for version 1.4.1, it just doesn&#039;t even warrant the effort to be cracked . . .
</p>

</div>

<h1 class="sectionedit3" id="on_launch_license_check">On Launch License Check</h1>
<div class="level1">

<p>
This is not necessary, but let&#039;s skip some of the checks when the application starts up. We jump at <code>0x100003540</code> over the date-check.
</p>
<pre class="code asm">                                            methImpl_AppDelegate_applicationDidFinishLaunching_<span class="sy1">:</span>
<span class="co2">00000001</span>0000351d <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">rbp</span>
<span class="co2">00000001</span>0000351e <span class="nu0">4889E5</span>                          <span class="kw1">mov</span>        <span class="kw4">rbp</span><span class="sy1">,</span> <span class="kw4">rsp</span>
<span class="co2">00000001</span><span class="nu0">00003521</span> <span class="nu0">4156</span>                            <span class="kw1">push</span>       <span class="kw4">r14</span>
<span class="co2">00000001</span><span class="nu0">00003523</span> <span class="nu0">53</span>                              <span class="kw1">push</span>       <span class="kw4">rbx</span>
<span class="co2">00000001</span><span class="nu0">00003524</span> 4883EC30                        <span class="kw1">sub</span>        <span class="kw4">rsp</span><span class="sy1">,</span> <span class="nu0">0x30</span>
<span class="co2">00000001</span><span class="nu0">00003528</span> 4889FB                          <span class="kw1">mov</span>        <span class="kw4">rbx</span><span class="sy1">,</span> <span class="kw4">rdi</span>
<span class="co2">00000001</span>0000352b 30C0                            <span class="kw1">xor</span>        <span class="kw4">al</span><span class="sy1">,</span> <span class="kw4">al</span>
<span class="co2">00000001</span>0000352d E878A80400                      <span class="kw1">call</span>       _PFMoveToApplicationsFolderIfNecessary_10004ddaa
<span class="co2">00000001</span><span class="nu0">00003532</span> E89D000700                      <span class="kw1">call</span>       imp___stubs__NSUpdateDynamicServices
<span class="co2">00000001</span><span class="nu0">00003537</span> 30C0                            <span class="kw1">xor</span>        <span class="kw4">al</span><span class="sy1">,</span> <span class="kw4">al</span>
<span class="co2">00000001</span><span class="nu0">00003539</span> E8D0960500                      <span class="kw1">call</span>       _SALicenseIsValid_10005cc0e
<span class="co2">00000001</span>0000353e 84C0                            <span class="kw1">test</span>       <span class="kw4">al</span><span class="sy1">,</span> <span class="kw4">al</span>
<span class="co2">00000001</span><span class="nu0">00003540</span> E924000000                      <span class="kw1">jmp</span>        <span class="nu0">0x100003569</span>
<span class="co2">00000001</span><span class="nu0">00003545</span> <span class="nu0">90</span>                              <span class="kw1">nop</span>        
<span class="co2">00000001</span><span class="nu0">00003546</span> <span class="nu0">90</span>                              <span class="kw1">nop</span>        
<span class="co2">00000001</span><span class="nu0">00003547</span> <span class="nu0">90</span>                              <span class="kw1">nop</span>        
<span class="co2">00000001</span><span class="nu0">00003548</span> <span class="nu0">90</span>                              <span class="kw1">nop</span>
<span class="sy1">...</span>
<span class="co2">00000001</span><span class="nu0">00003569</span> 488B35C8000D00                  <span class="kw1">mov</span>        <span class="kw4">rsi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_sel_standardUserDefaults<span class="br0">&#93;</span> <span class="co1">; @selector(standardUserDefaults) XREF=0x100003540, 0x100003555</span>
<span class="co2">00000001</span><span class="nu0">00003570</span> 488B3D49490D00                  <span class="kw1">mov</span>        <span class="kw4">rdi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>bind__OBJC_CLASS_<span class="sy2">$</span>_NSUserDefaults<span class="br0">&#93;</span>
<span class="co2">00000001</span><span class="nu0">00003577</span> 4C8B35E2DD0A00                  <span class="kw1">mov</span>        <span class="kw4">r14</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>imp___got__objc_msgSend<span class="br0">&#93;</span></pre>

</div>

<h1 class="sectionedit4" id="disable_trial_start_and_stop_timer">Disable Trial Start and Stop Timer</h1>
<div class="level1">

<p>
The trial timer is started when the application finished loading and we have disabled that. For reference, one could also disable the trial timer and then the date check above.
</p>

</div>

<h2 class="sectionedit5" id="start">Start</h2>
<div class="level2">
<pre class="code asm">                                            methImpl_MainWindowController_startTrialTimer<span class="sy1">:</span>
<span class="co2">00000001</span><span class="nu0">00007117</span> <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">rbp</span>
<span class="co2">00000001</span><span class="nu0">00007118</span> <span class="nu0">4889E5</span>                          <span class="kw1">mov</span>        <span class="kw4">rbp</span><span class="sy1">,</span> <span class="kw4">rsp</span>
<span class="co2">00000001</span>0000711b <span class="nu0">4156</span>                            <span class="kw1">push</span>       <span class="kw4">r14</span>
<span class="co2">00000001</span>0000711d <span class="nu0">53</span>                              <span class="kw1">push</span>       <span class="kw4">rbx</span>
<span class="co2">00000001</span>0000711e 4883EC10                        <span class="kw1">sub</span>        <span class="kw4">rsp</span><span class="sy1">,</span> <span class="nu0">0x10</span>
<span class="co2">00000001</span><span class="nu0">00007122</span> E9DE000000                      <span class="kw1">jmp</span>        <span class="nu0">0x100007205</span>
<span class="sy1">..</span>
<span class="co2">00000001</span><span class="nu0">00007205</span> 4883C410                        <span class="kw1">add</span>        <span class="kw4">rsp</span><span class="sy1">,</span> <span class="nu0">0x10</span>                     <span class="co1">; XREF=0x100007122</span>
<span class="co2">00000001</span><span class="nu0">00007209</span> 5B                              <span class="kw1">pop</span>        <span class="kw4">rbx</span>
<span class="co2">00000001</span>0000720a 415E                            <span class="kw1">pop</span>        <span class="kw4">r14</span>
<span class="co2">00000001</span>0000720c 5D                              <span class="kw1">pop</span>        <span class="kw4">rbp</span>
<span class="co2">00000001</span>0000720d FFE0                            <span class="kw1">jmp</span>        <span class="kw4">rax</span></pre>

</div>

<h2 class="sectionedit6" id="stop">Stop</h2>
<div class="level2">
<pre class="code asm">                                            methImpl_MainWindowController_stopTrialTimer<span class="sy1">:</span>
<span class="co2">00000001</span><span class="nu0">0000720f</span> <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">rbp</span>
<span class="co2">00000001</span><span class="nu0">00007210</span> <span class="nu0">4889E5</span>                          <span class="kw1">mov</span>        <span class="kw4">rbp</span><span class="sy1">,</span> <span class="kw4">rsp</span>
<span class="co2">00000001</span><span class="nu0">00007213</span> <span class="nu0">53</span>                              <span class="kw1">push</span>       <span class="kw4">rbx</span>
<span class="co2">00000001</span><span class="nu0">00007214</span> E93E000000                      <span class="kw1">jmp</span>        <span class="nu0">0x100007257</span>
<span class="co2">00000001</span><span class="nu0">00007219</span> <span class="nu0">90</span>                              <span class="kw1">nop</span>        
<span class="co2">00000001</span>0000721a <span class="nu0">90</span>                              <span class="kw1">nop</span>        
<span class="co2">00000001</span>0000721b <span class="nu0">90</span>                              <span class="kw1">nop</span>        
<span class="co2">00000001</span>0000721c <span class="nu0">90</span>                              <span class="kw1">nop</span>        
<span class="co2">00000001</span>0000721d <span class="nu0">90</span>                              <span class="kw1">nop</span>        
<span class="co2">00000001</span>0000721e <span class="nu0">90</span>                              <span class="kw1">nop</span>
<span class="sy1">...</span>
<span class="co2">00000001</span><span class="nu0">00007257</span> 4883C408                        <span class="kw1">add</span>        <span class="kw4">rsp</span><span class="sy1">,</span> <span class="nu0">0x8</span>                      <span class="co1">; XREF=0x100007214</span>
<span class="co2">00000001</span>0000725b 5B                              <span class="kw1">pop</span>        <span class="kw4">rbx</span>
<span class="co2">00000001</span>0000725c 5D                              <span class="kw1">pop</span>        <span class="kw4">rbp</span>
<span class="co2">00000001</span>0000725d C3                              <span class="kw1">ret</span></pre>

</div>

<h1 class="sectionedit7" id="getting_rid_of_the_registration_menu">Getting Rid of the Registration Menu</h1>
<div class="level1">

</div>

<h1 class="sectionedit8" id="registration_menu">Registration Menu</h1>
<div class="level1">

<p>
This is a little more challenging. On first sight, if we run:
</p>
<pre class="code bash"><span class="kw2">strings</span> Snippets.app<span class="sy0">/</span>Contents<span class="sy0">/</span>Resources<span class="sy0">/</span>English.lproj<span class="sy0">/</span>MainMenu.nib <span class="sy0">|</span> <span class="kw2">grep</span> Reg</pre>

<p>
and there are no &quot;Registration...&quot; results, slightly misleading us into believing that the &quot;Registration...&quot; menu item is not present in the NIB - but it has to be.
</p>

<p>
So, Using NIBUnlocker, we dump the <code>Snippets.app/Contents/Resources/English.lproj/MainMenu.nib</code> and find the <code>showRegistrationWindow</code> string. Following the <code>ref=&quot;22&quot;</code>, we find a menu item with ID 22, but with a base64 encoded name.
</p>

<p>
Decoding, we get:
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="st0">&quot;UmVnaXN0cmF0aW9u4oCm&quot;</span> <span class="sy0">|</span> base64 <span class="re5">-d</span>
Registration…</pre>

<p>
There it is.
</p>

<p>
Now we proceed to eliminate all references to <code>id=&quot;22&quot;</code>. The lines below are snippets that were taken out.
</p>
<pre class="code xml"><span class="sc3"><span class="re1">&lt;object</span> <span class="re0">class</span>=<span class="st0">&quot;NSMenuItem&quot;</span> <span class="re0">id</span>=<span class="st0">&quot;22&quot;</span><span class="re2">&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;int</span> <span class="re0">key</span>=<span class="st0">&quot;NSMnemonicLoc&quot;</span><span class="re2">&gt;</span></span>2147483647<span class="sc3"><span class="re1">&lt;/int<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;reference</span> <span class="re0">key</span>=<span class="st0">&quot;NSMenu&quot;</span> <span class="re0">ref</span>=<span class="st0">&quot;9&quot;</span><span class="re2">/&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">key</span>=<span class="st0">&quot;NSKeyEquiv&quot;</span><span class="re2">&gt;</span><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">type</span>=<span class="st0">&quot;base64-UTF8&quot;</span> <span class="re0">key</span>=<span class="st0">&quot;NSTitle&quot;</span><span class="re2">&gt;</span></span>UmVnaXN0cmF0aW9u4oCm<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;reference</span> <span class="re0">key</span>=<span class="st0">&quot;NSOnImage&quot;</span> <span class="re0">ref</span>=<span class="st0">&quot;311&quot;</span><span class="re2">/&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;reference</span> <span class="re0">key</span>=<span class="st0">&quot;NSMixedImage&quot;</span> <span class="re0">ref</span>=<span class="st0">&quot;312&quot;</span><span class="re2">/&gt;</span></span>
<span class="sc3"><span class="re1">&lt;/object<span class="re2">&gt;</span></span></span>
...
<span class="sc3"><span class="re1">&lt;object</span> <span class="re0">class</span>=<span class="st0">&quot;IBConnectionRecord&quot;</span><span class="re2">&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;object</span> <span class="re0">class</span>=<span class="st0">&quot;IBActionConnection&quot;</span> <span class="re0">key</span>=<span class="st0">&quot;connection&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;string</span> <span class="re0">key</span>=<span class="st0">&quot;label&quot;</span><span class="re2">&gt;</span></span>showRegistrationWindow:<span class="sc3"><span class="re1">&lt;/string<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;reference</span> <span class="re0">key</span>=<span class="st0">&quot;source&quot;</span> <span class="re0">ref</span>=<span class="st0">&quot;307&quot;</span><span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;reference</span> <span class="re0">key</span>=<span class="st0">&quot;destination&quot;</span> <span class="re0">ref</span>=<span class="st0">&quot;22&quot;</span><span class="re2">/&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;/object<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;int</span> <span class="re0">key</span>=<span class="st0">&quot;connectionID&quot;</span><span class="re2">&gt;</span></span>852<span class="sc3"><span class="re1">&lt;/int<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/object<span class="re2">&gt;</span></span></span>
...
                            <span class="sc3"><span class="re1">&lt;reference</span> <span class="re0">ref</span>=<span class="st0">&quot;22&quot;</span><span class="re2">/&gt;</span></span>
                            <span class="sc3"><span class="re1">&lt;object</span> <span class="re0">class</span>=<span class="st0">&quot;IBObjectRecord&quot;</span><span class="re2">&gt;</span></span>
                                <span class="sc3"><span class="re1">&lt;int</span> <span class="re0">key</span>=<span class="st0">&quot;objectID&quot;</span><span class="re2">&gt;</span></span>705<span class="sc3"><span class="re1">&lt;/int<span class="re2">&gt;</span></span></span>
                                <span class="sc3"><span class="re1">&lt;reference</span> <span class="re0">key</span>=<span class="st0">&quot;object&quot;</span> <span class="re0">ref</span>=<span class="st0">&quot;22&quot;</span><span class="re2">/&gt;</span></span>
                                <span class="sc3"><span class="re1">&lt;reference</span> <span class="re0">key</span>=<span class="st0">&quot;parent&quot;</span> <span class="re0">ref</span>=<span class="st0">&quot;9&quot;</span><span class="re2">/&gt;</span></span>
                            <span class="sc3"><span class="re1">&lt;/object<span class="re2">&gt;</span></span></span></pre>

<p>
Now it is time to produce the new NIB, so we run:
</p>
<pre class="code bash">ibtool <span class="re5">--errors</span> <span class="re5">--warnings</span> <span class="re5">--notices</span> <span class="re5">--output-format</span> human-readable-text <span class="re5">--compile</span> MainMenu.nib MainMenu.xib</pre>

<p>
and replace the original file.
</p>

<p>
Starting up Snippets, we get a nice clean menu without any &#039;&#039;Registration...&quot; option.
</p>

<p>
<a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_detail/cracks/cracks_snippets_registration.png?id=cracks%3Asnippets" class="media" title="cracks:cracks_snippets_registration.png"><img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_media/cracks/cracks_snippets_registration.png" class="media" alt="" /></a>
</p>

</div>

                    <!-- wikipage stop -->
                                    </div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <div class="docInfo"><bdi>cracks/snippets.txt</bdi> · Last modified: 2022/04/19 09:28 (external edit)</div>

            <!-- PAGE ACTIONS -->
            <!-- <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Revisions [O]"><span>Revisions</span></a></li><li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets?do=export_pdf"  class="action export_pdf" rel="nofollow" title="Export to PDF"><span>Export to PDF</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div>--><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer">
    <!-- <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div> -->

		<!-- BREADCRUMBS -->
					<div class="breadcrumbs">
									<div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks" class="wikilink1" title="cracks" data-wiki-id="cracks">cracks</a></bdi> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets" class="wikilink1" title="cracks:snippets" data-wiki-id="cracks:snippets">snippets</a></bdi></div>
											</div>
		
		<!-- ********** BOTTOM BAR ********** -->
		<div class="bar" id="bar__bottom">
		  <div class="bar-left" id="bar__bottomleft">
			<form class="button btn_login" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="" /><button type="submit" title="Log In">Log In</button></div></form>						<form class="button btn_revs" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets"><div class="no"><input type="hidden" name="do" value="revisions" /><button type="submit" accesskey="o" title="Revisions [O]">Revisions</button></div></form>			                        <form class="button btn_pdf" action="?do=export_pdf" method="POST">
                            <button type="submit" title="PDF">PDF</button>
                        </form>
		  </div>
		  <div class="bar-center">
                        <form class="button btn_home" action="/" method="POST">
                            <button type="submit" title="Home">Home</button>
                        </form>
			<form action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="cracks:snippets" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			<!-- <form id="osssearchform" method="get" action="renderer">
        <input type="hidden" name="use" value="grimore.org">
        <input type="hidden" name="name" value="default">
        <input type="text" id="osssearchbox" name="query">
        <input type="hidden" name="login" value="search">
        <input type="hidden" name="key" value="1a5f74ab3f4df6ce883c4c158540e25e">
        <input type="submit" value="Search">
</form>
 -->
		  </div>
		  <div class="bar-right" id="bar__bottomright">
                        <form class="button btn_contact" action="mailto:%6F%66%66%69%63%65%40%67%72%69%6D%6F%72%65%2E%6F%72%67" method="POST">
                            <button type="submit" title="Contact">Contact</button>
                        </form>
                        <form class="button btn_news" action="/feed.php?mode=recent&amp;type=rss" method="POST">
                            <button type="submit" title="News">News</button>
                        </form>
			<form class="button btn_admin" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/snippets"><div class="no"><input type="hidden" name="do" value="admin" /><button type="submit" title="Admin">Admin</button></div></form>								  </div>
		  		</div>

		
</div><!-- /footer -->

<div style="text-align: center;">
    <div style="display:inline-block;">
      <p>
        <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion">
          <img src="/lib/tpl/was/images/button-tor.png" alt="Access website using Tor" />
        </a> 
        <a href="http://ioujrf2uwqairs7l3vyvqp7n2pia3x3wg5w5qtcqvg32zezuezza.b32.i2p/" />
          <img src="/lib/tpl/was/images/button-i2p.png" alt="Access website using i2p" />
        </a>
        <a href="http://pgp.grimore.org/" />
          <img src="/lib/tpl/was/images/button-pgp.png" alt="Wizardry and Steamworks PGP Key" />
        </a>
      </p>
    </div>
<!--    <div style="display:inline-block;">
      <p>
        <a href="http://ij4lpzuyyng6cc4jw5mxibcyjv4rx4uk6x5jijoduglkgjh7mmya.b32.i2p">
          <img src="/lib/tpl/was/images/button-i2p.png" alt="Access website using i2p" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="http://cydia.grimore.org/">
          <img src="/lib/tpl/was/images/button-cydia.png" alt="Wizardry and Steamworks Cydia Repository" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="http://debian.grimore.org/">
          <img src="/lib/tpl/was/images/button-debian.png" alt="Wizardry and Steamworks Debian Repository" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="/opt/pasteboard/" rel="external nofollow">
          <img src="/lib/tpl/was/images/button-live.png" alt="Live Pasteboard" />
        </a> 
      </p>
    </div> -->
    
<br/>

    <p>
      For the copyright, license, warranty and privacy terms for the usage of this website please see the <a
      href="/wiki:license">license</a>, <a href="/wiki:privacy">privacy</a>, <a
      href="/wiki:copyright">copyright</a>
      and the <a href="/wiki:plagiarism">plagiarism</a> pages.
    </p>
</div>
    </div></div><!-- /site -->

    <div class="no"><img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/taskrunner.php?id=cracks%3Asnippets&amp;1657302724" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if lte IE 8 ]></div><![endif]-->
</body>
</html>
