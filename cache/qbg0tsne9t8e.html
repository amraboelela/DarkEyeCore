<!DOCTYPE html>
<html lang="was" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>fuss:csharp [Wizardry and Steamworks]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="fuss,csharp"/>
<link rel="search" type="application/opensearchdescription+xml" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/opensearch.php" title="Wizardry and Steamworks"/>
<link rel="start" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/"/>
<link rel="contents" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp?do=index" title="Sitemap"/>
<link rel="manifest" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Changes" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/feed.php?mode=list&amp;ns=fuss"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_export/xhtml/fuss/csharp"/>
<link rel="canonical" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp"/>
<link rel="stylesheet" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/css.php?t=was&amp;tseed=24551d22639bdaeb736aec3dca86fd82"/>
<!--[if gte IE 9]><!-->
<script >/*<![CDATA[*/var NS='fuss';var JSINFO = {"plugin_imagemap_mldummy":"http:\/\/3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion\/_media\/wiki\/dokuwiki-128.png","isadmin":0,"isauth":0,"plugin_pdfjs":{"hide_download_button":0},"plugins":{"vshare":{"youtube":"youtube\\.com\/.*[&?]v=([a-z0-9_\\-]+)","vimeo":"vimeo\\.com\\\/(\\d+)","slideshare":"slideshare.*id=(\\d+)","dailymotion":"dailymotion\\.com\/video\/([a-z0-9]+)","archiveorg":"archive\\.org\/(?:embed|details)\/([a-zA-Z0-9_\\-]+)","soundcloud":"soundcloud\\.com\/([\\w-]+\/[\\w-]+)","niconico":"nicovideo\\.jp\/watch\/(sm[0-9]+)","bitchute":"bitchute\\.com\\\/video\\\/([a-zA-Z0-9_\\-]+)","coub":"coub\\.com\\\/view\\\/([a-zA-Z0-9_\\-]+)","odysee":"odysee\\.com\/\\$\/(?:embed|download)\/([-%_?=\/a-zA-Z0-9]+)","youku":"v\\.youku\\.com\/v_show\/id_([0-9A-Za-z=]+)\\.html","bilibili":"bilibili\\.com\\\/video\\\/(BV[0-9A-Za-z]+)","msoffice":"(?:office\\.com.*[&?]videoid=([a-z0-9\\-]+))","msstream":"microsoftstream\\.com\\\/video\\\/([a-f0-9\\-]{36})"}},"id":"fuss:csharp","namespace":"fuss","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script charset="utf-8" src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/jquery.php?tseed=34a552433bc33cc9c3bc32527289a0b2"></script>
<script charset="utf-8" src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/js.php?t=was&amp;tseed=24551d22639bdaeb736aec3dca86fd82&amp;template=was"></script>
<!--<![endif]-->
    <!-- <link rel="shortcut icon" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/favicon.ico" />
<link rel="apple-touch-icon" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/apple-touch-icon.png" />
 -->
    <!-- Viewport -->
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!-- Favicon -->
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png?v=2">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png?v=2">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png?v=2">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png?v=2">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png?v=2">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png?v=2">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png?v=2">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png?v=2">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png?v=2">
<link rel="icon" type="image/png" href="/favicon-32x32.png?v=2" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png?v=2" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png?v=2" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png?v=2" sizes="16x16">
<link rel="manifest" href="/manifest.json?v=2">
<link rel="shortcut icon" href="/favicon.ico?v=2">
<meta name="apple-mobile-web-app-title" content="[Wizardry and Steamworks]">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png?v=2">
<meta name="application-name" content="[Wizardry and Steamworks]">
<meta name="theme-color" content="#ffffff">
    <!-- <script async type="text/javascript" src="/lib/tpl/was/loadCSS.js"></script>
    <script async type="text/javascript" src="/lib/tpl/was/cssrelpreload.js"></script> -->
</head>

<body>
    <!--[if lte IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_was     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header">

	    
	<!-- ********** TOP BAR ********** -->
	<div class="bar" id="bar__top">
		<div class="bar-left" id="bar__topleft">
			<form class="button btn_login" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="" /><button type="submit" title="Log In">Log In</button></div></form>						<form class="button btn_revs" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp"><div class="no"><input type="hidden" name="do" value="revisions" /><button type="submit" accesskey="o" title="Revisions [O]">Revisions</button></div></form>						<form class="button btn_pdf" action="?do=export_pdf" method="POST">
			    <button type="submit" title="PDF">PDF</button>
                        </form>
		</div>
		<div class="bar-center">
		        <form class="button btn_home" action="/" method="POST">
                            <button type="submit" title="Home">Home</button>
                        </form>
			<form action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="fuss:csharp" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			<!-- <form id="osssearchform" method="get" action="renderer">
        <input type="hidden" name="use" value="grimore.org">
        <input type="hidden" name="name" value="default">
        <input type="text" id="osssearchbox" name="query">
        <input type="hidden" name="login" value="search">
        <input type="hidden" name="key" value="1a5f74ab3f4df6ce883c4c158540e25e">
        <input type="submit" value="Search">
</form>
 -->
		</div>
		<div class="bar-right" id="bar__topright">
		        <form class="button btn_contact" action="mailto:%6F%66%66%69%63%65%40%67%72%69%6D%6F%72%65%2E%6F%72%67" method="POST">
			    <button type="submit" title="Contact">Contact</button>
                        </form>
                        <form class="button btn_news" action="/feed.php?type=rss2&amp;ns=fuss:csharp&amp;linkto=page&amp;content=abstract" method="POST">
			    <button type="submit" title="News">News</button>
                        </form>
			<form class="button btn_admin" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp"><div class="no"><input type="hidden" name="do" value="admin" /><button type="submit" title="Admin">Admin</button></div></form>								</div>
			</div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss" class="wikilink1" title="fuss" data-wiki-id="fuss">fuss</a></bdi> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp" class="wikilink1" title="fuss:csharp" data-wiki-id="fuss:csharp">csharp</a></bdi></div>
                                </div>
    
    <hr class="a11y" />
</div><!-- /header -->

        <div class="wrapper group">

            <!--  -->

            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <!-- <div class="pageId"><span>fuss:csharp</span></div> -->

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc" class="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#wizardry_and_steamworks_portable_library_class_pcl">Wizardry and Steamworks Portable Library Class (PCL)</a></div></li>
<li class="level1"><div class="li"><a href="#linq_number_of_times">Linq Number of Times</a></div></li>
<li class="level1"><div class="li"><a href="#assemblies_in_different_directory">Assemblies in Different Directory</a></div></li>
<li class="level1"><div class="li"><a href="#get_memory_currently_in-use_by_process">Get Memory Currently In-Use by Process</a></div></li>
<li class="level1"><div class="li"><a href="#select_even_element_of_array">Select Even Element of Array</a></div></li>
<li class="level1"><div class="li"><a href="#serializing_a_structure">Serializing a Structure</a></div></li>
<li class="level1"><div class="li"><a href="#temporary_structure">Temporary Structure</a></div></li>
<li class="level1"><div class="li"><a href="#get_variable_names">Get Variable Names</a></div></li>
<li class="level1"><div class="li"><a href="#monitoring_file_activity">Monitoring File Activity</a></div></li>
<li class="level1"><div class="li"><a href="#try_to_parse_a_nullable_structure">Try to Parse a Nullable Structure</a></div></li>
<li class="level1"><div class="li"><a href="#get_names_and_values_of_enumeration_members">Get Names and Values of Enumeration Members</a></div></li>
<li class="level1"><div class="li"><a href="#group_a_sequence_by_pairs">Group a Sequence by Pairs</a></div></li>
<li class="level1"><div class="li"><a href="#serialising_comma-separated_values_to_a_dictionary_using_regular_expressions">Serialising Comma-Separated Values to a Dictionary using Regular Expressions</a></div></li>
<li class="level1"><div class="li"><a href="#convert_hashtable_to_dictionary">Convert HashTable to Dictionary</a></div></li>
<li class="level1"><div class="li"><a href="#calculate_memory_size_of_object">Calculate Memory Size of Object</a></div></li>
<li class="level1"><div class="li"><a href="#convert_a_unix_timestamp_to_datetime">Convert a UNIX Timestamp to DateTime</a></div></li>
<li class="level1"><div class="li"><a href="#convert_datetime_to_unix_timestamp">Convert DateTime to UNIX Timestamp</a></div></li>
<li class="level1"><div class="li"><a href="#get_an_enumeration_value_from_description">Get an Enumeration Value from Description</a></div></li>
<li class="level1"><div class="li"><a href="#get_description_from_enumeration_value">Get Description from Enumeration Value</a></div></li>
<li class="level1"><div class="li"><a href="#get_the_description_of_a_structure_member">Get the Description of a Structure Member</a></div></li>
<li class="level1"><div class="li"><a href="#get_all_descriptions_of_an_enumeration">Get All Descriptions of an Enumeration</a></div></li>
<li class="level1"><div class="li"><a href="#bitwise_flag_enumerations">Bitwise Flag Enumerations</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#set_flags">Set Flags</a></div></li>
<li class="level2"><div class="li"><a href="#unset_flags">Unset Flags</a></div></li>
<li class="level2"><div class="li"><a href="#determine_if_a_flag_or_flag_mask_is_set">Determine if a Flag or Flag Mask is Set</a></div></li>
<li class="level2"><div class="li"><a href="#get_the_values_of_set_flags">Get the Values of Set Flags</a></div></li>
<li class="level2"><div class="li"><a href="#get_the_names_of_set_flags">Get the Names of Set Flags</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#graceful_shutdown_of_console_applications">Graceful Shutdown of Console Applications</a></div></li>
<li class="level1"><div class="li"><a href="#split_string_into_groups_of_strings">Split String into Groups of Strings</a></div></li>
<li class="level1"><div class="li"><a href="#rfc3986_uri_escape_and_unescape_a_data_string">RFC3986 URI Escape and Unescape a Data String</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#unescape">Unescape</a></div></li>
<li class="level2"><div class="li"><a href="#escape">Escape</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#fibonacci_number_generator">Fibonacci Number Generator</a></div></li>
<li class="level1"><div class="li"><a href="#determine_if_number_is_a_power_of_two">Determine if Number is a Power of Two</a></div></li>
<li class="level1"><div class="li"><a href="#xor_swap_two_integers">XOR Swap Two Integers</a></div></li>
<li class="level1"><div class="li"><a href="#parallel_insertion_of_matrix_values_in_flat_array">Parallel Insertion of Matrix Values in Flat Array</a></div></li>
<li class="level1"><div class="li"><a href="#compressing_a_http_web_request">Compressing a HTTP Web Request</a></div></li>
<li class="level1"><div class="li"><a href="#permute_an_array">Permute an Array</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#reverse">Reverse</a></div></li>
<li class="level2"><div class="li"><a href="#forward">Forward</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#swap_array_elements">Swap Array Elements</a></div></li>
<li class="level1"><div class="li"><a href="#concatenate_array_elements">Concatenate Array Elements</a></div></li>
<li class="level1"><div class="li"><a href="#delete_sub-array">Delete Sub-Array</a></div></li>
<li class="level1"><div class="li"><a href="#get_sub-array">Get Sub-Array</a></div></li>
<li class="level1"><div class="li"><a href="#cryptographic_functions">Cryptographic Functions</a></div></li>
<li class="level1"><div class="li"><a href="#sequence_contains_all_elements_of_sequence">Sequence Contains All Elements of Sequence</a></div></li>
<li class="level1"><div class="li"><a href="#unix_alarm">Unix Alarm</a></div></li>
<li class="level1"><div class="li"><a href="#adaptive_alarm">Adaptive Alarm</a></div></li>
<li class="level1"><div class="li"><a href="#combine_multiple_paths">Combine Multiple Paths</a></div></li>
<li class="level1"><div class="li"><a href="#convert_a_decimal_number_to_a_given_base">Convert a Decimal Number to a Given Base</a></div></li>
<li class="level1"><div class="li"><a href="#iterative_fibonacci_implementation">Iterative Fibonacci Implementation</a></div></li>
<li class="level1"><div class="li"><a href="#binary_search">Binary Search</a></div></li>
<li class="level1"><div class="li"><a href="#quicksort">Quicksort</a></div></li>
<li class="level1"><div class="li"><a href="#get_field_or_property_from_nested_class_by_fully_qualified_name">Get Field or Property from Nested Class by Fully Qualified Name</a></div></li>
<li class="level1"><div class="li"><a href="#merge_sort">Merge Sort</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#recursive">Recursive</a></div></li>
<li class="level2"><div class="li"><a href="#iterative">Iterative</a></div></li>
</ul>
</li>
<li class="level1"><div class="li"><a href="#enable_double_buffering_for_controls">Enable Double Buffering for Controls</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="wizardry_and_steamworks_portable_library_class_pcl">Wizardry and Steamworks Portable Library Class (PCL)</h1>
<div class="level1">

<p>
Some functions are implemented as part of the Wizardry and Steamworks portable library class (PCL) and the full library can be retrieved from SVN by checking out the following repository:
</p>
<ul>
<li class="level1"><div class="li"> <a href="http://svn.grimore.org/wasSharp" class="urlextern" title="http://svn.grimore.org/wasSharp" rel="ugc nofollow">wasSharp</a></div>
</li>
</ul>

<p>
The PCL targets:
</p>
<ul>
<li class="level1"><div class="li"> .NET Framework 4.5.1</div>
</li>
<li class="level1"><div class="li"> Microsoft Windows 8.1</div>
</li>
<li class="level1"><div class="li"> Windows Phone 8.1</div>
</li>
</ul>

</div>

<h1 class="sectionedit2" id="linq_number_of_times">Linq Number of Times</h1>
<div class="level1">

<p>
Use the following one-liner to display a line of dashes that goes goes from one end of the terminal to the other:
</p>
<pre class="code C">new List<span class="sy0">&lt;</span>int<span class="sy0">&gt;</span><span class="br0">&#40;</span>new <span class="kw4">int</span><span class="br0">&#91;</span>Console.<span class="me1">WindowWidth</span><span class="br0">&#93;</span><span class="br0">&#41;</span>.<span class="me1">ForEach</span><span class="br0">&#40;</span>i <span class="sy0">=&gt;</span> Console.<span class="me1">Write</span><span class="br0">&#40;</span><span class="st0">&quot;-&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
which creates an empty list of integers of size <code>Console.WindowWidth</code> and then for each element it writes a dash to the console.
</p>

</div>

<h1 class="sectionedit3" id="assemblies_in_different_directory">Assemblies in Different Directory</h1>
<div class="level1">

<p>
Assemblies can be loaded from a different directory by creating an <code>ASSEMBLY.EXE.conf</code> file, where <code>ASSEMBLY.EXE</code> is the application executable with the following contents:
</p>
<pre class="code xml"><span class="sc3"><span class="re1">&lt;configuration<span class="re2">&gt;</span></span></span>
   <span class="sc3"><span class="re1">&lt;runtime<span class="re2">&gt;</span></span></span>
      <span class="sc3"><span class="re1">&lt;assemblyBinding</span> <span class="re0">xmlns</span>=<span class="st0">&quot;urn:schemas-microsoft-com:asm.v1&quot;</span><span class="re2">&gt;</span></span>
         <span class="sc3"><span class="re1">&lt;probing</span> <span class="re0">privatePath</span>=<span class="st0">&quot;lib;bin&quot;</span><span class="re2">/&gt;</span></span>
      <span class="sc3"><span class="re1">&lt;/assemblyBinding<span class="re2">&gt;</span></span></span>
   <span class="sc3"><span class="re1">&lt;/runtime<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/configuration<span class="re2">&gt;</span></span></span></pre>

<p>
This will make the application to look for the assemblies in the <code>lib/</code> and <code>bin/</code> paths.
</p>

</div>

<h1 class="sectionedit4" id="get_memory_currently_in-use_by_process">Get Memory Currently In-Use by Process</h1>
<div class="level1">

<p>
<code>freeByes</code> will contain the amount of memory used by the current process in bytes.
</p>
<pre class="code c">System.<span class="me1">Diagnostics</span>.<span class="me1">Process</span> proc <span class="sy0">=</span> System.<span class="me1">Diagnostics</span>.<span class="me1">Process</span>.<span class="me1">GetCurrentProcess</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw4">int</span> freeBytes <span class="sy0">=</span> proc.<span class="me1">PrivateMemorySize64</span><span class="sy0">;</span></pre>

</div>

<h1 class="sectionedit5" id="select_even_element_of_array">Select Even Element of Array</h1>
<div class="level1">

<p>
Given the array:
</p>
<pre class="code">[ 0, 1, 2, 3, 4, 5, ... ]</pre>

<p>
the following LINQ expression:
</p>
<pre class="code c">var a <span class="sy0">=</span> data.<span class="me1">Where</span><span class="br0">&#40;</span><span class="br0">&#40;</span>value<span class="sy0">,</span> index<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> <span class="br0">&#40;</span>index <span class="sy0">%</span> <span class="nu0">2</span><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span>.<span class="me1">ToArray</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
will set a to the array:
</p>
<pre class="code">[ 0, 2, 4, ... ]</pre>

</div>

<h1 class="sectionedit6" id="serializing_a_structure">Serializing a Structure</h1>
<div class="level1">

<p>
Suppose that we have a C# structure that defines a person along with multiple properties for that person and that we want to create a method that will serialize this structure to the <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/data_structures/key-value_pairs" class="wikilink1" title="fuss:data_structures:key-value_pairs" data-wiki-id="fuss:data_structures:key-value_pairs">key-value data</a>. The <code>ToKeyValueData</code> function in the example below uses reflection to loop over the properties of the <code>Person</code> structure and returns a <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/data_structures/key-value_pairs" class="wikilink1" title="fuss:data_structures:key-value_pairs" data-wiki-id="fuss:data_structures:key-value_pairs">key-value data</a> compatible string.
</p>
<pre class="code csharp"><span class="kw1">public</span> <span class="kw4">struct</span> Person <span class="br0">&#123;</span>
    <span class="sy0">...</span>
    <span class="kw1">public</span> Person<span class="br0">&#40;</span><span class="kw4">string</span> name, <span class="kw4">string</span> address, <span class="sy0">...</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">this</span><span class="sy0">.</span><span class="me1">name</span> <span class="sy0">=</span> name<span class="sy0">;</span>
        <span class="kw1">this</span><span class="sy0">.</span><span class="me1">address</span> <span class="sy0">=</span> address<span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="sy0">...</span>
    <span class="co1">///////////////////////////////////////////////////////////////////////////</span>
    <span class="co1">//    Copyright (C) 2013 Wizardry and Steamworks - License: GNU GPLv3    //</span>
    <span class="co1">///////////////////////////////////////////////////////////////////////////</span>
    <span class="co1">/// &lt;summary&gt;</span>
    <span class="co1">/// Serializes a structure to a Wizardry and Steamworks key-value data string.</span>
    <span class="co1">/// &lt;/summary&gt;</span>
    <span class="kw1">private</span> <span class="kw4">string</span> ToKeyValueData<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">var</span> sb <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> StringBuilder<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw4">object</span> p <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Person<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">foreach</span><span class="br0">&#40;</span><span class="kw1">var</span> k <span class="kw1">in</span> p<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetProperties</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">var</span> v <span class="sy0">=</span> GetType<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetProperty</span><span class="br0">&#40;</span>k<span class="sy0">.</span><span class="me1">Name</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetValue</span><span class="br0">&#40;</span><span class="kw1">this</span>, <span class="kw1">null</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">if</span><span class="br0">&#40;</span><span class="kw4">string</span><span class="sy0">.</span><span class="me1">IsNullOrEmpty</span><span class="br0">&#40;</span>v<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">continue</span><span class="sy0">;</span>
            sb<span class="sy0">.</span><span class="me1">Append</span><span class="br0">&#40;</span><span class="kw4">string</span><span class="sy0">.</span><span class="me1">Format</span><span class="br0">&#40;</span><span class="st0">&quot;{0}={2}&quot;</span>, k<span class="sy0">.</span><span class="me1">Name</span>, v<span class="br0">&#41;</span><span class="sy0">;</span>
                      sb<span class="sy0">.</span><span class="me1">Append</span><span class="br0">&#40;</span>delimiter<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
        <span class="kw1">if</span><span class="br0">&#40;</span>sb<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">!=</span> <span class="nu0">0</span><span class="br0">&#41;</span> sb<span class="sy0">.</span><span class="me1">Length</span><span class="sy0">--;</span>
        <span class="kw1">return</span> sb<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="sy0">...</span>
    <span class="kw1">public</span> <span class="kw4">string</span> name <span class="br0">&#123;</span> <span class="kw1">get</span><span class="sy0">;</span> <span class="kw1">internal</span> <span class="kw1">set</span><span class="sy0">;</span> <span class="br0">&#125;</span>
    <span class="kw1">public</span> <span class="kw4">string</span> address <span class="br0">&#123;</span> <span class="kw1">get</span><span class="sy0">;</span> <span class="kw1">internal</span> <span class="kw1">set</span><span class="sy0">;</span> <span class="br0">&#125;</span>
    <span class="sy0">...</span>
<span class="br0">&#125;</span></pre>

<p>
That is done by enumerating the properties of the <code>Person</code> structure using <code>GetProperties</code> on the type of the structure which gives us a <code>propertyInfo</code> object from which we can extract the name of that property. In order to get the value of that property, we use <code>GetProperty</code> on the name of property and get the value of the instance object (<code>this</code>).
</p>

</div>

<h1 class="sectionedit7" id="temporary_structure">Temporary Structure</h1>
<div class="level1">

<p>
There are cases where you want a wrapper that can hold objects in order to avoid declaring temporary variables (from the series, &quot;can I partially allocate an object?&quot;). For example, you perform a loop and store data in the upper-scope:
</p>
<pre class="code csharp"><span class="kw4">int</span> time <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
<span class="kw4">int</span> greeting <span class="sy0">=</span> <span class="st0">&quot;&quot;</span><span class="sy0">;</span>
<span class="kw1">foreach</span><span class="br0">&#40;</span><span class="kw1">var</span> o <span class="kw1">in</span> <span class="sy0">...</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">switch</span><span class="br0">&#40;</span>o<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">case</span> <span class="sy0">...:</span>
      time <span class="sy0">=</span> <span class="nu0">10</span><span class="sy0">;</span>
      <span class="kw1">break</span><span class="sy0">;</span>
    <span class="kw1">case</span> <span class="sy0">...:</span>
      greeting <span class="sy0">=</span> <span class="st0">&quot;Good Day!&quot;</span><span class="sy0">;</span>
      <span class="kw1">break</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

<p>
In such cases, a generic object array is more suitable:
</p>
<pre class="code csharp"><span class="kw4">object</span><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span> data <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="kw4">object</span><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span><span class="sy0">;</span>
<span class="kw1">foreach</span><span class="br0">&#40;</span><span class="kw1">var</span> o <span class="kw1">in</span> <span class="sy0">...</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">switch</span><span class="br0">&#40;</span>o<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">case</span> <span class="sy0">...:</span>
      data<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">10</span><span class="sy0">;</span>
      <span class="kw1">break</span><span class="sy0">;</span>
    <span class="kw1">case</span> <span class="sy0">...:</span>
      data<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="st0">&quot;Good Day!&quot;</span><span class="sy0">;</span>
      <span class="kw1">break</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
<span class="kw1">if</span><span class="br0">&#40;</span>data<span class="sy0">.</span><span class="me1">Any</span><span class="br0">&#40;</span>o <span class="sy0">=&gt;</span> o <span class="sy0">==</span> <span class="kw1">null</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="co1">// data contains at least one null element</span>
<span class="br0">&#125;</span></pre>

<p>
This works great as a temporary structure, in order to avoid creating a new class or struct which would live much longer than the inlined generic object.
</p>

</div>

<h1 class="sectionedit8" id="get_variable_names">Get Variable Names</h1>
<div class="level1">
<pre class="code csharp"><span class="kw1">using</span> <span class="co3">System.Linq.Expressions</span><span class="sy0">;</span>
<span class="sy0">...</span>
<span class="kw4">string</span> ON<span class="sy0">;</span>
<span class="sy0">...</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">string</span> GetName<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>Expression<span class="sy0">&lt;</span>Func<span class="sy0">&lt;</span>T<span class="sy0">&gt;&gt;</span> e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>MemberExpression<span class="br0">&#41;</span> e<span class="sy0">.</span><span class="me1">Body</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Member</span><span class="sy0">.</span><span class="me1">Name</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="sy0">...</span>
<span class="me1">Console</span><span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">&#40;</span>GetName<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">=&gt;</span> ON<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h1 class="sectionedit9" id="monitoring_file_activity">Monitoring File Activity</h1>
<div class="level1">

<p>
When you have to monitor files for changes or access times, <code>C#</code> comes equipped for that task with the <code>FileSystemWatcher</code> class. On <code>UNIX</code> / <code>mono</code>, <code>FileSystemWatcher</code> is implemented using <code>gamin</code> as well as other mechanisms to provide the same functionality.
</p>

<p>
For example, the following filesystem watcher scans the current directory for:
</p>
<ul>
<li class="level1"><div class="li"> last access changes.</div>
</li>
<li class="level1"><div class="li"> last written changes.</div>
</li>
<li class="level1"><div class="li"> filename changes.</div>
</li>
<li class="level1"><div class="li"> directory name changes.</div>
</li>
</ul>

<p>
installs a filter for <code>ini</code> files and then when any <code>ini</code> file in the current directory is changed, it will raise <code>HandleDirectoryChange</code>. <code>HandleDirectoryChange</code> will then print out the file name (in <code>e.Name</code>) to the console:
</p>
<pre class="code csharp">FileSystemWatcher watcher <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> FileSystemWatcher<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
watcher<span class="sy0">.</span><span class="me1">Path</span> <span class="sy0">=</span> Directory<span class="sy0">.</span><span class="me1">GetCurrentDirectory</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
watcher<span class="sy0">.</span><span class="me1">NotifyFilter</span> <span class="sy0">=</span> NotifyFilters<span class="sy0">.</span><span class="me1">LastAccess</span> <span class="sy0">|</span> 
                       NotifyFilters<span class="sy0">.</span><span class="me1">LastWrite</span> <span class="sy0">|</span> 
                       NotifyFilters<span class="sy0">.</span><span class="me1">FileName</span> <span class="sy0">|</span> 
                       NotifyFilters<span class="sy0">.</span><span class="me1">DirectoryName</span><span class="sy0">;</span>
watcher<span class="sy0">.</span><span class="me1">Filter</span> <span class="sy0">=</span> <span class="st0">&quot;*.ini&quot;</span><span class="sy0">;</span>
watched<span class="sy0">.</span><span class="me1">Changed</span> <span class="sy0">+=</span> HandleDirectoryChange<span class="sy0">;</span>
<span class="sy0">...</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">void</span> HandleDirectoryChange<span class="br0">&#40;</span><span class="kw4">object</span> sender, FileSystemEventArgs e<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    Console<span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">&#40;</span>e<span class="sy0">.</span><span class="me1">Name</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
Note that <code>FileSystemWatcher</code> monitors directories and if you want to monitor just a file, you can set the <code>Filter</code> to the file name, as in:
</p>
<pre class="code csharp">watcher<span class="sy0">.</span><span class="me1">Path</span> <span class="sy0">=</span> Directory<span class="sy0">.</span><span class="me1">GetCurrentDirectory</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
watcher<span class="sy0">.</span><span class="me1">Filter</span> <span class="sy0">=</span> <span class="st0">&quot;Corrade.ini&quot;</span><span class="sy0">;</span></pre>

</div>

<h1 class="sectionedit10" id="try_to_parse_a_nullable_structure">Try to Parse a Nullable Structure</h1>
<div class="level1">

<p>
<code>TryParse</code> does not function on nullable types such as <code>int?</code>. The following function can act as a substitute for <code>int.TryParse</code>:
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Attempts to parse a string to a structure.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;input&quot;&gt;the input string&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;variable&quot;&gt;the variable holding the parsed type T&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;true if the variable could be parsed&lt;/returns&gt;</span>
<span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">bool</span> TryParseNullable<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> input, <span class="kw1">out</span> T<span class="sy0">?</span> variable<span class="br0">&#41;</span> <span class="kw1">where</span> T<span class="sy0">:</span><span class="kw4">struct</span> 
<span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw4">string</span><span class="sy0">.</span><span class="me1">IsNullOrEmpty</span><span class="br0">&#40;</span>input<span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        variable <span class="sy0">=</span> <span class="kw1">null</span><span class="sy0">;</span>
        <span class="kw1">return</span> <span class="kw1">false</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    T<span class="sy0">?</span> localVariable<span class="sy0">;</span>
    <span class="kw1">try</span>
    <span class="br0">&#123;</span>
        IConvertible convertibleString <span class="sy0">=</span> input<span class="sy0">;</span>
        localVariable <span class="sy0">=</span> <span class="br0">&#40;</span>T<span class="br0">&#41;</span>convertibleString<span class="sy0">.</span><span class="me1">ToType</span><span class="br0">&#40;</span><a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a><span class="br0">&#40;</span>T<span class="br0">&#41;</span>, CultureInfo<span class="sy0">.</span><span class="me1">CurrentCulture</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw1">catch</span> <span class="br0">&#40;</span>Exception<span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        variable <span class="sy0">=</span> <span class="kw1">null</span><span class="sy0">;</span>
        <span class="kw1">return</span> <span class="kw1">false</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    variable <span class="sy0">=</span> localVariable<span class="sy0">;</span>
    <span class="kw1">return</span> <span class="kw1">true</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit11" id="get_names_and_values_of_enumeration_members">Get Names and Values of Enumeration Members</h1>
<div class="level1">

<p>
Can be done by using reflection:
</p>
<pre class="code csharp"><span class="kw1">foreach</span> <span class="br0">&#40;</span>FieldInfo fi <span class="kw1">in</span> <a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a><span class="br0">&#40;</span>Molecules<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetFields</span><span class="br0">&#40;</span>BindingFlags<span class="sy0">.</span><span class="kw1">Public</span> <span class="sy0">|</span> BindingFlags<span class="sy0">.</span><span class="kw1">Static</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
   Console<span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">&#40;</span>fi<span class="sy0">.</span><span class="me1">Name</span><span class="br0">&#41;</span><span class="sy0">;</span>
   Console<span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">&#40;</span>fi<span class="sy0">.</span><span class="me1">GetValue</span><span class="br0">&#40;</span><span class="kw1">null</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit12" id="group_a_sequence_by_pairs">Group a Sequence by Pairs</h1>
<div class="level1">

<p>
Suppose you have a set of elements:
</p>
<pre class="code">10, 20, 30, 40, 50</pre>

<p>
and that you want to create sub-sets from successive elements as pairs. Following the example, you want to create the pairs: <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img02e2e2f2843bcae8078c1f89e98e10d9.png" class="latex_inline" alt="$(10, 20)$" title="Math" />, <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img40a142ca14806558ecbd4b10ef131efd.png" class="latex_inline" alt="$(30, 40)$" title="Math" />, <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/imgab6f1d54c60bd4d2cb0596f034fbe27f.png" class="latex_inline" alt="$(50, 60)$" title="Math" /> out of the initial set preferably as key-value pairs. 
</p>

<p>
In that case, there are several solutions, but if you want to use only one LINQ line, then the following expression will return the desired key-value pairs:
</p>
<pre class="code csharp">list<span class="sy0">.</span><span class="kw1">Select</span><span class="br0">&#40;</span><span class="br0">&#40;</span>o, p<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="br0">&#123;</span>o <span class="sy0">=</span> o, p <span class="sy0">=</span> p<span class="br0">&#125;</span><span class="br0">&#41;</span>
    <span class="sy0">.</span><span class="me1">GroupBy</span><span class="br0">&#40;</span>q <span class="sy0">=&gt;</span> q<span class="sy0">.</span><span class="me1">p</span><span class="sy0">/</span><span class="nu0">2</span>, q <span class="sy0">=&gt;</span> q<span class="sy0">.</span><span class="me1">o</span><span class="br0">&#41;</span>
    <span class="sy0">.</span><span class="kw1">Select</span><span class="br0">&#40;</span>o <span class="sy0">=&gt;</span> o<span class="sy0">.</span><span class="me1">ToList</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="sy0">.</span><span class="me1">TakeWhile</span><span class="br0">&#40;</span>o <span class="sy0">=&gt;</span> o<span class="sy0">.</span><span class="me1">Count</span> <span class="sy0">%</span> <span class="nu0">2</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span>
    <span class="sy0">.</span><span class="me1">ToDictionary</span><span class="br0">&#40;</span>o <span class="sy0">=&gt;</span> o<span class="sy0">.</span><span class="me1">First</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, p <span class="sy0">=&gt;</span> p<span class="sy0">.</span><span class="me1">Last</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span></pre>

<p>
It does that by: 
</p>
<ol>
<li class="level1"><div class="li"> grouping odd and even elements together, </div>
</li>
<li class="level1"><div class="li"> selecting the entire list of groups, </div>
</li>
<li class="level1"><div class="li"> selecting only matching key-value pairs,</div>
</li>
<li class="level1"><div class="li"> creating a key value pair from the first element and the last element in the pair-set.</div>
</li>
</ol>

</div>

<h1 class="sectionedit13" id="serialising_comma-separated_values_to_a_dictionary_using_regular_expressions">Serialising Comma-Separated Values to a Dictionary using Regular Expressions</h1>
<div class="level1">

<p>
Given a comma-separated string (<code>CSV</code>) such as:
</p>
<pre class="code">Color, Red, Life, Good, Day, Sunday</pre>

<p>
where the even strings (<code>Color</code>, <code>Life</code>, <code>Day</code>) represent keys and the odd strings (<code>Red</code>, <code>Good</code>, <code>Sunday</code>) represent values, one can use regular expressions (<code>System.Text.RegularExpressions</code>) to serialise the string into a dictionary of key-value pairs:
</p>
<pre class="code csharp"><span class="kw1">using</span> <span class="co3">System.Text.RegularExpressions</span><span class="sy0">;</span>
<span class="co1">//...</span>
Dictionary<span class="sy0">&lt;</span><span class="kw4">string</span>, <span class="kw4">string</span><span class="sy0">&gt;</span> pairs <span class="sy0">=</span> 
	Regex<span class="sy0">.</span><span class="me1">Matches</span><span class="br0">&#40;</span>command<span class="sy0">.</span><span class="me1">Attachments</span>, <span class="st_h">@&quot;\s*(?&lt;key&gt;.+?)\s*,\s*(?&lt;value&gt;.+?)\s*(,|$)&quot;</span><span class="br0">&#41;</span>
		<span class="sy0">.</span><span class="me1">Cast</span><span class="sy0">&lt;</span>Match<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
		<span class="sy0">.</span><span class="me1">ToDictionary</span><span class="br0">&#40;</span>m <span class="sy0">=&gt;</span> m<span class="sy0">.</span><span class="me1">Groups</span><span class="br0">&#91;</span><span class="st0">&quot;key&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span>, m <span class="sy0">=&gt;</span> m<span class="sy0">.</span><span class="me1">Groups</span><span class="br0">&#91;</span><span class="st0">&quot;value&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Note that the regex is sufficiently resistant to abuse, for example, it will work fine if the spaces around the strings are garbled:
</p>
<pre class="code">Color , Red,     Life,Good , Day , Sunday</pre>

<p>
Another, better variant is to use a splitting regular expression and then collect the even and odd keys with a bit of LINQ:
</p>
<pre class="code csharp"><span class="kw1">using</span> <span class="co3">System.Text.RegularExpressions</span><span class="sy0">;</span>
<span class="co1">//...</span>
<span class="kw1">public</span> <span class="kw1">static</span> Regex CSVRegEx <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Regex<span class="br0">&#40;</span><span class="st_h">@&quot;\s*,\s*(?=(?:[^\&quot;</span><span class="st0">&quot;]*<span class="es0">\&quot;</span>&quot;</span><span class="br0">&#91;</span><span class="sy0">^</span>\<span class="st0">&quot;&quot;</span><span class="br0">&#93;</span><span class="sy0">*</span>\<span class="st0">&quot;&quot;</span><span class="br0">&#41;</span><span class="sy0">*</span><span class="br0">&#40;</span><span class="sy0">?!</span><span class="br0">&#91;</span><span class="sy0">^</span>\<span class="st0">&quot;&quot;</span><span class="br0">&#93;</span><span class="sy0">*</span>\<span class="st0">&quot;&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="st0">&quot;,
            RegexOptions.Compiled);
//...
foreach (KeyValuePair&lt;string, string&gt; a in CSVRegEx.Split(input).Select((value, index) =&gt; new {value, index})
    .GroupBy(x =&gt; x.index/2, x =&gt; x.value)
    .Select(x =&gt; x.ToList())
    .TakeWhile(o =&gt; o.Count % 2 == 0)
    .ToDictionary(o =&gt; o.First(), p =&gt; p.Last()))
{
    Console.WriteLine(a);
}</span></pre>

<p>
For more details, see <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp#group_a_sequence_by_pairs" class="wikilink1" title="fuss:csharp" data-wiki-id="fuss:csharp">group a sequence by pairs</a>.
</p>

</div>

<h1 class="sectionedit14" id="convert_hashtable_to_dictionary">Convert HashTable to Dictionary</h1>
<div class="level1">
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2014 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Converts a hash table to a dictionary.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;K&quot;&gt;key type&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;V&quot;&gt;value type&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;param name=&quot;table&quot;&gt;a hash table&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;a dictionary&lt;/returns&gt;</span>
<span class="kw1">public</span> <span class="kw1">static</span> Dictionary<span class="sy0">&lt;</span>K, V<span class="sy0">&gt;</span> HashtableToDictionary<span class="sy0">&lt;</span>K, V<span class="sy0">&gt;</span><span class="br0">&#40;</span>Hashtable table<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">return</span> table<span class="sy0">.</span><span class="me1">Cast</span><span class="sy0">&lt;</span>DictionaryEntry<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="me1">ToDictionary</span><span class="br0">&#40;</span>kvp <span class="sy0">=&gt;</span> <span class="br0">&#40;</span>K<span class="br0">&#41;</span>kvp<span class="sy0">.</span><span class="me1">Key</span>, kvp <span class="sy0">=&gt;</span> <span class="br0">&#40;</span>V<span class="br0">&#41;</span>kvp<span class="sy0">.</span><span class="kw1">Value</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit15" id="calculate_memory_size_of_object">Calculate Memory Size of Object</h1>
<div class="level1">
<pre class="code csharp"><span class="co1">/// &lt;summary&gt;</span>
<span class="co1">/// Calculates the length in bytes of an object </span>
<span class="co1">/// and returns the size </span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;TestObject&quot;&gt;&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw4">int</span> GetObjectSize<span class="br0">&#40;</span><span class="kw4">object</span> TestObject<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    BinaryFormatter bf <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> BinaryFormatter<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    MemoryStream ms <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> MemoryStream<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw4">byte</span><span class="br0">&#91;</span><span class="br0">&#93;</span> Array<span class="sy0">;</span>
    bf<span class="sy0">.</span><span class="me1">Serialize</span><span class="br0">&#40;</span>ms, TestObject<span class="br0">&#41;</span><span class="sy0">;</span>
    Array <span class="sy0">=</span> ms<span class="sy0">.</span><span class="me1">ToArray</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> Array<span class="sy0">.</span><span class="me1">Length</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit16" id="convert_a_unix_timestamp_to_datetime">Convert a UNIX Timestamp to DateTime</h1>
<div class="level1">

<p>
Using  the <code>wasUNIXTimeStampToDateTime</code> function we can convert a UNIX timestamp to a <code>DateTime</code> object:
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">/// Returns a DateTime object from a given UNIX timestamp.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;timeStamp&quot;&gt;the UNIX time stamp to convert&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the DateTime object representing the timeStamp&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> DateTime wasUNIXTimeStampToDateTime<span class="br0">&#40;</span><span class="kw4">double</span> timeStamp<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> DateTime<span class="br0">&#40;</span><span class="nu0">1970</span>, <span class="nu0">1</span>, <span class="nu0">1</span>, <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">AddSeconds</span><span class="br0">&#40;</span>timeStamp<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
an example call is:
</p>
<pre class="code csharp">DateTime date <span class="sy0">=</span> wasUNIXTimeStampToDateTime<span class="br0">&#40;</span><span class="nu0">1406583923</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h1 class="sectionedit17" id="convert_datetime_to_unix_timestamp">Convert DateTime to UNIX Timestamp</h1>
<div class="level1">

<p>
Given a <code>DateTime</code> object, the <code>wasDateTimeToUnixTimeStamp</code> function returns the UNIX timestamp.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">/// Returns the UNIX time from a DateTime object.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;date&quot;&gt;&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">double</span> wasDateTimeToUnixTimeStamp<span class="br0">&#40;</span>DateTime date<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> date<span class="sy0">.</span><span class="me1">Subtract</span><span class="br0">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> DateTime<span class="br0">&#40;</span><span class="nu0">1970</span>, <span class="nu0">1</span>, <span class="nu0">1</span>, <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">0</span>, <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Duration</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">TotalSeconds</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit18" id="get_an_enumeration_value_from_description">Get an Enumeration Value from Description</h1>
<div class="level1">

<p>
Suppose you have an enumeration, with the following structure:
</p>
<pre class="code csharp"><span class="br0">&#91;</span>Flags<span class="br0">&#93;</span>
<span class="kw1">private</span> <span class="kw4">enum</span> Days <span class="sy0">:</span> <span class="kw4">uint</span>
<span class="br0">&#123;</span>
    <span class="br0">&#91;</span>Description<span class="br0">&#40;</span><span class="st0">&quot;Monday&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
    ONE <span class="sy0">=</span> <span class="nu0">1</span>,
    <span class="br0">&#91;</span>Description<span class="br0">&#40;</span><span class="st0">&quot;Tuesday&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
    TWO <span class="sy0">=</span> <span class="nu0">2</span>
<span class="br0">&#125;</span></pre>

<p>
and you want to get the value (the <code>uint</code> <code>1</code>) of the field that has the description <code>Monday</code>.
</p>

<p>
In that case, using <code>wasGetEnumValueFromDescription</code>:
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2015 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Get enumeration value from its description.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;T&quot;&gt;the enumeration type&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;param name=&quot;description&quot;&gt;the description of a member&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the value or the default of T if case no description found&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> T wasGetEnumValueFromDescription<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> description<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">var</span> field <span class="sy0">=</span> <a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a> <span class="br0">&#40;</span>T<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetFields</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="me1">SelectMany</span><span class="br0">&#40;</span>f <span class="sy0">=&gt;</span> f<span class="sy0">.</span><span class="me1">GetCustomAttributes</span><span class="br0">&#40;</span>
            <a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a> <span class="br0">&#40;</span>DescriptionAttribute<span class="br0">&#41;</span>, <span class="kw1">false</span><span class="br0">&#41;</span>, <span class="br0">&#40;</span>
                f, a<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="br0">&#123;</span>Field <span class="sy0">=</span> f, Att <span class="sy0">=</span> a<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">SingleOrDefault</span><span class="br0">&#40;</span>a <span class="sy0">=&gt;</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>DescriptionAttribute<span class="br0">&#41;</span> a<span class="sy0">.</span><span class="me1">Att</span><span class="br0">&#41;</span>
                    <span class="sy0">.</span><span class="me1">Description</span> <span class="sy0">==</span> description<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> field <span class="sy0">!=</span> <span class="kw1">null</span> <span class="sy0">?</span> <span class="br0">&#40;</span>T<span class="br0">&#41;</span> field<span class="sy0">.</span><span class="me1">Field</span><span class="sy0">.</span><span class="me1">GetRawConstantValue</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">:</span> <span class="kw1">default</span><span class="br0">&#40;</span>T<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
you would make a call such as:
</p>
<pre class="code csharp"><span class="kw4">uint</span> day <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">uint</span><span class="br0">&#41;</span> wasGetEnumValueFromDescription<span class="br0">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Days<span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="st0">&quot;Monday&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
such that the <code>unit</code> <code>day</code> will hold the value <code>1</code> after the call.
</p>

</div>

<h1 class="sectionedit19" id="get_description_from_enumeration_value">Get Description from Enumeration Value</h1>
<div class="level1">

<p>
Suppose you have an enumeration, with the following structure:
</p>
<pre class="code csharp"><span class="br0">&#91;</span>Flags<span class="br0">&#93;</span>
<span class="kw1">private</span> <span class="kw4">enum</span> Days <span class="sy0">:</span> <span class="kw4">uint</span>
<span class="br0">&#123;</span>
    <span class="br0">&#91;</span>Description<span class="br0">&#40;</span><span class="st0">&quot;Monday&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
    ONE <span class="sy0">=</span> <span class="nu0">1</span>,
    <span class="br0">&#91;</span>Description<span class="br0">&#40;</span><span class="st0">&quot;Tuesday&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
    TWO <span class="sy0">=</span> <span class="nu0">2</span>
<span class="br0">&#125;</span></pre>

<p>
and you want to get the description (<code>Monday</code>) from the value <code>1</code>.
</p>

<p>
Using <code>wasGetDescriptionFromEnumValue</code>:
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2015 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Get the description from an enumeration value.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;value&quot;&gt;an enumeration value&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the description or the empty string&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">string</span> wasGetDescriptionFromEnumValue<span class="br0">&#40;</span><span class="kw4">Enum</span> <span class="kw1">value</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    DescriptionAttribute attribute <span class="sy0">=</span> <span class="kw1">value</span><span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="me1">GetField</span><span class="br0">&#40;</span><span class="kw1">value</span><span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="me1">GetCustomAttributes</span><span class="br0">&#40;</span><a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a> <span class="br0">&#40;</span>DescriptionAttribute<span class="br0">&#41;</span>, <span class="kw1">false</span><span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="me1">SingleOrDefault</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">as</span> DescriptionAttribute<span class="sy0">;</span>
    <span class="kw1">return</span> attribute <span class="sy0">!=</span> <span class="kw1">null</span> <span class="sy0">?</span> attribute<span class="sy0">.</span><span class="me1">Description</span> <span class="sy0">:</span> <span class="kw4">string</span><span class="sy0">.</span><span class="me1">Empty</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
you would make a call such as:
</p>
<pre class="code csharp"><span class="kw4">string</span> day <span class="sy0">=</span> wasGetDescriptionFromEnumValue<span class="br0">&#40;</span><span class="br0">&#40;</span>Days<span class="br0">&#41;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
such that the string <code>day</code> will hold the value <code>Monday</code> after the call.
</p>

</div>

<h1 class="sectionedit20" id="get_the_description_of_a_structure_member">Get the Description of a Structure Member</h1>
<div class="level1">

<p>
Suppose that you have a structure:
</p>
<pre class="code csharp"><span class="kw1">private</span> <span class="kw4">struct</span> Person
<span class="br0">&#123;</span>
    <span class="br0">&#91;</span>Description<span class="br0">&#40;</span><span class="st0">&quot;the name&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
    <span class="kw1">public</span> <span class="kw4">string</span> Name<span class="sy0">;</span>
    <span class="br0">&#91;</span>Description<span class="br0">&#40;</span><span class="st0">&quot;the age&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
    <span class="kw1">public</span> <span class="kw4">int</span> Age<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
and that you have instantiated the structure as:
</p>
<pre class="code csharp">Person person <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Person <span class="br0">&#123;</span>
    Name <span class="sy0">=</span> <span class="st0">&quot;Mr. Sparky&quot;</span>,
    Age <span class="sy0">=</span> <span class="nu0">34</span>
<span class="br0">&#125;</span></pre>

<p>
and you want to get the description of the <code>Age</code> member of the struct <code>Person</code>.
</p>

<p>
In that case, using <code>wasGetStructureMemberDescription</code>:
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2015 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Get the description of structure member.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;T&quot;&gt;the type of the structure to search&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;param name=&quot;structure&quot;&gt;the structure to search&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;item&quot;&gt;the value of the item to search&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the description or the empty string&lt;/returns&gt;</span>
<span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">string</span> wasGetStructureMemberDescription<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T structure, <span class="kw4">object</span> item<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> <span class="kw4">struct</span>
<span class="br0">&#123;</span>
    <span class="kw1">var</span> field <span class="sy0">=</span> <a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a><span class="br0">&#40;</span>T<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetFields</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="me1">SelectMany</span><span class="br0">&#40;</span>f <span class="sy0">=&gt;</span> f<span class="sy0">.</span><span class="me1">GetCustomAttributes</span><span class="br0">&#40;</span><a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a><span class="br0">&#40;</span>DescriptionAttribute<span class="br0">&#41;</span>, <span class="kw1">false</span><span class="br0">&#41;</span>,
            <span class="br0">&#40;</span>f, a<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="br0">&#123;</span> Field <span class="sy0">=</span> f, Att <span class="sy0">=</span> a <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">SingleOrDefault</span><span class="br0">&#40;</span>f <span class="sy0">=&gt;</span> f<span class="sy0">.</span><span class="me1">Field</span><span class="sy0">.</span><span class="me1">GetValue</span><span class="br0">&#40;</span>structure<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Equals</span><span class="br0">&#40;</span>item<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> field <span class="sy0">!=</span> <span class="kw1">null</span> <span class="sy0">?</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>DescriptionAttribute<span class="br0">&#41;</span>field<span class="sy0">.</span><span class="me1">Att</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Description</span> <span class="sy0">:</span> <span class="kw4">string</span><span class="sy0">.</span><span class="me1">Empty</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
you would make a call such as:
</p>
<pre class="code csharp"><span class="kw4">string</span> ageDescription <span class="sy0">=</span> wasGetStructureMemberDescription<span class="br0">&#40;</span>person, person<span class="sy0">.</span><span class="me1">Age</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
which will leave <code>ageDescription</code> containing the string <code>the age</code> after the call.
</p>

</div>

<h1 class="sectionedit21" id="get_all_descriptions_of_an_enumeration">Get All Descriptions of an Enumeration</h1>
<div class="level1">
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Returns all the field descriptions of an enumeration.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;enumeration&quot;&gt;the enumeration&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the field descriptions&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> IEnumerable<span class="sy0">&lt;</span><span class="kw4">string</span><span class="sy0">&gt;</span> wasGetEnumDescriptions<span class="br0">&#40;</span><span class="kw1">this</span> <span class="kw4">Enum</span> enumeration<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="kw1">from</span> fi <span class="kw1">in</span> enumeration<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetFields</span><span class="br0">&#40;</span>BindingFlags<span class="sy0">.</span><span class="kw1">Static</span> <span class="sy0">|</span> BindingFlags<span class="sy0">.</span><span class="kw1">Public</span><span class="br0">&#41;</span>
        <span class="kw1">select</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw4">Enum</span><span class="br0">&#41;</span> fi<span class="sy0">.</span><span class="me1">GetValue</span><span class="br0">&#40;</span>enumeration<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetAttribute</span><span class="sy0">&lt;</span>DescriptionAttribute<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="kw1">into</span> attribute
        <span class="kw1">where</span> attribute <span class="sy0">!=</span> <span class="kw1">null</span> <span class="sy0">&amp;&amp;</span> <span class="sy0">!</span><span class="kw4">string</span><span class="sy0">.</span><span class="me1">IsNullOrEmpty</span><span class="br0">&#40;</span>attribute<span class="sy0">.</span><span class="me1">Description</span><span class="br0">&#41;</span>
        <span class="kw1">select</span> attribute<span class="sy0">.</span><span class="me1">Description</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit22" id="bitwise_flag_enumerations">Bitwise Flag Enumerations</h1>
<div class="level1">

<p>
The following are functions that manipulate flag-type enumerations, such as:
</p>
<pre class="code csharp"><span class="br0">&#91;</span>Flags<span class="br0">&#93;</span>
<span class="kw1">private</span> <span class="kw4">enum</span> Days <span class="sy0">:</span> <span class="kw4">uint</span>
<span class="br0">&#123;</span>
    Monday <span class="sy0">=</span> <span class="nu0">1</span>,
    Tuesday <span class="sy0">=</span> <span class="nu0">2</span>,
    Wednesday <span class="sy0">=</span> <span class="nu0">4</span>,
    Thursday <span class="sy0">=</span> <span class="nu0">8</span>,
    Friday <span class="sy0">=</span> <span class="nu0">16</span>,
    Saturday <span class="sy0">=</span> <span class="nu0">32</span>,
    Sunday <span class="sy0">=</span> <span class="nu0">64</span>
<span class="br0">&#125;</span></pre>

<p>
and are useful before the .NET release 4.0 which has built-in functions that can manipulate flags.
</p>

</div>

<h2 class="sectionedit23" id="set_flags">Set Flags</h2>
<div class="level2">

<p>
Sets a flag (or a flag mask) in a flag enumeration.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">// Original by Dan Tao.</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Sets flag in flags.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;flags&quot;&gt;an enumeration to set flags on&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;flag&quot;&gt;a flag or mask to set on flags&lt;/param&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">void</span> SetFlags<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw1">ref</span> T flags, T flag<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> <span class="kw4">struct</span>
<span class="br0">&#123;</span>
    flags <span class="sy0">=</span> <span class="br0">&#40;</span>T<span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw4">uint</span><span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span> flags <span class="sy0">|</span> <span class="br0">&#40;</span><span class="kw4">uint</span><span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span> flag<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
For example, using the <code>Days</code> structure:
</p>
<pre class="code csharp">Days d <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Days<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
SetFlags<span class="br0">&#40;</span><span class="kw1">ref</span> d, Days<span class="sy0">.</span><span class="me1">Monday</span> <span class="sy0">|</span> Days<span class="sy0">.</span><span class="me1">Friday</span> <span class="sy0">|</span> Days<span class="sy0">.</span><span class="me1">Sunday</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h2 class="sectionedit24" id="unset_flags">Unset Flags</h2>
<div class="level2">

<p>
Unsets a flag (or flag mask) in a flag enumeration.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">// Original by Dan Tao.</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Unsets a flag.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;flags&quot;&gt;an enumeration to unset flags on&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;flag&quot;&gt;a flag or mask to unset of flags&lt;/param&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">void</span> UnsetFlags<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw1">ref</span> T flags, T flag<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> <span class="kw4">struct</span>
<span class="br0">&#123;</span>
    flags <span class="sy0">=</span> <span class="br0">&#40;</span>T<span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw4">uint</span><span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span> flags <span class="sy0">&amp;</span> <span class="br0">&#40;</span>~<span class="br0">&#40;</span><span class="kw4">uint</span><span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span> flag<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
For example, using the <code>Days</code> structure:
</p>
<pre class="code csharp">Days d <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Days<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
UnsetFlags<span class="br0">&#40;</span><span class="kw1">ref</span> d, Days<span class="sy0">.</span><span class="me1">Friday</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
or, for multiple flags:
</p>
<pre class="code csharp">Days d <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Days<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
UnsetFlags<span class="br0">&#40;</span><span class="kw1">ref</span> d, Days<span class="sy0">.</span><span class="me1">Friday</span> <span class="sy0">|</span> Days<span class="sy0">.</span><span class="me1">Sunday</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h2 class="sectionedit25" id="determine_if_a_flag_or_flag_mask_is_set">Determine if a Flag or Flag Mask is Set</h2>
<div class="level2">
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Determines if the flags in flag are set in the flags structure.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;flags&quot;&gt;the structure to check against&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;flag&quot;&gt;a single flag or a mask to check&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;true if flag is set in flags&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">bool</span> IsSetFlags<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T flags, T flag<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> <span class="kw4">struct</span>
<span class="br0">&#123;</span>
    <span class="kw1">return</span>
        <span class="kw4">Enum</span><span class="sy0">.</span><span class="me1">GetValues</span><span class="br0">&#40;</span><a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a> <span class="br0">&#40;</span>T<span class="br0">&#41;</span><span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="me1">Cast</span><span class="sy0">&lt;</span><span class="kw4">uint</span><span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="kw1">Where</span><span class="br0">&#40;</span>f <span class="sy0">=&gt;</span> <span class="br0">&#40;</span>f <span class="sy0">&amp;</span> <span class="br0">&#40;</span><span class="kw4">uint</span><span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span> flag<span class="br0">&#41;</span> <span class="sy0">==</span> f<span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="me1">All</span><span class="br0">&#40;</span><span class="kw1">set</span> <span class="sy0">=&gt;</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw4">uint</span><span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span> flags <span class="sy0">&amp;</span> <span class="kw1">set</span><span class="br0">&#41;</span> <span class="sy0">!=</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
For example, using the <code>Days</code> structure:
</p>
<pre class="code csharp">Days d <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Days<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
SetFlags<span class="br0">&#40;</span><span class="kw1">ref</span> d, Days<span class="sy0">.</span><span class="me1">Monday</span> <span class="sy0">|</span> Days<span class="sy0">.</span><span class="me1">Friday</span> <span class="sy0">|</span> Days<span class="sy0">.</span><span class="me1">Sunday</span><span class="br0">&#41;</span><span class="sy0">;</span>
IsSetFlags<span class="br0">&#40;</span><span class="kw1">ref</span> d, Days<span class="sy0">.</span><span class="me1">Monday</span> <span class="sy0">|</span> Days<span class="sy0">.</span><span class="me1">Friday</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
the return value of <code>IsSetFlags</code> will be <code>True</code>.
</p>

</div>

<h2 class="sectionedit26" id="get_the_values_of_set_flags">Get the Values of Set Flags</h2>
<div class="level2">

<p>
Gets the values of set flags in an enumeration.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Gets the flag values in flags.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;flags&quot;&gt;an enumeration with certain flags set&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the values of the flags set&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> IEnumerable<span class="sy0">&lt;</span><span class="kw4">uint</span><span class="sy0">&gt;</span> GetSetFlagValues<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T flags<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> <span class="kw4">struct</span>
<span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="kw4">Enum</span><span class="sy0">.</span><span class="me1">GetValues</span><span class="br0">&#40;</span><a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a><span class="br0">&#40;</span>T<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Cast</span><span class="sy0">&lt;</span><span class="kw4">uint</span><span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="kw1">Where</span><span class="br0">&#40;</span>f <span class="sy0">=&gt;</span> <span class="br0">&#40;</span>f <span class="sy0">&amp;</span> <span class="br0">&#40;</span><span class="kw4">uint</span><span class="br0">&#41;</span><span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span>flags<span class="br0">&#41;</span> <span class="sy0">==</span> f<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
For example, using the <code>Days</code> structure:
</p>
<pre class="code csharp">Days d <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Days<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
SetFlags<span class="br0">&#40;</span><span class="kw1">ref</span> d, Days<span class="sy0">.</span><span class="me1">Monday</span> <span class="sy0">|</span> Days<span class="sy0">.</span><span class="me1">Friday</span> <span class="sy0">|</span> Days<span class="sy0">.</span><span class="me1">Sunday</span><span class="br0">&#41;</span><span class="sy0">;</span>
List<span class="sy0">&lt;</span><span class="kw4">uint</span><span class="sy0">&gt;</span> <span class="kw1">set</span> <span class="sy0">=</span> GetSetFlagValues<span class="br0">&#40;</span>d<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">ToList</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="kw4">uint</span> <span class="kw1">value</span> <span class="kw1">in</span> <span class="kw1">set</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    Console<span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">&#40;</span><span class="kw1">value</span><span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
will print out:
</p>
<pre class="code">1
16
64</pre>

</div>

<h2 class="sectionedit27" id="get_the_names_of_set_flags">Get the Names of Set Flags</h2>
<div class="level2">

<p>
Gets the names of set flags.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Gets the names of the flags set in flags.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;flags&quot;&gt;an enumeration with certain flags set&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the names of the set flags&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> IEnumerable<span class="sy0">&lt;</span><span class="kw4">string</span><span class="sy0">&gt;</span> GetSetFlagNames<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T flags<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> <span class="kw4">struct</span>
<span class="br0">&#123;</span>
    <span class="kw1">return</span>
        <span class="kw4">Enum</span><span class="sy0">.</span><span class="me1">GetValues</span><span class="br0">&#40;</span><a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a> <span class="br0">&#40;</span>T<span class="br0">&#41;</span><span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="me1">Cast</span><span class="sy0">&lt;</span><span class="kw4">uint</span><span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="kw1">Where</span><span class="br0">&#40;</span>f <span class="sy0">=&gt;</span> <span class="br0">&#40;</span>f <span class="sy0">&amp;</span> <span class="br0">&#40;</span><span class="kw4">uint</span><span class="br0">&#41;</span><span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span>flags<span class="br0">&#41;</span> <span class="sy0">==</span> f<span class="br0">&#41;</span>
        <span class="sy0">.</span><span class="kw1">Select</span><span class="br0">&#40;</span>f <span class="sy0">=&gt;</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>T<span class="br0">&#41;</span> <span class="br0">&#40;</span><span class="kw4">object</span><span class="br0">&#41;</span> f<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
For example, using the <code>Days</code> structure:
</p>
<pre class="code csharp">Days d <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Days<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
SetFlags<span class="br0">&#40;</span><span class="kw1">ref</span> d, Days<span class="sy0">.</span><span class="me1">Monday</span> <span class="sy0">|</span> Days<span class="sy0">.</span><span class="me1">Friday</span> <span class="sy0">|</span> Days<span class="sy0">.</span><span class="me1">Sunday</span><span class="br0">&#41;</span><span class="sy0">;</span>
List<span class="sy0">&lt;</span><span class="kw4">string</span><span class="sy0">&gt;</span> <span class="kw1">set</span> <span class="sy0">=</span> GetSetFlagNames<span class="br0">&#40;</span>d<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">ToList</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="kw4">string</span> name <span class="kw1">in</span> <span class="kw1">set</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    Console<span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">&#40;</span>name<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
will print out:
</p>
<pre class="code">Monday
Friday
Sunday</pre>

</div>

<h1 class="sectionedit28" id="graceful_shutdown_of_console_applications">Graceful Shutdown of Console Applications</h1>
<div class="level1">

<p>
Capturing the closing event of a console under Windows can be done by importing the <code>SetConsoleCtrlHandler</code> function from <code>Kernel32.dll</code> and has been discussed in the <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/windows#programatically_capture_console_close_button" class="wikilink1" title="fuss:windows" data-wiki-id="fuss:windows">windows section</a>. However, <code>kernel32.dll</code> is not available under <code>mono</code> and will not work on Unix platforms. In order to  be able to capture both the console close and sending a termination signal such as <code>SIGTERM</code> under Unix, the following variation branches on the platform and uses <code>SetConsoleCtrlHandler</code> under Windows and signals under Unix:
</p>
<pre class="code csharp"><span class="co1">// For Unix signals.</span>
<span class="kw1">using</span> <span class="co3">Mono.Unix</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">Mono.Unix.Native</span><span class="sy0">;</span>
<span class="co1">// For Windows events.</span>
<span class="kw1">using</span> <span class="co3">System.Runtime.InteropServices</span><span class="sy0">;</span>
&nbsp;
<span class="co1">//...</span>
&nbsp;
        <span class="co1">/// &lt;summary&gt;</span>
        <span class="co1">///     Import console handler for windows.</span>
        <span class="co1">/// &lt;/summary&gt;</span>
        <span class="br0">&#91;</span>DllImport<span class="br0">&#40;</span><span class="st0">&quot;Kernel32.dll&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
        <span class="kw1">private</span> <span class="kw1">static</span> <span class="kw1">extern</span> <span class="kw4">bool</span> SetConsoleCtrlHandler<span class="br0">&#40;</span>EventHandler handler, <span class="kw4">bool</span> <span class="kw1">add</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">// A delegate for SetConsoleCtrlHandler.</span>
        <span class="kw1">private</span> <span class="kw4">delegate</span> <span class="kw4">bool</span> EventHandler<span class="br0">&#40;</span>CtrlType ctrlType<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">// Set to static in order to avoid garbage collection.</span>
        <span class="kw1">private</span> <span class="kw1">static</span> EventHandler ConsoleEventHandler<span class="sy0">;</span>
&nbsp;
        <span class="co1">// An enumerated type for the control messages</span>
        <span class="co1">// sent to the handler routine.</span>
        <span class="kw1">private</span> <span class="kw4">enum</span> CtrlType
        <span class="br0">&#123;</span>
            CTRL_C_EVENT <span class="sy0">=</span> <span class="nu0">0</span>,
            CTRL_BREAK_EVENT,
            CTRL_CLOSE_EVENT,
            CTRL_LOGOFF_EVENT <span class="sy0">=</span> <span class="nu0">5</span>,
            CTRL_SHUTDOWN_EVENT
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">bool</span> ConsoleCtrlCheck<span class="br0">&#40;</span>CtrlType ctrlType<span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            KeyValuePair<span class="sy0">&lt;</span><span class="kw4">char</span>, ManualResetEvent<span class="sy0">&gt;</span> semaphore <span class="sy0">=</span> ConnectionSemaphores<span class="sy0">.</span><span class="me1">FirstOrDefault</span><span class="br0">&#40;</span>s <span class="sy0">=&gt;</span> s<span class="sy0">.</span><span class="me1">Key</span><span class="sy0">.</span><span class="me1">Equals</span><span class="br0">&#40;</span><span class="st0">'u'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>semaphore<span class="sy0">.</span><span class="kw1">Value</span> <span class="sy0">!=</span> <span class="kw1">null</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                semaphore<span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">.</span><span class="kw1">Set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
&nbsp;
            <span class="co1">// Wait for threads to finish.</span>
            Thread<span class="sy0">.</span><span class="me1">Sleep</span><span class="br0">&#40;</span><span class="nu0">60000</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">return</span> <span class="kw1">true</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// Main entry point.</span>
        <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> Main<span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            <span class="co1">// Branch on platform and set-up termination handlers.</span>
            <span class="kw1">switch</span> <span class="br0">&#40;</span>Environment<span class="sy0">.</span><span class="me1">OSVersion</span><span class="sy0">.</span><span class="me1">Platform</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                    <span class="co1">// SetConsoleCtrlHandler supported on Windows 2000 or later.</span>
                <span class="kw1">case</span> PlatformID<span class="sy0">.</span><span class="me1">Win32NT</span><span class="sy0">:</span>
                    <span class="co1">// Setup console handler.</span>
                    ConsoleEventHandler <span class="sy0">+=</span> ConsoleCtrlCheck<span class="sy0">;</span>
                    SetConsoleCtrlHandler<span class="br0">&#40;</span>ConsoleEventHandler, <span class="kw1">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
                    <span class="kw1">break</span><span class="sy0">;</span>
                    <span class="co1">// For Unix signals, catch SIGTERM (daemon).</span>
                <span class="kw1">case</span> PlatformID<span class="sy0">.</span><span class="me1">Unix</span><span class="sy0">:</span>
                    UnixSignal<span class="br0">&#91;</span><span class="br0">&#93;</span> signals <span class="sy0">=</span>
                    <span class="br0">&#123;</span>
                        <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> UnixSignal<span class="br0">&#40;</span>Signum<span class="sy0">.</span><span class="me1">SIGTERM</span><span class="br0">&#41;</span>
                    <span class="br0">&#125;</span><span class="sy0">;</span>
                    <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Thread<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">=&gt;</span>
                    <span class="br0">&#123;</span>
                        UnixSignal<span class="sy0">.</span><span class="me1">WaitAny</span><span class="br0">&#40;</span>signals, <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
                        KeyValuePair<span class="sy0">&lt;</span><span class="kw4">char</span>, ManualResetEvent<span class="sy0">&gt;</span> semaphore <span class="sy0">=</span>
                            ConnectionSemaphores<span class="sy0">.</span><span class="me1">FirstOrDefault</span><span class="br0">&#40;</span>s <span class="sy0">=&gt;</span> s<span class="sy0">.</span><span class="me1">Key</span><span class="sy0">.</span><span class="me1">Equals</span><span class="br0">&#40;</span><span class="st0">'u'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
                        <span class="kw1">if</span> <span class="br0">&#40;</span>semaphore<span class="sy0">.</span><span class="kw1">Value</span> <span class="sy0">!=</span> <span class="kw1">null</span><span class="br0">&#41;</span>
                        <span class="br0">&#123;</span>
                            semaphore<span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">.</span><span class="kw1">Set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
                        <span class="br0">&#125;</span>
                    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Start</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
                    <span class="kw1">break</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
&nbsp;
            <span class="co1">// Rest of the program</span>
            <span class="co1">// ...</span>
        <span class="br0">&#125;</span></pre>

<p>
This method will branch on <code>Environment.OSVersion.Platform</code> and decide what is suitable for each platform. Note, that if the coding is done on Windows, that the <code>Mono.Posix.dll</code> library has to be added to the list of references in Visual Studio. This can be accomplished by downloading <code>mono</code> for Windows and the <code>DLL</code> can usually be found in: <code>C:\Program Files (x86)\Mono-3.2.3\lib\mono\2.0</code>.
</p>

</div>

<h1 class="sectionedit29" id="split_string_into_groups_of_strings">Split String into Groups of Strings</h1>
<div class="level1">

<p>
Using LINQ, this can be done by:
</p>
<pre class="code csharp"><span class="kw4">int</span> groups <span class="sy0">=</span> <span class="nu0">2</span><span class="sy0">;</span>
&nbsp;
IEnumerable<span class="sy0">&lt;</span><span class="kw4">string</span><span class="sy0">&gt;</span> strings <span class="sy0">=</span> data<span class="sy0">.</span><span class="kw1">Select</span><span class="br0">&#40;</span><span class="br0">&#40;</span>c, index<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="br0">&#123;</span>c, index<span class="br0">&#125;</span><span class="br0">&#41;</span>
    <span class="sy0">.</span><span class="me1">GroupBy</span><span class="br0">&#40;</span>x <span class="sy0">=&gt;</span> x<span class="sy0">.</span><span class="me1">index</span><span class="sy0">/</span>groups<span class="br0">&#41;</span>
    <span class="sy0">.</span><span class="kw1">Select</span><span class="br0">&#40;</span>xg <span class="sy0">=&gt;</span> <span class="kw4">string</span><span class="sy0">.</span><span class="kw1">Join</span><span class="br0">&#40;</span><span class="st0">&quot;&quot;</span>, xg<span class="sy0">.</span><span class="kw1">Select</span><span class="br0">&#40;</span>x <span class="sy0">=&gt;</span> x<span class="sy0">.</span><span class="me1">c</span><span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span>CultureInfo<span class="sy0">.</span><span class="me1">InvariantCulture</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">ToArray</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
where <code>groups</code> represents the number of groups to split a string into.
</p>

<p>
For example, for a string such as:
</p>
<pre class="code">good day!</pre>

<p>
and <code>groups</code> set to <code>2</code>, the resulting substrings will be:
</p>
<pre class="code">go
od
 d
ay
!</pre>

</div>

<h1 class="sectionedit30" id="rfc3986_uri_escape_and_unescape_a_data_string">RFC3986 URI Escape and Unescape a Data String</h1>
<div class="level1">

<p>
The <code>Uri.EscapeDataString</code> function in C# has a <code>32766</code> character limit, after which the function will throw an <code>UriFormatException</code> error (as per the <a href="http://msdn.microsoft.com/en-us/library/system.uri.escapedatastring(v=vs.110).aspx" class="urlextern" title="http://msdn.microsoft.com/en-us/library/system.uri.escapedatastring(v=vs.110).aspx" rel="ugc nofollow">MSDN documentation</a>). The following functions are replacements for both <code>Uri.EscapeDataString</code> and <code>Uri.UnescapeDataString</code> that will accept longer strings.
</p>

</div>

<h2 class="sectionedit31" id="unescape">Unescape</h2>
<div class="level2">
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2014 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;URI Unescapes an RFC3986 string&lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;data&quot;&gt;a string to unescape&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the resulting string&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">string</span> wasUriUnescapeDataString<span class="br0">&#40;</span><span class="kw4">string</span> data<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">return</span>
        Regex<span class="sy0">.</span><span class="me1">Matches</span><span class="br0">&#40;</span>data, <span class="st_h">@&quot;%([0-9A-Fa-f]+?){2}&quot;</span><span class="br0">&#41;</span>
            <span class="sy0">.</span><span class="me1">Cast</span><span class="sy0">&lt;</span>Match<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
            <span class="sy0">.</span><span class="kw1">Select</span><span class="br0">&#40;</span>m <span class="sy0">=&gt;</span> m<span class="sy0">.</span><span class="kw1">Value</span><span class="br0">&#41;</span>
            <span class="sy0">.</span><span class="me1">Distinct</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
            <span class="sy0">.</span><span class="me1">Aggregate</span><span class="br0">&#40;</span>data,
                <span class="br0">&#40;</span>current, match<span class="br0">&#41;</span> <span class="sy0">=&gt;</span>
                    current<span class="sy0">.</span><span class="me1">Replace</span><span class="br0">&#40;</span>match,
                        <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw4">char</span><span class="br0">&#41;</span> <span class="kw4">int</span><span class="sy0">.</span><span class="me1">Parse</span><span class="br0">&#40;</span>match<span class="sy0">.</span><span class="me1">Substring</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>, NumberStyles<span class="sy0">.</span><span class="me1">AllowHexSpecifier</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span>
                            CultureInfo<span class="sy0">.</span><span class="me1">InvariantCulture</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h2 class="sectionedit32" id="escape">Escape</h2>
<div class="level2">
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2014 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;RFC3986 URI Escapes a string&lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;data&quot;&gt;a string to escape&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;an RFC3986 escaped string&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">string</span> wasUriEscapeDataString<span class="br0">&#40;</span><span class="kw4">string</span> data<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    StringBuilder result <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> StringBuilder<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="kw4">char</span> c <span class="kw1">in</span> data<span class="sy0">.</span><span class="kw1">Select</span><span class="br0">&#40;</span>o <span class="sy0">=&gt;</span> o<span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">if</span><span class="br0">&#40;</span><span class="kw4">char</span><span class="sy0">.</span><span class="me1">IsLetter</span><span class="br0">&#40;</span>c<span class="br0">&#41;</span> <span class="sy0">||</span> <span class="kw4">char</span><span class="sy0">.</span><span class="me1">IsDigit</span><span class="br0">&#40;</span>c<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            result<span class="sy0">.</span><span class="me1">Append</span><span class="br0">&#40;</span>c<span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
        result<span class="sy0">.</span><span class="me1">AppendFormat</span><span class="br0">&#40;</span><span class="st0">&quot;%{0:X2}&quot;</span>, <span class="br0">&#40;</span><span class="kw4">int</span><span class="br0">&#41;</span> c<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw1">return</span> result<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit33" id="fibonacci_number_generator">Fibonacci Number Generator</h1>
<div class="level1">

<p>
As a translation of the <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/lolcode#fibonacci_number_generator" class="wikilink1" title="fuss:lolcode" data-wiki-id="fuss:lolcode">lolcode variant</a>, this Fibonacci number generator will return <code>count</code>-sequential Fibonacci numbers starting with the initialization vector <code>first</code> and <code>second</code> (which can be either <code>0</code>, <code>1</code> or <code>1</code>, <code>1</code>).
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Returns count sequential Fibonacci numbers given the initialization</span>
<span class="co1">///     vector parameters first and second which can be either 0, 1 or 1, 1.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;count&quot;&gt;the amount of Fibonacci numbers &lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;first&quot;&gt;the first number, either 0 or 1&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;second&quot;&gt;the second number has to be 1&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;count sequential Fibonacci numbers&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> IEnumerable<span class="sy0">&lt;</span><span class="kw4">ulong</span><span class="sy0">&gt;</span> wasFibonacci<span class="br0">&#40;</span><span class="kw4">ulong</span> count, <span class="kw4">ulong</span> first, <span class="kw4">ulong</span> second<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>count <span class="sy0">&lt;=</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">yield</span> <span class="kw1">break</span><span class="sy0">;</span>
    <span class="kw1">yield</span> <span class="kw1">return</span> first<span class="sy0">;</span>
    <span class="kw1">foreach</span><span class="br0">&#40;</span><span class="kw4">ulong</span> f <span class="kw1">in</span> wasFibonacci<span class="br0">&#40;</span><span class="sy0">--</span>count, second, first <span class="sy0">+</span> second<span class="br0">&#41;</span><span class="br0">&#41;</span>
        <span class="kw1">yield</span> <span class="kw1">return</span> f<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit34" id="determine_if_number_is_a_power_of_two">Determine if Number is a Power of Two</h1>
<div class="level1">

<p>
The function <code>IsPowerOfTwo</code> returns true if the number <code>n</code> is a power of two and false otherwise.
</p>
<pre class="code csharp"><span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">bool</span> IsPowerOfTwo<span class="br0">&#40;</span><span class="kw4">uint</span> n<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="br0">&#40;</span>n <span class="sy0">&amp;</span> <span class="br0">&#40;</span>n <span class="sy0">-</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="nu0">0</span> <span class="sy0">&amp;&amp;</span> n <span class="sy0">!=</span> <span class="nu0">0</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit35" id="xor_swap_two_integers">XOR Swap Two Integers</h1>
<div class="level1">

<p>
This is actually very elegant in C# using the <code>ref</code> operator which allows us to create a function <code>wasXORSwap</code> that will swap the two integers <code>q</code> and <code>p</code> using the XOR swap algorithm.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2014 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Swaps two integers passed by reference using XOR.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;q&quot;&gt;first integer to swap&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;p&quot;&gt;second integer to swap&lt;/param&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">void</span> wasXORSwap<span class="br0">&#40;</span><span class="kw1">ref</span> <span class="kw4">int</span> q, <span class="kw1">ref</span> <span class="kw4">int</span> p<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    q <span class="sy0">^=</span> p<span class="sy0">;</span>
    p <span class="sy0">^=</span> q<span class="sy0">;</span>
    q <span class="sy0">^=</span> p<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit36" id="parallel_insertion_of_matrix_values_in_flat_array">Parallel Insertion of Matrix Values in Flat Array</h1>
<div class="level1">

<p>
One interesting problem is the following: suppose that you have a certain terrain, from the bottom-left corner <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img0deecacb384365b88ccac3f21b5de3c9.png" class="latex_inline" alt="$A(x_{1}, y_{1})$" title="Math" /> to the top-right corner <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img55f651dfb7024abb6de34f3db7acfec8.png" class="latex_inline" alt="$B(x_{2}, y_{2})$" title="Math" /> and that the domain of values for <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img332cc365a4987aacce0ead01b8bdcc0b.png" class="latex_inline" alt="$x$" title="Math" /> and <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/imgdeceeaf6940a8c7a5a02373728002b0f.png" class="latex_inline" alt="$y$" title="Math" /> is discrete. You want to measure the height for each coordinate <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img55420865f046b0d2277688cc1d36e55b.png" class="latex_inline" alt="$C(x_{i}, y_{j})$" title="Math" /> in the rectangle whose diagonal is <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img98f18a589e25985312eb9436c7b8db65.png" class="latex_inline" alt="$\overline{AB}$" title="Math" /> and store it in a flat array of values.
</p>

<p>
This is perhaps visualised better as a grid (or a matrix):
</p>
<pre class="code">x x B
x x x
A x x </pre>

<p>
where each element has a certain height.
</p>

<p>
It is clear that this will turn out to be an <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img7b25d69bfeac6146b87105e365c75c90.png" class="latex_inline" alt="$O^2$" title="Math" /> algorithm because every single coordinate will have to be measured. However, if you benefit from threads, then depending on the number of threads that can be run in parallel, the <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img7b25d69bfeac6146b87105e365c75c90.png" class="latex_inline" alt="$O^2$" title="Math" /> complexity can be reduced considerably. In the visualisation above, we have to visit 9 different coordinates, and, were we to have 9 CPUs, then the entire <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img7b25d69bfeac6146b87105e365c75c90.png" class="latex_inline" alt="$O^2$" title="Math" /> algorithm could be reduced to an <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/imgd10b91eded32cc30b1b3b085e7e17b28.png" class="latex_inline" alt="$O1$" title="Math" /> algorithm.
</p>

<p>
In order to write the algorithm, we are first going to compute the index of each element on the grid, in the order that we measure it by. From the visualisation, we have the following grid:
</p>
<pre class="code">2 5 8
1 4 7
0 3 6 </pre>

<p>
from <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img53d147e7f3fe6e47ee05b88b166bd3f6.png" class="latex_inline" alt="$A$" title="Math" /> at index <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img29632a9bf827ce0200454dd32fc3be82.png" class="latex_inline" alt="$0$" title="Math" /> to <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img61e84f854bc6258d4108d08d4c4a0852.png" class="latex_inline" alt="$B$" title="Math" /> at index <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img005c128d6e551735fa5d938e44e7a613.png" class="latex_inline" alt="$8$" title="Math" />. We express the index of the array in function of our current <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img332cc365a4987aacce0ead01b8bdcc0b.png" class="latex_inline" alt="$x$" title="Math" /> and <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/imgdeceeaf6940a8c7a5a02373728002b0f.png" class="latex_inline" alt="$y$" title="Math" /> coordinate:
</p>

<p>
<img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img9abbdf54fe0cb045b9f7dee20998aa06.png" class="latex_displayed" alt="\begin{eqnarray*}
\text{index} &amp;=&amp; x_{max} * x + y
\end{eqnarray*}" title="Equations" />
</p>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img332cc365a4987aacce0ead01b8bdcc0b.png" class="latex_inline" alt="$x$" title="Math" /> and <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/imgdeceeaf6940a8c7a5a02373728002b0f.png" class="latex_inline" alt="$y$" title="Math" /> represent the current location,</div>
</li>
<li class="level1"><div class="li"> <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/img7dfa6383a0e8f64792b76e348a15df06.png" class="latex_inline" alt="$x_{max}$" title="Math" /> represents the width of the grid.</div>
</li>
</ul>

<p>
Now we can write the algorithm:
</p>
<pre class="code csharp"><span class="co1">// calculate the sizes for x and y</span>
<span class="kw4">int</span> sx <span class="sy0">=</span> x2 <span class="sy0">-</span> x1 <span class="sy0">+</span> <span class="nu0">1</span><span class="sy0">;</span>
<span class="kw4">int</span> sy <span class="sy0">=</span> y2 <span class="sy0">-</span> y1 <span class="sy0">+</span> <span class="nu0">1</span><span class="sy0">;</span>
<span class="co1">// create an array of the total size (sx*sy)</span>
<span class="kw4">float</span><span class="br0">&#91;</span><span class="br0">&#93;</span> data <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="kw4">float</span><span class="br0">&#91;</span>sx<span class="sy0">*</span>sy<span class="br0">&#93;</span><span class="sy0">;</span>
<span class="co1">// loop over the range of x, loop over the range of y</span>
Parallel<span class="sy0">.</span><span class="kw1">ForEach</span><span class="br0">&#40;</span>Enumerable<span class="sy0">.</span><span class="me1">Range</span><span class="br0">&#40;</span>x1, sx<span class="br0">&#41;</span>, x <span class="sy0">=&gt;</span> Parallel<span class="sy0">.</span><span class="kw1">ForEach</span><span class="br0">&#40;</span>Enumerable<span class="sy0">.</span><span class="me1">Range</span><span class="br0">&#40;</span>y1, sy<span class="br0">&#41;</span>, y <span class="sy0">=&gt;</span>
<span class="br0">&#123;</span>
    <span class="co1">// if the height can be determined at a given </span>
    <span class="co1">// x and y, then set the height at the correct </span>
    <span class="co1">// index in the flat array of values.</span>
    <span class="kw4">float</span> height<span class="sy0">;</span>
    data<span class="br0">&#91;</span>sx <span class="sy0">*</span> x <span class="sy0">+</span> y<span class="br0">&#93;</span> <span class="sy0">=</span> Client<span class="sy0">.</span><span class="me1">Network</span><span class="sy0">.</span><span class="me1">CurrentSim</span><span class="sy0">.</span><span class="me1">TerrainHeightAtPoint</span><span class="br0">&#40;</span>x, y, <span class="kw1">out</span> height<span class="br0">&#41;</span>
        <span class="sy0">?</span> height
        <span class="sy0">:</span> <span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
One of the nice remarks about this algorithm is that it does not use any form of locking - every single task works on one single index such that no locking is needed for insertion. Even if we were to use locks, we would have a problem, because we could not tell in what order the elements would be inserted. Using the formula however, we can make sure that each task can run independently of other tasks.
</p>

</div>

<h1 class="sectionedit37" id="compressing_a_http_web_request">Compressing a HTTP Web Request</h1>
<div class="level1">

<p>
Using <code>gzip</code> compression to compress a request:
</p>
<pre class="code csharp"><span class="kw1">using</span> <span class="co3">System.IO.Compression</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// ...</span>
&nbsp;
<span class="kw1">using</span> <span class="br0">&#40;</span>Stream requestStream <span class="sy0">=</span> request<span class="sy0">.</span><span class="me1">GetRequestStream</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">using</span><span class="br0">&#40;</span><span class="kw1">var</span> zipStream <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> GZipStream<span class="br0">&#40;</span>requestStream, CompressionMode<span class="sy0">.</span><span class="me1">Compress</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        zipStream<span class="sy0">.</span><span class="me1">Write</span><span class="br0">&#40;</span>byteData, <span class="nu0">0</span>, byteData<span class="sy0">.</span><span class="me1">Length</span><span class="br0">&#41;</span><span class="sy0">;</span>         
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

<p>
which is different from requesting a compressed response, which is more common.
</p>

</div>

<h1 class="sectionedit38" id="permute_an_array">Permute an Array</h1>
<div class="level1">

<p>
<code>wasReversePermuteArrayElements</code> and <code>wasForwardPermuteArrayElements</code> permute an array by shifting their elements either in reverse or forward directions.
</p>

</div>

<h2 class="sectionedit39" id="reverse">Reverse</h2>
<div class="level2">

<p>
Suppose you have an array with the elements:
</p>
<pre class="code">a b c</pre>

<p>
then a call such as <code>wasReversePermuteArrayElements(array, 1)</code> will return the elements:
</p>
<pre class="code">b c a</pre>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2014 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Permutes an array in reverse a given number of times.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;T&quot;&gt;the array type&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;param name=&quot;input&quot;&gt;the array&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;times&quot;&gt;the number of times to permute&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the array with the elements permuted&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> wasReversePermuteArrayElements<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> input, <span class="kw4">int</span> times<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>times<span class="sy0">.</span><span class="me1">Equals</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">return</span> input<span class="sy0">;</span>
    T<span class="br0">&#91;</span><span class="br0">&#93;</span> slice <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>input<span class="sy0">.</span><span class="me1">Length</span><span class="br0">&#93;</span><span class="sy0">;</span>
    Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>input, <span class="nu0">1</span>, slice, <span class="nu0">0</span>, input<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>input, <span class="nu0">0</span>, slice, input<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> <span class="nu0">1</span>, <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> wasReversePermuteAttayElements<span class="br0">&#40;</span>slice, <span class="sy0">--</span>times<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h2 class="sectionedit40" id="forward">Forward</h2>
<div class="level2">

<p>
Suppose you have an array with the elements:
</p>
<pre class="code">a b c</pre>

<p>
then a call such as <code>wasForwardPermuteArrayElements(array, 1)</code> will return the elements:
</p>
<pre class="code">c a b</pre>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2014 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Permutes an array forward a given number of times.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;T&quot;&gt;the array type&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;param name=&quot;input&quot;&gt;the array&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;times&quot;&gt;the number of times to permute&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the array with the elements permuted&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> wasForwardPermuteArrayElements<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> input, <span class="kw4">int</span> times<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>times<span class="sy0">.</span><span class="me1">Equals</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">return</span> input<span class="sy0">;</span>
    T<span class="br0">&#91;</span><span class="br0">&#93;</span> slice <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>input<span class="sy0">.</span><span class="me1">Length</span><span class="br0">&#93;</span><span class="sy0">;</span>
    Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>input, input<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> <span class="nu0">1</span>, slice, <span class="nu0">0</span>, <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>input, <span class="nu0">0</span>, slice, <span class="nu0">1</span>, input<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> wasForwardPermuteArrayElements<span class="br0">&#40;</span>slice, <span class="sy0">--</span>times<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit41" id="swap_array_elements">Swap Array Elements</h1>
<div class="level1">

<p>
The <code>wasArraySwap</code> swaps two elements in an array.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2014 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Swaps two elements in an array.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;T&quot;&gt;the array type&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;param name=&quot;input&quot;&gt;the array&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;p&quot;&gt;first element&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;q&quot;&gt;last element&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the array with the elements swapped&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> wasArraySwap<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> input, T p, T q<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    T<span class="br0">&#91;</span><span class="br0">&#93;</span> swap <span class="sy0">=</span> input<span class="sy0">.</span><span class="me1">Clone</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">as</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="kw4">int</span> i <span class="sy0">=</span> Array<span class="sy0">.</span><span class="me1">IndexOf</span><span class="br0">&#40;</span>input, p<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw4">int</span> j <span class="sy0">=</span> Array<span class="sy0">.</span><span class="me1">IndexOf</span><span class="br0">&#40;</span>input, q<span class="br0">&#41;</span><span class="sy0">;</span>
    Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>input, i, swap, j, <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>input, j, swap, i, <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> swap<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit42" id="concatenate_array_elements">Concatenate Array Elements</h1>
<div class="level1">

<p>
Given several arrays as input, the <code>wasConcatenateArrays</code> function returns a flat array with all the elements from the arrays concatenated.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2014 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Concatenate multiple arrays.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;T&quot;&gt;the array type&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;param name=&quot;arrays&quot;&gt;multiple arrays&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;a flat array with all arrays concatenated&lt;/returns&gt;</span>
<span class="kw1">public</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> wasConcatenateArrays<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw1">params</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="br0">&#93;</span> arrays<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw4">int</span> resultLength <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
    <span class="kw1">foreach</span> <span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> o <span class="kw1">in</span> arrays<span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        resultLength <span class="sy0">+=</span> o<span class="sy0">.</span><span class="me1">Length</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    T<span class="br0">&#91;</span><span class="br0">&#93;</span> result <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>resultLength<span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="kw4">int</span> offset <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
    <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> x <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> x <span class="sy0">&lt;</span> arrays<span class="sy0">.</span><span class="me1">Length</span><span class="sy0">;</span> x<span class="sy0">++</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        arrays<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">.</span><span class="me1">CopyTo</span><span class="br0">&#40;</span>result, offset<span class="br0">&#41;</span><span class="sy0">;</span>
        offset <span class="sy0">+=</span> arrays<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">.</span><span class="me1">Length</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw1">return</span> result<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit43" id="delete_sub-array">Delete Sub-Array</h1>
<div class="level1">

<p>
Given an array, the <code>wasDeleteSubArray</code> function deletes returns all the elements of the array that are not between the <code>start</code> and <code>stop</code> indices. Additionally, the <code>wasDeleteSubArray</code> function allows <code>-1</code> to be specified as the <code>stop</code> index meaning the end of the array.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2014 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Delete a sub-array and return the result.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;T&quot;&gt;the array type&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;param name=&quot;data&quot;&gt;the array&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;start&quot;&gt;the start index&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;stop&quot;&gt;the stop index (-1 denotes the end)&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the array without elements between start and stop&lt;/returns&gt;</span>
<span class="kw1">public</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> wasDeleteSubArray<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> data, <span class="kw4">int</span> start, <span class="kw4">int</span> stop<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>stop<span class="sy0">.</span><span class="me1">Equals</span><span class="br0">&#40;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
        stop <span class="sy0">=</span> data<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> <span class="nu0">1</span><span class="sy0">;</span>
    T<span class="br0">&#91;</span><span class="br0">&#93;</span> result <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>data<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> <span class="br0">&#40;</span>stop <span class="sy0">-</span> start<span class="br0">&#41;</span> <span class="sy0">-</span> <span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">;</span>
    Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>data, <span class="nu0">0</span>, result, <span class="nu0">0</span>, start<span class="br0">&#41;</span><span class="sy0">;</span>
    Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>data, stop <span class="sy0">+</span> <span class="nu0">1</span>, result, start, data<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> stop <span class="sy0">-</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> result<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit44" id="get_sub-array">Get Sub-Array</h1>
<div class="level1">

<p>
The <code>wasGetSubArray</code> function takes as input an array and returns all the elements between the <code>start</code> and <code>stop</code> indices (inclusive). Additionally, the function supports passing <code>-1</code> to the <code>stop</code> index meaning the end of the array.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2014 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Gets a sub-array from an array.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;T&quot;&gt;the array type&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;param name=&quot;data&quot;&gt;the array&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;start&quot;&gt;the start index&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;stop&quot;&gt;the stop index (-1 denotes the end)&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;the array slice between start and stop&lt;/returns&gt;</span>
<span class="kw1">public</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> wasGetSubArray<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> data, <span class="kw4">int</span> start, <span class="kw4">int</span> stop<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>stop<span class="sy0">.</span><span class="me1">Equals</span><span class="br0">&#40;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
        stop <span class="sy0">=</span> data<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> <span class="nu0">1</span><span class="sy0">;</span>
    T<span class="br0">&#91;</span><span class="br0">&#93;</span> result <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>stop <span class="sy0">-</span> start <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">;</span>
    Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>data, start, result, <span class="nu0">0</span>, stop <span class="sy0">-</span> start <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> result<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit45" id="cryptographic_functions">Cryptographic Functions</h1>
<div class="level1">

<p>
A list of cryptographic functions created by Wizardry and Steamworks:
</p>

<div><div id="nojs_indexmenu_3727575262b7b61bd7f18" data-jsajax="" class="indexmenu_nojs">

<ul class="idx">
<li class="level1" ><div class="li"><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp/cryptography/cyphers/atbash" class="wikilink1" title="fuss:csharp:cryptography:cyphers:atbash" data-wiki-id="fuss:csharp:cryptography:cyphers:atbash">atbash</a></div></li>
<li class="level1" ><div class="li"><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp/cryptography/cyphers/bifid" class="wikilink1" title="fuss:csharp:cryptography:cyphers:bifid" data-wiki-id="fuss:csharp:cryptography:cyphers:bifid">bifid</a></div></li>
<li class="level1" ><div class="li"><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp/cryptography/cyphers/enigma" class="wikilink1" title="fuss:csharp:cryptography:cyphers:enigma" data-wiki-id="fuss:csharp:cryptography:cyphers:enigma">enigma</a></div></li>
<li class="level1" ><div class="li"><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp/cryptography/cyphers/vernam" class="wikilink1" title="fuss:csharp:cryptography:cyphers:vernam" data-wiki-id="fuss:csharp:cryptography:cyphers:vernam">vernam</a></div></li>
<li class="level1" ><div class="li"><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp/cryptography/cyphers/vic" class="wikilink1" title="fuss:csharp:cryptography:cyphers:vic" data-wiki-id="fuss:csharp:cryptography:cyphers:vic">vic</a></div></li>
<li class="level1" ><div class="li"><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp/cryptography/cyphers/vigenere" class="wikilink1" title="fuss:csharp:cryptography:cyphers:vigenere" data-wiki-id="fuss:csharp:cryptography:cyphers:vigenere">vigenere</a></div></li>
</ul>
</div></div>
<script type='text/javascript' charset='utf-8'>
<!--//--><![CDATA[//><!--
var indexmenu_3727575262b7b61bd7f18 = new dTree('indexmenu_3727575262b7b61bd7f18','was.png');
indexmenu_3727575262b7b61bd7f18.config.urlbase='http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/';
indexmenu_3727575262b7b61bd7f18.config.sepchar='/';
indexmenu_3727575262b7b61bd7f18.config.toc=false;
indexmenu_3727575262b7b61bd7f18.config.scorespace=true;
indexmenu_3727575262b7b61bd7f18.add('fuss/csharp/cryptography/cyphers',0,-1,"cyphers");
indexmenu_3727575262b7b61bd7f18.add('fuss/csharp/cryptography/cyphers/atbash',1,0,"atbash",0,0,0);
indexmenu_3727575262b7b61bd7f18.add('fuss/csharp/cryptography/cyphers/bifid',2,0,"bifid",0,0,0);
indexmenu_3727575262b7b61bd7f18.add('fuss/csharp/cryptography/cyphers/enigma',3,0,"enigma",0,0,0);
indexmenu_3727575262b7b61bd7f18.add('fuss/csharp/cryptography/cyphers/vernam',4,0,"vernam",0,0,0);
indexmenu_3727575262b7b61bd7f18.add('fuss/csharp/cryptography/cyphers/vic',5,0,"vic",0,0,0);
indexmenu_3727575262b7b61bd7f18.add('fuss/csharp/cryptography/cyphers/vigenere',6,0,"vigenere",0,0,0);
document.write(indexmenu_3727575262b7b61bd7f18);
jQuery(function(){indexmenu_3727575262b7b61bd7f18.init(1,0,"",1,0);});
//--><!]]>
</script>

<p>
that will help you encrypt and decrypt messages.
</p>

</div>

<h1 class="sectionedit46" id="sequence_contains_all_elements_of_sequence">Sequence Contains All Elements of Sequence</h1>
<div class="level1">

<p>
Suppose we have two sets:
</p>
<pre class="code csharp"><span class="kw1">var</span> subset <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="nu0">2</span> <span class="nu0">3</span> <span class="nu0">1</span> <span class="br0">&#125;</span><span class="sy0">;</span>
<span class="kw1">var</span> <span class="kw1">set</span> <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="nu0">2</span> <span class="nu0">3</span> <span class="nu0">8</span> <span class="nu0">4</span> <span class="nu0">2</span> <span class="br0">&#125;</span><span class="sy0">;</span></pre>

<p>
and we want to determine if <code>set</code> contains all the elements of <code>subset</code>.
</p>

<p>
In that case we can do:
</p>
<pre class="code csharp"><span class="kw4">bool</span> contained <span class="sy0">=</span> <span class="sy0">!</span>subset<span class="sy0">.</span><span class="me1">Except</span><span class="br0">&#40;</span><span class="kw1">set</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Any</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
after which <code>contained</code> will be true if <code>subset</code> is contained in set.
</p>

</div>

<h1 class="sectionedit47" id="unix_alarm">Unix Alarm</h1>
<div class="level1">

<p>
The <code>alarm</code> function in Unix program is usually used to raise an event after a certain time and, additionally, by calling the <code>alarm</code> function again, to reschedule the delivery of that event. In C#, .NET does not have a built-in <code>alarm</code>-like class so the following is a quick implementation using <code>System.Timers.Timer</code>:
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2013 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;An alarm class similar to the UNIX alarm&lt;/summary&gt;</span>
<span class="kw1">public</span> <span class="kw4">class</span> wasAlarm
<span class="br0">&#123;</span>
    <span class="kw1">private</span> Timer alarm<span class="sy0">;</span>
&nbsp;
    <span class="kw1">public</span> wasAlarm<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        Signal <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> ManualResetEvent<span class="br0">&#40;</span><span class="kw1">false</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">public</span> ManualResetEvent Signal <span class="br0">&#123;</span> <span class="kw1">get</span><span class="sy0">;</span> <span class="kw1">set</span><span class="sy0">;</span> <span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">public</span> <span class="kw4">void</span> Alarm<span class="br0">&#40;</span><span class="kw4">int</span> deadline<span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>alarm <span class="sy0">==</span> <span class="kw1">null</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            alarm <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Timer<span class="br0">&#40;</span>deadline<span class="br0">&#41;</span><span class="sy0">;</span>
            alarm<span class="sy0">.</span><span class="me1">Elapsed</span> <span class="sy0">+=</span> <span class="br0">&#40;</span>o, p<span class="br0">&#41;</span> <span class="sy0">=&gt;</span>
            <span class="br0">&#123;</span>
                Signal<span class="sy0">.</span><span class="kw1">Set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
                alarm<span class="sy0">.</span><span class="me1">Dispose</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span><span class="sy0">;</span>
            alarm<span class="sy0">.</span><span class="me1">Start</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">return</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
        alarm<span class="sy0">.</span><span class="me1">Interval</span> <span class="sy0">=</span> deadline<span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

<p>
Suppose that you have an event, that you do not know how many times it will be called before not being called again, in that case you would first create the alarm:
</p>
<pre class="code csharp">wasAlarm trigger <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> wasAlarm<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
then, in the event handler, you would reschedule the alarm, with:
</p>
<pre class="code csharp">trigger<span class="sy0">.</span><span class="me1">Alarm</span><span class="br0">&#40;</span><span class="nu0">1000</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
Finally, you would wait on the alarm to trigger using, for example, <code>WaitOne</code>:
</p>
<pre class="code csharp">trigger<span class="sy0">.</span><span class="me1">Signal</span><span class="sy0">.</span><span class="me1">WaitOne</span><span class="br0">&#40;</span>timeout, <span class="kw1">false</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<p>
This class is used throughout <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/secondlife/scripted_agents/corrade" class="wikilink1" title="secondlife:scripted_agents:corrade" data-wiki-id="secondlife:scripted_agents:corrade">Corrade</a>.
</p>

</div>

<h1 class="sectionedit48" id="adaptive_alarm">Adaptive Alarm</h1>
<div class="level1">

<p>
<code>alarm()</code> is usually used under UNIX-like systems to deliver a signal once a certain time has elapsed. It is useful for asynchronous code where some tasks can be performed before the alarm is finally triggered. Commonly, the alarm is set at some point and then updated later in order to reschedule the event at an earlier time. 
</p>

<p>
One of the short-comings of the UNIX alarm is that it does not explicitly consider past elapsed times. For example, suppose that you set and reset an alarm as some events happen. You would only reschedule the alarm with a fixed time, every time, regardless whether the previous event has been delivered much earlier than your alarm schedule.
</p>

<p>
<code>wasAdaptiveAlarm</code> uses Pythagorean means (although this can be extended) to consider the reschedule interval as well as all the past elapsed times. It performs the mean between the current scheduling request and all the previous recorded elapsed times.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//  Copyright (C) Wizardry and Steamworks 2013 - License: GNU GPLv3      //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     An alarm class similar to the UNIX alarm with the added benefit</span>
<span class="co1">///     of a decaying timer that tracks the time between rescheduling.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;remarks&gt;</span>
<span class="co1">///     (C) Wizardry and Steamworks 2013 - License: GNU GPLv3</span>
<span class="co1">/// &lt;/remarks&gt;</span>
<span class="kw1">public</span> <span class="kw4">class</span> wasAdaptiveAlarm
<span class="br0">&#123;</span>
    <span class="br0">&#91;</span>Flags<span class="br0">&#93;</span>
    <span class="kw1">public</span> <span class="kw4">enum</span> DECAY_TYPE
    <span class="br0">&#123;</span>
        NONE <span class="sy0">=</span> <span class="nu0">0</span>,
        ARITHMETIC <span class="sy0">=</span> <span class="nu0">1</span>,
        GEOMETRIC <span class="sy0">=</span> <span class="nu0">2</span>,
        HARMONIC <span class="sy0">=</span> <span class="nu0">4</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">private</span> <span class="kw1">readonly</span> DECAY_TYPE decay <span class="sy0">=</span> DECAY_TYPE<span class="sy0">.</span><span class="me1">NONE</span><span class="sy0">;</span>
    <span class="kw1">private</span> <span class="kw1">readonly</span> Stopwatch elapsed <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Stopwatch<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">private</span> <span class="kw1">readonly</span> HashSet<span class="sy0">&lt;</span><span class="kw4">double</span><span class="sy0">&gt;</span> times <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> HashSet<span class="sy0">&lt;</span><span class="kw4">double</span><span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">private</span> <span class="kw5">System.<span class="me1">Timers</span></span><span class="sy0">.</span><span class="me1">Timer</span> alarm<span class="sy0">;</span>
&nbsp;
    <span class="co1">/// &lt;summary&gt;</span>
    <span class="co1">///     The default constructor using no decay.</span>
    <span class="co1">/// &lt;/summary&gt;</span>
    <span class="kw1">public</span> wasAdaptiveAlarm<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        Signal <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> ManualResetEvent<span class="br0">&#40;</span><span class="kw1">false</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">/// &lt;summary&gt;</span>
    <span class="co1">///     The constructor for the wasAdaptiveAlarm class taking as parameter a decay type.</span>
    <span class="co1">/// &lt;/summary&gt;</span>
    <span class="co1">/// &lt;param name=&quot;decay&quot;&gt;the type of decay: arithmetic, geometric, harmonic, heronian or quadratic&lt;/param&gt;</span>
    <span class="kw1">public</span> wasAdaptiveAlarm<span class="br0">&#40;</span>DECAY_TYPE decay<span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        Signal <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> ManualResetEvent<span class="br0">&#40;</span><span class="kw1">false</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">this</span><span class="sy0">.</span><span class="me1">decay</span> <span class="sy0">=</span> decay<span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">public</span> ManualResetEvent Signal <span class="br0">&#123;</span> <span class="kw1">get</span><span class="sy0">;</span> <span class="kw1">set</span><span class="sy0">;</span> <span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">public</span> <span class="kw4">void</span> Alarm<span class="br0">&#40;</span><span class="kw4">double</span> deadline<span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>alarm <span class="sy0">==</span> <span class="kw1">null</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            alarm <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="kw5">System.<span class="me1">Timers</span></span><span class="sy0">.</span><span class="me1">Timer</span><span class="br0">&#40;</span>deadline<span class="br0">&#41;</span><span class="sy0">;</span>
            alarm<span class="sy0">.</span><span class="me1">Elapsed</span> <span class="sy0">+=</span> <span class="br0">&#40;</span>o, p<span class="br0">&#41;</span> <span class="sy0">=&gt;</span>
            <span class="br0">&#123;</span>
                Signal<span class="sy0">.</span><span class="kw1">Set</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
                times<span class="sy0">.</span><span class="me1">Clear</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
                alarm<span class="sy0">.</span><span class="me1">Dispose</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span><span class="sy0">;</span>
            elapsed<span class="sy0">.</span><span class="me1">Start</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            alarm<span class="sy0">.</span><span class="me1">Start</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">return</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
        elapsed<span class="sy0">.</span><span class="me1">Stop</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        times<span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span>elapsed<span class="sy0">.</span><span class="me1">ElapsedMilliseconds</span><span class="br0">&#41;</span><span class="sy0">;</span>
        elapsed<span class="sy0">.</span><span class="me1">Reset</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        elapsed<span class="sy0">.</span><span class="me1">Start</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">switch</span> <span class="br0">&#40;</span>decay<span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            <span class="kw1">case</span> DECAY_TYPE<span class="sy0">.</span><span class="me1">ARITHMETIC</span><span class="sy0">:</span>
                alarm<span class="sy0">.</span><span class="me1">Interval</span> <span class="sy0">=</span> <span class="br0">&#40;</span>deadline <span class="sy0">+</span> times<span class="sy0">.</span><span class="me1">Aggregate</span><span class="br0">&#40;</span><span class="br0">&#40;</span>a, b<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> b <span class="sy0">+</span> a<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">/</span> <span class="br0">&#40;</span>1f <span class="sy0">+</span> times<span class="sy0">.</span><span class="me1">Count</span><span class="br0">&#41;</span><span class="sy0">;</span>
                <span class="kw1">break</span><span class="sy0">;</span>
            <span class="kw1">case</span> DECAY_TYPE<span class="sy0">.</span><span class="me1">GEOMETRIC</span><span class="sy0">:</span>
                alarm<span class="sy0">.</span><span class="me1">Interval</span> <span class="sy0">=</span> Math<span class="sy0">.</span><span class="me1">Pow</span><span class="br0">&#40;</span>deadline <span class="sy0">*</span> times<span class="sy0">.</span><span class="me1">Aggregate</span><span class="br0">&#40;</span><span class="br0">&#40;</span>a, b<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> b <span class="sy0">*</span> a<span class="br0">&#41;</span>, 1f <span class="sy0">/</span> <span class="br0">&#40;</span>1f <span class="sy0">+</span> times<span class="sy0">.</span><span class="me1">Count</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
                <span class="kw1">break</span><span class="sy0">;</span>
            <span class="kw1">case</span> DECAY_TYPE<span class="sy0">.</span><span class="me1">HARMONIC</span><span class="sy0">:</span>
                alarm<span class="sy0">.</span><span class="me1">Interval</span> <span class="sy0">=</span> <span class="br0">&#40;</span>1f <span class="sy0">+</span> times<span class="sy0">.</span><span class="me1">Count</span><span class="br0">&#41;</span> <span class="sy0">/</span> <span class="br0">&#40;</span>1f <span class="sy0">/</span> deadline <span class="sy0">+</span> times<span class="sy0">.</span><span class="me1">Aggregate</span><span class="br0">&#40;</span><span class="br0">&#40;</span>a, b<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> 1f <span class="sy0">/</span> b <span class="sy0">+</span> 1f <span class="sy0">/</span> a<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
                <span class="kw1">break</span><span class="sy0">;</span>
            <span class="kw1">default</span><span class="sy0">:</span>
                alarm<span class="sy0">.</span><span class="me1">Interval</span> <span class="sy0">=</span> deadline<span class="sy0">;</span>
                <span class="kw1">break</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

<p>
As a practical example, <code>wasAdaptiveAlarm</code> has been incorporated and used throughout <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/secondlife/scripted_agents/corrade" class="wikilink1" title="secondlife:scripted_agents:corrade" data-wiki-id="secondlife:scripted_agents:corrade">Corrade</a> in order to receive an unknown number events as fast as possible without raising the signal too soon and thereby losing events.
</p>

</div>

<h1 class="sectionedit49" id="combine_multiple_paths">Combine Multiple Paths</h1>
<div class="level1">

<p>
In .NET, <code>Path.Combine</code> takes two parameters such that you cannot provide several path elements in order to construct a path. Instead the <code>wasPathCombine</code> takes a variable number of parameters and combines them as a path:
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2015 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Combine multiple paths.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;paths&quot;&gt;an array of paths&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;a combined path&lt;/returns&gt;</span>
<span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">string</span> wasPathCombine<span class="br0">&#40;</span><span class="kw1">params</span> <span class="kw4">string</span><span class="br0">&#91;</span><span class="br0">&#93;</span> paths<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>paths<span class="sy0">.</span><span class="me1">Length</span><span class="sy0">.</span><span class="me1">Equals</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">return</span> <span class="kw4">string</span><span class="sy0">.</span><span class="me1">Empty</span><span class="sy0">;</span>
    <span class="kw1">return</span> paths<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">&lt;</span> <span class="nu0">2</span>
        <span class="sy0">?</span> paths<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy0">:</span> Path<span class="sy0">.</span><span class="me1">Combine</span><span class="br0">&#40;</span>Path<span class="sy0">.</span><span class="me1">Combine</span><span class="br0">&#40;</span>paths<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>, paths<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>, wasPathCombine<span class="br0">&#40;</span>paths<span class="sy0">.</span><span class="me1">Skip</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">ToArray</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit50" id="convert_a_decimal_number_to_a_given_base">Convert a Decimal Number to a Given Base</h1>
<div class="level1">

<p>
Inspired from <a href="http://www.pvladov.com/2012/05/decimal-to-arbitrary-numeral-system.html" class="urlextern" title="http://www.pvladov.com/2012/05/decimal-to-arbitrary-numeral-system.html" rel="ugc nofollow">Pavel Vladov&#039;s converter</a>, <code>wasIntegerToBase</code> is able to convert a decimal number to any base (up to base 68) by making use of all the printable characters in the ASCII character set.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2015 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Converts the given decimal value to the numeral system with the</span>
<span class="co1">///     specified base radix in the range [2, 68].</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;param name=&quot;value&quot;&gt;The value to convert.&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;radix&quot;&gt;The radix of the destination numeral system (in the range [2, 68]).&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;a string containing the value in base radix&lt;/returns&gt;</span>
<span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">string</span> wasIntegerToBase<span class="br0">&#40;</span><span class="kw4">long</span> <span class="kw1">value</span>, <span class="kw4">int</span> radix<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">const</span> <span class="kw4">string</span> alphabet <span class="sy0">=</span> @ <span class="st0">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ !#$%&amp;'()*+,-./:;&lt;=&gt;?@[<span class="es0">\]</span>^_`(|)~&quot;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">if</span> <span class="br0">&#40;</span>radix <span class="sy0">&lt;</span> <span class="nu0">2</span> <span class="sy0">||</span> radix <span class="sy0">&gt;</span> alphabet<span class="sy0">.</span><span class="me1">Length</span><span class="br0">&#41;</span>
        <span class="kw1">throw</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> ArgumentException<span class="br0">&#40;</span><span class="st0">&quot;The radix must be &gt;= 2 and &lt;= &quot;</span> <span class="sy0">+</span> alphabet<span class="sy0">.</span><span class="me1">Length</span><span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span>CultureInfo<span class="sy0">.</span><span class="me1">InvariantCulture</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">&quot;.&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw1">value</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">return</span> <span class="st0">&quot;0&quot;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw4">char</span><span class="br0">&#91;</span><span class="br0">&#93;</span> final <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> <span class="kw4">char</span><span class="br0">&#91;</span><span class="nu0">64</span><span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw4">long</span> n <span class="sy0">=</span> Math<span class="sy0">.</span><span class="me1">Abs</span><span class="br0">&#40;</span><span class="kw1">value</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw4">int</span> i <span class="sy0">=</span> <span class="nu0">64</span><span class="sy0">;</span>
    <span class="kw1">do</span> <span class="br0">&#123;</span>
        <span class="kw4">int</span> remainder <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">int</span><span class="br0">&#41;</span><span class="br0">&#40;</span>n <span class="sy0">%</span> radix<span class="br0">&#41;</span><span class="sy0">;</span>
        final<span class="br0">&#91;</span><span class="sy0">--</span>i<span class="br0">&#93;</span> <span class="sy0">=</span> alphabet<span class="br0">&#91;</span>remainder<span class="br0">&#93;</span><span class="sy0">;</span>
        n <span class="sy0">=</span> n <span class="sy0">/</span> radix<span class="sy0">;</span>
    <span class="br0">&#125;</span> <span class="kw1">while</span> <span class="br0">&#40;</span>n <span class="sy0">!=</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    StringBuilder sb <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> StringBuilder<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw1">value</span> <span class="sy0">&lt;</span> <span class="nu0">0</span><span class="br0">&#41;</span> sb<span class="sy0">.</span><span class="me1">Append</span><span class="br0">&#40;</span><span class="st0">&quot;-&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    sb<span class="sy0">.</span><span class="me1">Append</span><span class="br0">&#40;</span>final, i, <span class="nu0">64</span> <span class="sy0">-</span> i<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">return</span> sb<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit51" id="iterative_fibonacci_implementation">Iterative Fibonacci Implementation</h1>
<div class="level1">
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2016 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="kw1">using</span> <span class="co3">System</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">namespace</span> Fibonacci <span class="br0">&#123;</span>
    <span class="kw1">public</span> <span class="kw4">class</span> Fibonacci <span class="br0">&#123;</span>
        <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> Main<span class="br0">&#40;</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="br0">&#93;</span> args<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw4">int</span> f0 <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
            <span class="kw4">int</span> f1 <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>
&nbsp;
            <span class="kw4">int</span> i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
            <span class="kw1">while</span><span class="br0">&#40;</span>i <span class="sy0">&lt;</span> <span class="nu0">10</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw4">int</span> s <span class="sy0">=</span> f0<span class="sy0">;</span>
                f0 <span class="sy0">=</span> f1<span class="sy0">;</span>
                f1 <span class="sy0">=</span> s <span class="sy0">+</span> f1<span class="sy0">;</span>
&nbsp;
                Console<span class="sy0">.</span><span class="me1">WriteLine</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
                i <span class="sy0">=</span> i <span class="sy0">+</span> <span class="nu0">1</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit52" id="binary_search">Binary Search</h1>
<div class="level1">
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2016 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">int</span> BinarySearch<span class="br0">&#40;</span><span class="kw4">int</span><span class="br0">&#91;</span><span class="br0">&#93;</span> a, <span class="kw4">int</span> i, <span class="kw4">int</span> min, <span class="kw4">int</span> max<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span><span class="br0">&#40;</span>max <span class="sy0">&lt;</span> min<span class="br0">&#41;</span> <span class="kw1">return</span> <span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span>
    <span class="kw4">int</span> mid <span class="sy0">=</span> <span class="br0">&#40;</span>min<span class="sy0">+</span>max<span class="br0">&#41;</span><span class="sy0">/</span><span class="nu0">2</span><span class="sy0">;</span>
    <span class="kw1">if</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>mid<span class="br0">&#93;</span> <span class="sy0">&gt;</span> i<span class="br0">&#41;</span>
        <span class="kw1">return</span> BinarySearch<span class="br0">&#40;</span>a, i, min, mid <span class="sy0">-</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>mid<span class="br0">&#93;</span> <span class="sy0">&lt;</span> i<span class="br0">&#41;</span>
        <span class="kw1">return</span> BinarySearch<span class="br0">&#40;</span>a, i, mid <span class="sy0">+</span> <span class="nu0">1</span>, max<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> i<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit53" id="quicksort">Quicksort</h1>
<div class="level1">
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2016 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="kw1">public</span> <span class="kw1">static</span> List<span class="sy0">&lt;</span><span class="kw4">int</span><span class="sy0">&gt;</span> Quicksort<span class="br0">&#40;</span>List<span class="sy0">&lt;</span><span class="kw4">int</span><span class="sy0">&gt;</span> l<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>l<span class="sy0">.</span><span class="me1">Count</span> <span class="sy0">&lt;=</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> l<span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw4">int</span> pivot <span class="sy0">=</span> l<span class="br0">&#91;</span>l<span class="sy0">.</span><span class="me1">Count</span> <span class="sy0">/</span> <span class="nu0">2</span><span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
    List<span class="sy0">&lt;</span><span class="kw4">int</span><span class="sy0">&gt;</span> less <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> List<span class="sy0">&lt;</span><span class="kw4">int</span><span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    List<span class="sy0">&lt;</span><span class="kw4">int</span><span class="sy0">&gt;</span> more <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> List<span class="sy0">&lt;</span><span class="kw4">int</span><span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="kw4">int</span> i <span class="kw1">in</span> l<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>i <span class="sy0">&lt;</span> pivot<span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            less<span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span>i<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>i <span class="sy0">&gt;</span> pivot<span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            more<span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span>i<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
&nbsp;
    List<span class="sy0">&lt;</span><span class="kw4">int</span><span class="sy0">&gt;</span> result <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> List<span class="sy0">&lt;</span><span class="kw4">int</span><span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    result<span class="sy0">.</span><span class="me1">AddRange</span><span class="br0">&#40;</span>Quicksort<span class="br0">&#40;</span>less<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    result<span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span>pivot<span class="br0">&#41;</span><span class="sy0">;</span>
    result<span class="sy0">.</span><span class="me1">AddRange</span><span class="br0">&#40;</span>Quicksort<span class="br0">&#40;</span>more<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">return</span> result<span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit54" id="get_field_or_property_from_nested_class_by_fully_qualified_name">Get Field or Property from Nested Class by Fully Qualified Name</h1>
<div class="level1">

<p>
The <code>GetFP</code> extension will return either a value of a field in a class, the value of a property or null in case no field or properties matched.
</p>
<pre class="code csharp"><span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">//    Copyright (C) 2016 Wizardry and Steamworks - License: GNU GPLv3    //</span>
<span class="co1">///////////////////////////////////////////////////////////////////////////</span>
<span class="co1">/// &lt;summary&gt;</span>
<span class="co1">///     Get field or property from a class by supplying a path.</span>
<span class="co1">/// &lt;/summary&gt;</span>
<span class="co1">/// &lt;typeparam name=&quot;T&quot;&gt;the type of the object&lt;/typeparam&gt;</span>
<span class="co1">/// &lt;param name=&quot;o&quot;&gt;the object&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;path&quot;&gt;the fully qualified path to the field of property&lt;/param&gt;</span>
<span class="co1">/// &lt;param name=&quot;flags&quot;&gt;the binding flags to use&lt;/param&gt;</span>
<span class="co1">/// &lt;returns&gt;</span>
<span class="co1">///     the last object in the fully qualified path or null in case the field or property could not be found</span>
<span class="co1">/// &lt;/returns&gt;</span>
<span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">object</span> GetFP<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw1">this</span> T o, <span class="kw4">string</span> path,
    BindingFlags flags <span class="sy0">=</span> BindingFlags<span class="sy0">.</span><span class="me1">Instance</span> <span class="sy0">|</span> BindingFlags<span class="sy0">.</span><span class="kw1">Public</span><span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> <span class="kw4">class</span>
<span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw4">string</span><span class="sy0">.</span><span class="me1">IsNullOrEmpty</span><span class="br0">&#40;</span>path<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">return</span> <span class="kw1">null</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>o <span class="sy0">==</span> <span class="kw1">null</span><span class="br0">&#41;</span> <span class="kw1">return</span> <span class="kw1">null</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">var</span> components <span class="sy0">=</span> path<span class="sy0">.</span><span class="me1">Split</span><span class="br0">&#40;</span><span class="st0">'.'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">var</span> memberTypes <span class="sy0">=</span> o<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetMember</span><span class="br0">&#40;</span>components<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>, flags<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">if</span> <span class="br0">&#40;</span>memberTypes<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">!=</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">return</span> <span class="kw1">null</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">switch</span> <span class="br0">&#40;</span>memberTypes<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="me1">MemberType</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">case</span> MemberTypes<span class="sy0">.</span><span class="me1">Field</span><span class="sy0">:</span>
            <span class="kw1">return</span> components<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">&gt;</span> <span class="nu0">1</span>
                <span class="sy0">?</span> GetFP<span class="br0">&#40;</span>o<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetField</span><span class="br0">&#40;</span>components<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetValue</span><span class="br0">&#40;</span>o<span class="br0">&#41;</span>,
                    components<span class="sy0">.</span><span class="me1">Skip</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Aggregate</span><span class="br0">&#40;</span><span class="br0">&#40;</span>a, i<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> a <span class="sy0">+</span> <span class="st_h">@&quot;.&quot;</span> <span class="sy0">+</span> i<span class="br0">&#41;</span>, flags<span class="br0">&#41;</span>
                <span class="sy0">:</span> o<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetField</span><span class="br0">&#40;</span>path<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetValue</span><span class="br0">&#40;</span>o<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">case</span> MemberTypes<span class="sy0">.</span><span class="me1">Property</span><span class="sy0">:</span>
            <span class="kw1">return</span> components<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">&gt;</span> <span class="nu0">1</span>
                <span class="sy0">?</span> GetFP<span class="br0">&#40;</span>o<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetProperty</span><span class="br0">&#40;</span>components<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>, flags<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetValue</span><span class="br0">&#40;</span>o<span class="br0">&#41;</span>,
                    components<span class="sy0">.</span><span class="me1">Skip</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Aggregate</span><span class="br0">&#40;</span><span class="br0">&#40;</span>a, i<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> a <span class="sy0">+</span> <span class="st_h">@&quot;.&quot;</span> <span class="sy0">+</span> i<span class="br0">&#41;</span>, flags<span class="br0">&#41;</span>
                <span class="sy0">:</span> o<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetProperty</span><span class="br0">&#40;</span>path<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">GetValue</span><span class="br0">&#40;</span>o<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">return</span> <span class="kw1">null</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>
The search is performed by fully qualified name. For instance:
</p>
<pre class="code csharp"><span class="kw1">var</span> o <span class="sy0">=</span> <span class="kw4">object</span><span class="sy0">.</span><span class="me1">GetFP</span><span class="br0">&#40;</span><span class="st0">&quot;Class.Member.Class.Field&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h1 class="sectionedit55" id="merge_sort">Merge Sort</h1>
<div class="level1">

</div>

<h2 class="sectionedit56" id="recursive">Recursive</h2>
<div class="level2">

<p>
Recursively and using generics.
</p>
<pre class="code csharp"><span class="kw1">using</span> <span class="co3">System</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">namespace</span> Sorts<span class="sy0">.</span><span class="me1">MergeSort</span><span class="sy0">.</span><span class="me1">Recursive</span>
<span class="br0">&#123;</span>
    <span class="kw1">public</span> <span class="kw4">class</span> MergeSort
    <span class="br0">&#123;</span>
        <span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">int</span><span class="br0">&#91;</span><span class="br0">&#93;</span> List <span class="br0">&#123;</span> <span class="kw1">get</span><span class="sy0">;</span> <span class="kw1">set</span><span class="sy0">;</span> <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">public</span> MergeSort<span class="br0">&#40;</span><span class="kw4">int</span><span class="br0">&#91;</span><span class="br0">&#93;</span> list<span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            List <span class="sy0">=</span> list<span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">public</span> <span class="kw4">int</span><span class="br0">&#91;</span><span class="br0">&#93;</span> Sort<span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            <span class="kw1">return</span> Partition<span class="br0">&#40;</span>List<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">private</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> Partition<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> list<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> IComparable
        <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>list<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">&lt;=</span> <span class="nu0">1</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="kw1">return</span> list<span class="sy0">;</span>
            <span class="br0">&#125;</span>
&nbsp;
            <span class="kw1">var</span> pivot <span class="sy0">=</span> list<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">/</span> <span class="nu0">2</span><span class="sy0">;</span>
&nbsp;
            T<span class="br0">&#91;</span><span class="br0">&#93;</span> l <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>pivot<span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
            Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>list, <span class="nu0">0</span>, l, <span class="nu0">0</span>, pivot<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
            T<span class="br0">&#91;</span><span class="br0">&#93;</span> r <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>list<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> pivot<span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
            Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>list, pivot, r, <span class="nu0">0</span>, list<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> pivot<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
            <span class="kw1">return</span> Merge<span class="br0">&#40;</span>Partition<span class="br0">&#40;</span>l<span class="br0">&#41;</span>, Partition<span class="br0">&#40;</span>r<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">private</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> Concatenate<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> a, T<span class="br0">&#91;</span><span class="br0">&#93;</span> b<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> IComparable
        <span class="br0">&#123;</span>
            T<span class="br0">&#91;</span><span class="br0">&#93;</span> rest <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>a<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">+</span> b<span class="sy0">.</span><span class="me1">Length</span><span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
            Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>a, <span class="nu0">0</span>, rest, <span class="nu0">0</span>, a<span class="sy0">.</span><span class="me1">Length</span><span class="br0">&#41;</span><span class="sy0">;</span>
            Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>b, <span class="nu0">0</span>, rest, a<span class="sy0">.</span><span class="me1">Length</span>, b<span class="sy0">.</span><span class="me1">Length</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
            <span class="kw1">return</span> rest<span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">private</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> Concatenate<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T a, T<span class="br0">&#91;</span><span class="br0">&#93;</span> l<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> IComparable
        <span class="br0">&#123;</span>
            T<span class="br0">&#91;</span><span class="br0">&#93;</span> result <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>l<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">;</span>
            result<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="sy0">=</span> a<span class="sy0">;</span>
&nbsp;
            Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>l, <span class="nu0">0</span>, result, <span class="nu0">1</span>, l<span class="sy0">.</span><span class="me1">Length</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
            <span class="kw1">return</span> result<span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">private</span> <span class="kw1">static</span> T Car<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> l<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> IComparable
        <span class="br0">&#123;</span>
            <span class="kw1">return</span> l<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">private</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> Cdr<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> l<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> IComparable
        <span class="br0">&#123;</span>
            T<span class="br0">&#91;</span><span class="br0">&#93;</span> cdr <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>l<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> <span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
            Array<span class="sy0">.</span><span class="me1">Copy</span><span class="br0">&#40;</span>l, <span class="nu0">1</span>, cdr, <span class="nu0">0</span>, l<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">-</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
            <span class="kw1">return</span> cdr<span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">private</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> Merge<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> l, T<span class="br0">&#91;</span><span class="br0">&#93;</span> r<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> IComparable
        <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>l<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">==</span> <span class="nu0">0</span> <span class="sy0">||</span> r<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="kw1">return</span> Concatenate<span class="br0">&#40;</span>l, r<span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
&nbsp;
            <span class="kw1">if</span> <span class="br0">&#40;</span>l<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="me1">CompareTo</span><span class="br0">&#40;</span>r<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="kw1">return</span> Concatenate<span class="br0">&#40;</span>Car<span class="br0">&#40;</span>r<span class="br0">&#41;</span>, Merge<span class="br0">&#40;</span>l, Cdr<span class="br0">&#40;</span>r<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
&nbsp;
            <span class="kw1">return</span> Concatenate<span class="br0">&#40;</span>Car<span class="br0">&#40;</span>l<span class="br0">&#41;</span>, Merge<span class="br0">&#40;</span>Cdr<span class="br0">&#40;</span>l<span class="br0">&#41;</span>, r<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

<p>
May have stack issues so should be called by increasing the stack size:
</p>
<pre class="code csharp">            <span class="kw1">var</span> t <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> Thread<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">=&gt;</span>
                <span class="br0">&#123;</span>
                    list <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> MergeSort<span class="sy0">.</span><span class="me1">Recursive</span><span class="sy0">.</span><span class="me1">MergeSort</span><span class="br0">&#40;</span>list<span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Sort</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
                <span class="br0">&#125;</span>, <span class="nu0">1024</span> <span class="sy0">*</span> <span class="nu0">1024</span> <span class="sy0">*</span> <span class="nu0">50</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
            t<span class="sy0">.</span><span class="me1">Start</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

</div>

<h2 class="sectionedit57" id="iterative">Iterative</h2>
<div class="level2">
<pre class="code csharp"><span class="kw1">using</span> <span class="co3">System</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">namespace</span> Sorts<span class="sy0">.</span><span class="me1">MergeSort</span><span class="sy0">.</span><span class="me1">Iterative</span>
<span class="br0">&#123;</span>
    <span class="kw1">public</span> <span class="kw4">class</span> MergeSort
    <span class="br0">&#123;</span>
        <span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">int</span><span class="br0">&#91;</span><span class="br0">&#93;</span> List <span class="br0">&#123;</span> <span class="kw1">get</span><span class="sy0">;</span> <span class="kw1">set</span><span class="sy0">;</span> <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">public</span> MergeSort<span class="br0">&#40;</span><span class="kw4">int</span><span class="br0">&#91;</span><span class="br0">&#93;</span> list<span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            List <span class="sy0">=</span> list<span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">public</span> <span class="kw4">int</span><span class="br0">&#91;</span><span class="br0">&#93;</span> Sort<span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            <span class="kw1">return</span> Sort<span class="br0">&#40;</span>List<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">private</span> <span class="kw1">static</span> T Min<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T x, T y<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> IComparable
        <span class="br0">&#123;</span>
            <span class="kw1">return</span> x<span class="sy0">.</span><span class="me1">CompareTo</span><span class="br0">&#40;</span>y<span class="br0">&#41;</span> <span class="sy0">&lt;</span> <span class="nu0">0</span> <span class="sy0">?</span> x <span class="sy0">:</span> y<span class="sy0">;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">private</span> <span class="kw1">static</span> T<span class="br0">&#91;</span><span class="br0">&#93;</span> Sort<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span>T<span class="br0">&#91;</span><span class="br0">&#93;</span> a<span class="br0">&#41;</span> <span class="kw1">where</span> T <span class="sy0">:</span> IComparable
        <span class="br0">&#123;</span>
            T<span class="br0">&#91;</span><span class="br0">&#93;</span> b <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> T<span class="br0">&#91;</span>a<span class="sy0">.</span><span class="me1">Length</span><span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
            <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> size <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span> size <span class="sy0">&lt;</span> a<span class="sy0">.</span><span class="me1">Length</span><span class="sy0">;</span> size <span class="sy0">*=</span> <span class="nu0">2</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw4">int</span> left <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> left <span class="sy0">+</span> size <span class="sy0">&lt;</span> a<span class="sy0">.</span><span class="me1">Length</span><span class="sy0">;</span> left <span class="sy0">+=</span> size <span class="sy0">*</span> <span class="nu0">2</span><span class="br0">&#41;</span>
                <span class="br0">&#123;</span>
                    <span class="kw4">int</span> l <span class="sy0">=</span> left <span class="sy0">+</span> size<span class="sy0">;</span>
                    <span class="kw4">int</span> r <span class="sy0">=</span> Min<span class="br0">&#40;</span>l <span class="sy0">+</span> size, a<span class="sy0">.</span><span class="me1">Length</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
                    <span class="kw1">var</span> k <span class="sy0">=</span> left<span class="sy0">;</span>
                    <span class="kw1">var</span> i <span class="sy0">=</span> left<span class="sy0">;</span>
                    <span class="kw1">var</span> j <span class="sy0">=</span> l<span class="sy0">;</span>
                    <span class="kw1">while</span> <span class="br0">&#40;</span>i <span class="sy0">&lt;</span> l <span class="sy0">&amp;&amp;</span> j <span class="sy0">&lt;</span> r<span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        <span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">.</span><span class="me1">CompareTo</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">&lt;</span> <span class="nu0">0</span><span class="br0">&#41;</span>
                        <span class="br0">&#123;</span>
                            b<span class="br0">&#91;</span>k<span class="br0">&#93;</span> <span class="sy0">=</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">;</span>
                            <span class="sy0">++</span>i<span class="sy0">;</span>
                        <span class="br0">&#125;</span>
                        <span class="kw1">else</span>
                        <span class="br0">&#123;</span>
                            b<span class="br0">&#91;</span>k<span class="br0">&#93;</span> <span class="sy0">=</span> a<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">;</span>
                            <span class="sy0">++</span>j<span class="sy0">;</span>
                        <span class="br0">&#125;</span>
&nbsp;
                        <span class="sy0">++</span>k<span class="sy0">;</span>
                    <span class="br0">&#125;</span>
                    <span class="kw1">while</span> <span class="br0">&#40;</span>i <span class="sy0">&lt;</span> l<span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        b<span class="br0">&#91;</span>k<span class="br0">&#93;</span> <span class="sy0">=</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">;</span>
                        <span class="sy0">++</span>i<span class="sy0">;</span>
                        <span class="sy0">++</span>k<span class="sy0">;</span>
                    <span class="br0">&#125;</span>
&nbsp;
                    <span class="kw1">while</span> <span class="br0">&#40;</span>j <span class="sy0">&lt;</span> r<span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        b<span class="br0">&#91;</span>k<span class="br0">&#93;</span> <span class="sy0">=</span> a<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">;</span>
                        <span class="sy0">++</span>j<span class="sy0">;</span>
                        <span class="sy0">++</span>k<span class="sy0">;</span>
                    <span class="br0">&#125;</span>
&nbsp;
                    <span class="kw1">for</span> <span class="br0">&#40;</span>k <span class="sy0">=</span> left<span class="sy0">;</span> k <span class="sy0">&lt;</span> r<span class="sy0">;</span> <span class="sy0">++</span>k<span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        a<span class="br0">&#91;</span>k<span class="br0">&#93;</span> <span class="sy0">=</span> b<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">;</span>
                    <span class="br0">&#125;</span>
                <span class="br0">&#125;</span>
            <span class="br0">&#125;</span>
&nbsp;
            <span class="kw1">return</span> a<span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>

</div>

<h1 class="sectionedit58" id="enable_double_buffering_for_controls">Enable Double Buffering for Controls</h1>
<div class="level1">

<p>
Some window forms controls do not expose the double buffering property such that the following static extension method will attempt to enable double buffering and return true on success or false otherwise.
</p>
<pre class="code csharp">        <span class="co1">/// &lt;summary&gt;</span>
        <span class="co1">/// Enable double buffering for an arbitrary control.</span>
        <span class="co1">/// &lt;/summary&gt;</span>
        <span class="co1">/// &lt;param name=&quot;control&quot;&gt;the control to enable double buffering for&lt;/param&gt;</span>
        <span class="co1">/// &lt;returns&gt;true on success&lt;/returns&gt;</span>
        <span class="co1">/// &lt;remarks&gt;Do not enable double buffering on RDP: https://devblogs.microsoft.com/oldnewthing/20060103-12/?p=32793&lt;/remarks&gt;</span>
        <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">bool</span> SetDoubleBuffered<span class="br0">&#40;</span><span class="kw1">this</span> Control control<span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>SystemInformation<span class="sy0">.</span><span class="me1">TerminalServerSession</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="kw1">return</span> <span class="kw1">false</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
&nbsp;
            <span class="kw1">var</span> dgvType <span class="sy0">=</span> control<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">var</span> pi <span class="sy0">=</span> dgvType<span class="sy0">.</span><span class="me1">GetProperty</span><span class="br0">&#40;</span><span class="st0">&quot;DoubleBuffered&quot;</span>,
                BindingFlags<span class="sy0">.</span><span class="me1">Instance</span> <span class="sy0">|</span> BindingFlags<span class="sy0">.</span><span class="me1">NonPublic</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>pi <span class="sy0">==</span> <span class="kw1">null</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="kw1">return</span> <span class="kw1">false</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
&nbsp;
            pi<span class="sy0">.</span><span class="me1">SetValue</span><span class="br0">&#40;</span>control, <span class="kw1">true</span>, <span class="kw1">null</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
            <span class="kw1">return</span> <span class="kw1">true</span><span class="sy0">;</span>
        <span class="br0">&#125;</span></pre>

<p>
Enabling double buffering can be particularly beneficial for <code>DataGridView</code> controls that seem to speed up noticeably.
</p>

</div>

                    <!-- wikipage stop -->
                                    </div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <div class="docInfo"><bdi>fuss/csharp.txt</bdi>  Last modified: 2022/04/19 09:28 (external edit)</div>

            <!-- PAGE ACTIONS -->
            <!-- <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Revisions [O]"><span>Revisions</span></a></li><li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp?do=export_pdf"  class="action export_pdf" rel="nofollow" title="Export to PDF"><span>Export to PDF</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div>--><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer">
    <!-- <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div> -->

		<!-- BREADCRUMBS -->
					<div class="breadcrumbs">
									<div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss" class="wikilink1" title="fuss" data-wiki-id="fuss">fuss</a></bdi> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp" class="wikilink1" title="fuss:csharp" data-wiki-id="fuss:csharp">csharp</a></bdi></div>
											</div>
		
		<!-- ********** BOTTOM BAR ********** -->
		<div class="bar" id="bar__bottom">
		  <div class="bar-left" id="bar__bottomleft">
			<form class="button btn_login" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="" /><button type="submit" title="Log In">Log In</button></div></form>						<form class="button btn_revs" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp"><div class="no"><input type="hidden" name="do" value="revisions" /><button type="submit" accesskey="o" title="Revisions [O]">Revisions</button></div></form>			                        <form class="button btn_pdf" action="?do=export_pdf" method="POST">
                            <button type="submit" title="PDF">PDF</button>
                        </form>
		  </div>
		  <div class="bar-center">
                        <form class="button btn_home" action="/" method="POST">
                            <button type="submit" title="Home">Home</button>
                        </form>
			<form action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="fuss:csharp" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			<!-- <form id="osssearchform" method="get" action="renderer">
        <input type="hidden" name="use" value="grimore.org">
        <input type="hidden" name="name" value="default">
        <input type="text" id="osssearchbox" name="query">
        <input type="hidden" name="login" value="search">
        <input type="hidden" name="key" value="1a5f74ab3f4df6ce883c4c158540e25e">
        <input type="submit" value="Search">
</form>
 -->
		  </div>
		  <div class="bar-right" id="bar__bottomright">
                        <form class="button btn_contact" action="mailto:%6F%66%66%69%63%65%40%67%72%69%6D%6F%72%65%2E%6F%72%67" method="POST">
                            <button type="submit" title="Contact">Contact</button>
                        </form>
                        <form class="button btn_news" action="/feed.php?mode=recent&amp;type=rss" method="POST">
                            <button type="submit" title="News">News</button>
                        </form>
			<form class="button btn_admin" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/csharp"><div class="no"><input type="hidden" name="do" value="admin" /><button type="submit" title="Admin">Admin</button></div></form>								  </div>
		  		</div>

		
</div><!-- /footer -->

<div style="text-align: center;">
    <div style="display:inline-block;">
      <p>
        <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion">
          <img src="/lib/tpl/was/images/button-tor.png" alt="Access website using Tor" />
        </a> 
        <a href="http://ioujrf2uwqairs7l3vyvqp7n2pia3x3wg5w5qtcqvg32zezuezza.b32.i2p/" />
          <img src="/lib/tpl/was/images/button-i2p.png" alt="Access website using i2p" />
        </a>
        <a href="http://pgp.grimore.org/" />
          <img src="/lib/tpl/was/images/button-pgp.png" alt="Wizardry and Steamworks PGP Key" />
        </a>
      </p>
    </div>
<!--    <div style="display:inline-block;">
      <p>
        <a href="http://ij4lpzuyyng6cc4jw5mxibcyjv4rx4uk6x5jijoduglkgjh7mmya.b32.i2p">
          <img src="/lib/tpl/was/images/button-i2p.png" alt="Access website using i2p" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="http://cydia.grimore.org/">
          <img src="/lib/tpl/was/images/button-cydia.png" alt="Wizardry and Steamworks Cydia Repository" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="http://debian.grimore.org/">
          <img src="/lib/tpl/was/images/button-debian.png" alt="Wizardry and Steamworks Debian Repository" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="/opt/pasteboard/" rel="external nofollow">
          <img src="/lib/tpl/was/images/button-live.png" alt="Live Pasteboard" />
        </a> 
      </p>
    </div> -->
    
<br/>

    <p>
      For the copyright, license, warranty and privacy terms for the usage of this website please see the <a
      href="/wiki:license">license</a>, <a href="/wiki:privacy">privacy</a>, <a
      href="/wiki:copyright">copyright</a>
      and the <a href="/wiki:plagiarism">plagiarism</a> pages.
    </p>
</div>
    </div></div><!-- /site -->

    <div class="no"><img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/taskrunner.php?id=fuss%3Acsharp&amp;1657304306" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if lte IE 8 ]></div><![endif]-->
</body>
</html>
