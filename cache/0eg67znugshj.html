<!DOCTYPE html>
<html lang="was" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>fuss:linux [Wizardry and Steamworks]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="fuss,linux"/>
<link rel="search" type="application/opensearchdescription+xml" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/opensearch.php" title="Wizardry and Steamworks"/>
<link rel="start" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/"/>
<link rel="contents" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux?do=index" title="Sitemap"/>
<link rel="manifest" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Changes" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/feed.php?mode=list&amp;ns=fuss"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_export/xhtml/fuss/linux"/>
<link rel="canonical" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux"/>
<link rel="stylesheet" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/css.php?t=was&amp;tseed=24551d22639bdaeb736aec3dca86fd82"/>
<!--[if gte IE 9]><!-->
<script >/*<![CDATA[*/var NS='fuss';var JSINFO = {"plugin_imagemap_mldummy":"http:\/\/3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion\/_media\/wiki\/dokuwiki-128.png","isadmin":0,"isauth":0,"plugin_pdfjs":{"hide_download_button":0},"plugins":{"vshare":{"youtube":"youtube\\.com\/.*[&?]v=([a-z0-9_\\-]+)","vimeo":"vimeo\\.com\\\/(\\d+)","slideshare":"slideshare.*id=(\\d+)","dailymotion":"dailymotion\\.com\/video\/([a-z0-9]+)","archiveorg":"archive\\.org\/(?:embed|details)\/([a-zA-Z0-9_\\-]+)","soundcloud":"soundcloud\\.com\/([\\w-]+\/[\\w-]+)","niconico":"nicovideo\\.jp\/watch\/(sm[0-9]+)","bitchute":"bitchute\\.com\\\/video\\\/([a-zA-Z0-9_\\-]+)","coub":"coub\\.com\\\/view\\\/([a-zA-Z0-9_\\-]+)","odysee":"odysee\\.com\/\\$\/(?:embed|download)\/([-%_?=\/a-zA-Z0-9]+)","youku":"v\\.youku\\.com\/v_show\/id_([0-9A-Za-z=]+)\\.html","bilibili":"bilibili\\.com\\\/video\\\/(BV[0-9A-Za-z]+)","msoffice":"(?:office\\.com.*[&?]videoid=([a-z0-9\\-]+))","msstream":"microsoftstream\\.com\\\/video\\\/([a-f0-9\\-]{36})"}},"id":"fuss:linux","namespace":"fuss","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script charset="utf-8" src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/jquery.php?tseed=34a552433bc33cc9c3bc32527289a0b2"></script>
<script charset="utf-8" src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/js.php?t=was&amp;tseed=24551d22639bdaeb736aec3dca86fd82&amp;template=was"></script>
<!--<![endif]-->
    <!-- <link rel="shortcut icon" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/favicon.ico" />
<link rel="apple-touch-icon" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/apple-touch-icon.png" />
 -->
    <!-- Viewport -->
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!-- Favicon -->
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png?v=2">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png?v=2">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png?v=2">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png?v=2">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png?v=2">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png?v=2">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png?v=2">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png?v=2">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png?v=2">
<link rel="icon" type="image/png" href="/favicon-32x32.png?v=2" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png?v=2" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png?v=2" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png?v=2" sizes="16x16">
<link rel="manifest" href="/manifest.json?v=2">
<link rel="shortcut icon" href="/favicon.ico?v=2">
<meta name="apple-mobile-web-app-title" content="[Wizardry and Steamworks]">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png?v=2">
<meta name="application-name" content="[Wizardry and Steamworks]">
<meta name="theme-color" content="#ffffff">
    <!-- <script async type="text/javascript" src="/lib/tpl/was/loadCSS.js"></script>
    <script async type="text/javascript" src="/lib/tpl/was/cssrelpreload.js"></script> -->
</head>

<body>
    <!--[if lte IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_was     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header">

	    
	<!-- ********** TOP BAR ********** -->
	<div class="bar" id="bar__top">
		<div class="bar-left" id="bar__topleft">
			<form class="button btn_login" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="" /><button type="submit" title="Log In">Log In</button></div></form>						<form class="button btn_revs" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux"><div class="no"><input type="hidden" name="do" value="revisions" /><button type="submit" accesskey="o" title="Revisions [O]">Revisions</button></div></form>						<form class="button btn_pdf" action="?do=export_pdf" method="POST">
			    <button type="submit" title="PDF">PDF</button>
                        </form>
		</div>
		<div class="bar-center">
		        <form class="button btn_home" action="/" method="POST">
                            <button type="submit" title="Home">Home</button>
                        </form>
			<form action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="fuss:linux" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			<!-- <form id="osssearchform" method="get" action="renderer">
        <input type="hidden" name="use" value="grimore.org">
        <input type="hidden" name="name" value="default">
        <input type="text" id="osssearchbox" name="query">
        <input type="hidden" name="login" value="search">
        <input type="hidden" name="key" value="1a5f74ab3f4df6ce883c4c158540e25e">
        <input type="submit" value="Search">
</form>
 -->
		</div>
		<div class="bar-right" id="bar__topright">
		        <form class="button btn_contact" action="mailto:%6F%66%66%69%63%65%40%67%72%69%6D%6F%72%65%2E%6F%72%67" method="POST">
			    <button type="submit" title="Contact">Contact</button>
                        </form>
                        <form class="button btn_news" action="/feed.php?type=rss2&amp;ns=fuss:linux&amp;linkto=page&amp;content=abstract" method="POST">
			    <button type="submit" title="News">News</button>
                        </form>
			<form class="button btn_admin" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux"><div class="no"><input type="hidden" name="do" value="admin" /><button type="submit" title="Admin">Admin</button></div></form>								</div>
			</div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss" class="wikilink1" title="fuss" data-wiki-id="fuss">fuss</a></bdi> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux" class="wikilink1" title="fuss:linux" data-wiki-id="fuss:linux">linux</a></bdi></div>
                                </div>
    
    <hr class="a11y" />
</div><!-- /header -->

        <div class="wrapper group">

            <!--  -->

            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <!-- <div class="pageId"><span>fuss:linux</span></div> -->

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc" class="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#distribution_timeline">Distribution Timeline</a></div></li>
<li class="level1"><div class="li"><a href="#initd_skeleton_script">Initd Skeleton Script</a></div></li>
<li class="level1"><div class="li"><a href="#basic_firewall">Basic Firewall</a></div></li>
<li class="level1"><div class="li"><a href="#stop_udev_from_renaming_interfaces">Stop Udev from Renaming Interfaces</a></div></li>
<li class="level1"><div class="li"><a href="#crontab_diagram">Crontab Diagram</a></div></li>
<li class="level1"><div class="li"><a href="#get_ip_of_interface">Get IP of Interface</a></div></li>
<li class="level1"><div class="li"><a href="#routing_packets_out_of_the_same_interface">Routing Packets Out of the Same Interface</a></div></li>
<li class="level1"><div class="li"><a href="#prelink">Prelink</a></div></li>
<li class="level1"><div class="li"><a href="#enable_directory_indexing">Enable Directory Indexing</a></div></li>
<li class="level1"><div class="li"><a href="#get_top_10_cpu_consuming_processes">Get Top 10 CPU Consuming Processes</a></div></li>
<li class="level1"><div class="li"><a href="#recover_linux_password">Recover Linux Password</a></div></li>
<li class="level1"><div class="li"><a href="#recompile_custom_kernel_for_debian">Recompile Custom Kernel for Debian</a></div></li>
<li class="level1"><div class="li"><a href="#tripwire_regenerate_configuration_files">Tripwire Regenerate Configuration Files</a></div></li>
<li class="level1"><div class="li"><a href="#create_udev_symlink">Create UDEV Symlink</a></div></li>
<li class="level1"><div class="li"><a href="#inherit_group_ownership">Inherit Group Ownership</a></div></li>
<li class="level1"><div class="li"><a href="#guess_module_configuration_for_compiling_kernels">Guess Module Configuration for Compiling Kernels</a></div></li>
<li class="level1"><div class="li"><a href="#create_bootable_usb">Create Bootable USB</a></div></li>
<li class="level1"><div class="li"><a href="#get_page_size">Get Page Size</a></div></li>
<li class="level1"><div class="li"><a href="#measuring_performance">Measuring Performance</a></div></li>
<li class="level1"><div class="li"><a href="#renumber_partitions">Renumber Partitions</a></div></li>
<li class="level1"><div class="li"><a href="#show_socket_state_counters">Show Socket State Counters</a></div></li>
<li class="level1"><div class="li"><a href="#scrolling_virtual_terminal">Scrolling Virtual Terminal</a></div></li>
<li class="level1"><div class="li"><a href="#set_date_and_time">Set Date and Time</a></div></li>
<li class="level1"><div class="li"><a href="#load_average">Load Average</a></div></li>
<li class="level1"><div class="li"><a href="#override_dhcp_client_nameservers">Override DHCP Client Nameservers</a></div></li>
<li class="level1"><div class="li"><a href="#using_the_temporary_memory_filesystem">Using the Temporary Memory Filesystem</a></div></li>
<li class="level1"><div class="li"><a href="#dynamically_limiting_a_processes_cpu_on_network_idling">Dynamically Limiting a Processes CPU on Network Idling</a></div></li>
<li class="level1"><div class="li"><a href="#rescue_mount">Rescue Mount</a></div></li>
<li class="level1"><div class="li"><a href="#get_communicating_mac_addresses">Get Communicating MAC Addresses</a></div></li>
<li class="level1"><div class="li"><a href="#kernel_stack_traceback">Kernel Stack Traceback</a></div></li>
<li class="level1"><div class="li"><a href="#check_processes_listening_on_ipv6_addresses">Check Processes Listening on IPv6 Addresses</a></div></li>
<li class="level1"><div class="li"><a href="#disable_ipv6">Disable IPv6</a></div></li>
<li class="level1"><div class="li"><a href="#clear_semaphores">Clear Semaphores</a></div></li>
<li class="level1"><div class="li"><a href="#watchdog_error_messages">WatchDog Error Messages</a></div></li>
<li class="level1"><div class="li"><a href="#codel_over_wondershaper">Codel over Wondershaper</a></div></li>
<li class="level1"><div class="li"><a href="#granting_users_permissions_to_files">Granting Users Permissions to Files</a></div></li>
<li class="level1"><div class="li"><a href="#change_the_default_text_editor">Change the Default Text Editor</a></div></li>
<li class="level1"><div class="li"><a href="#print_all_open_files_sorted_by_number_of_file_handles">Print all Open Files Sorted By Number of File Handles</a></div></li>
<li class="level1"><div class="li"><a href="#reboot_hanging_machine">Reboot Hanging Machine</a></div></li>
<li class="level1"><div class="li"><a href="#check_solid_state_drive_for_trim">Check Solid State Drive for TRIM</a></div></li>
<li class="level1"><div class="li"><a href="#automatically_mount_filesystems_on_demand">Automatically Mount Filesystems on Demand</a></div></li>
<li class="level1"><div class="li"><a href="#automatically_reboot_after_kernel_panic">Automatically Reboot after Kernel Panic</a></div></li>
<li class="level1"><div class="li"><a href="#list_top_memory_consuming_processes">List Top Memory Consuming Processes</a></div></li>
<li class="level1"><div class="li"><a href="#get_the_most_frequently_used_commands">Get the Most Frequently Used Commands</a></div></li>
<li class="level1"><div class="li"><a href="#force_a_filesystem_check_on_reboot">Force a Filesystem Check on Reboot</a></div></li>
<li class="level1"><div class="li"><a href="#enable_multi-queue_block_io_queuing_mechanism">Enable Multi-Queue Block IO Queuing Mechanism</a></div></li>
<li class="level1"><div class="li"><a href="#export_linux_passwords">Export Linux Passwords</a></div></li>
<li class="level1"><div class="li"><a href="#create_sparse_image_of_device">Create Sparse Image of Device</a></div></li>
<li class="level1"><div class="li"><a href="#bind_to_reserved_ports_as_non-root_user">Bind to Reserved Ports as Non-Root User</a></div></li>
<li class="level1"><div class="li"><a href="#mount_apple_images">Mount Apple Images</a></div></li>
<li class="level1"><div class="li"><a href="#purge_all_e-mails_from_command-line">Purge all E-Mails from Command-Line</a></div></li>
<li class="level1"><div class="li"><a href="#remount_root_filesystem_as_read-write">Remount Root Filesystem as Read-Write</a></div></li>
<li class="level1"><div class="li"><a href="#enable_metadata_checksumming_on_ext4">Enable Metadata Checksumming on EXT4</a></div></li>
<li class="level1"><div class="li"><a href="#get_a_list_of_imap_users_from_logs">Get a List of IMAP Users from Logs</a></div></li>
<li class="level1"><div class="li"><a href="#disable_console_blanking">Disable Console Blanking</a></div></li>
<li class="level1"><div class="li"><a href="#manipulating_linux_console">Manipulating Linux Console</a></div></li>
<li class="level1"><div class="li"><a href="#resetting_usb_device_from_command_line">Resetting USB Device from Command Line</a></div></li>
<li class="level1"><div class="li"><a href="#set_cpu_governor_for_all_cpus">Set CPU Governor for all CPUs</a></div></li>
<li class="level1"><div class="li"><a href="#enable_persistent_journal_logging">Enable Persistent Journal Logging</a></div></li>
<li class="level1"><div class="li"><a href="#home_folder_permissions">Home Folder Permissions</a></div></li>
<li class="level1"><div class="li"><a href="#correctetchosts_setup">Correct /etc/hosts Setup</a></div></li>
<li class="level1"><div class="li"><a href="#disk_dump_with_progress">Disk Dump with Progress</a></div></li>
<li class="level1"><div class="li"><a href="#disable_spectre_and_meltdown_patches">Disable Spectre and Meltdown Patches</a></div></li>
<li class="level1"><div class="li"><a href="#allow_binding_privileged_ports">Allow Binding Privileged Ports</a></div></li>
<li class="level1"><div class="li"><a href="#determining_the_last_power_on_method">Determining the Last Power On Method</a></div></li>
<li class="level1"><div class="li"><a href="#issues_with_stuck_cores">Issues with Stuck Cores</a></div></li>
<li class="level1"><div class="li"><a href="#automatically_add_all_rndis_devices_to_a_bridge">Automatically Add all RNDIS Devices to a Bridge</a></div></li>
<li class="level1"><div class="li"><a href="#scraping_a_site_automatically_using_systemd">Scraping a Site Automatically using SystemD</a></div></li>
<li class="level1"><div class="li"><a href="#access_directory_underneath_mountpoint">Access Directory Underneath Mountpoint</a></div></li>
<li class="level1"><div class="li"><a href="#self-delete_shell_script">Self-Delete Shell Script</a></div></li>
<li class="level1"><div class="li"><a href="#resize_last_partition_and_filesystem_in_image_file">Resize Last Partition and Filesystem in Image File</a></div></li>
<li class="level1"><div class="li"><a href="#delete_files_older_than_x_days">Delete Files Older than X Days</a></div></li>
<li class="level1"><div class="li"><a href="#elusive_errors_from_crontab">Elusive Errors from Crontab</a></div></li>
<li class="level1"><div class="li"><a href="#clear_framebuffer_device">Clear Framebuffer Device</a></div></li>
<li class="level1"><div class="li"><a href="#adding_mount_point_dependencies_to_systemd_service_files">Adding Mount Point Dependencies to SystemD Service Files</a></div></li>
<li class="level1"><div class="li"><a href="#detaching_a_crytpsetup_header_from_an_existing_encrypted_disk">Detaching a Crytpsetup Header from an Existing Encrypted Disk</a></div></li>
<li class="level1"><div class="li"><a href="#block_transfers_over_the_network">Block Transfers over the Network</a></div></li>
<li class="level1"><div class="li"><a href="#determine_if_system_is_big-_or_little_endian">Determine if System is Big- or Little Endian</a></div></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="distribution_timeline">Distribution Timeline</h1>
<div class="level1">

<p>
<a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_detail/fuss/fuss_linux_distribution_timeline.png?id=fuss%3Alinux" class="media" title="fuss:fuss_linux_distribution_timeline.png"><img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_media/fuss/fuss_linux_distribution_timeline.png?w=512&amp;tok=17d514" class="media" alt="" width="512" /></a>
</p>

</div>

<h1 class="sectionedit2" id="initd_skeleton_script">Initd Skeleton Script</h1>
<div class="level1">
<pre class="code bash"><span class="co0">#!/bin/bash</span>
&nbsp;
<span class="kw1">case</span> <span class="st0">&quot;$1&quot;</span> <span class="kw1">in</span>
  start<span class="br0">&#41;</span>
&nbsp;
    <span class="sy0">;;</span>
  stop<span class="br0">&#41;</span>
    <span class="re2">PID</span>=<span class="sy0">`</span><span class="kw2">ps</span> <span class="re5">-ax</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st_h">'[D]AEMON'</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{print $1}'</span><span class="sy0">`</span>
&nbsp;
    <span class="sy0">;;</span>
  <span class="sy0">*</span><span class="br0">&#41;</span>
    <span class="kw3">echo</span> <span class="st0">&quot;Usage: $0 {start|stop}&quot;</span>                
    <span class="kw3">exit</span> <span class="nu0">1</span>
    <span class="sy0">;;</span>
<span class="kw1">esac</span>
&nbsp;
<span class="kw3">exit</span> <span class="nu0">0</span></pre>

<p>
where <code>DAEMON</code> is the name of the daemon the script is supposed to manage.
</p>

</div>

<h1 class="sectionedit3" id="basic_firewall">Basic Firewall</h1>
<div class="level1">
<pre class="code bash"><span class="co0">#!/bin/sh</span>
&nbsp;
<span class="re2">LOCAL_IF</span>=<span class="st0">&quot;eth1&quot;</span>
<span class="re2">NET_IF</span>=<span class="st0">&quot;eth0&quot;</span>
&nbsp;
iptables <span class="re5">-F</span>
iptables <span class="re5">-t</span> nat <span class="re5">-F</span>
iptables <span class="re5">-X</span>
&nbsp;
iptables <span class="re5">-P</span> INPUT DROP
&nbsp;
<span class="co0"># Accept local network</span>
iptables <span class="re5">-A</span> INPUT <span class="re5">-i</span> <span class="re1">$LOCAL_IF</span> <span class="re5">-j</span> ACCEPT
<span class="co0"># and loopback.</span>
iptables <span class="re5">-A</span> INPUT <span class="re5">-i</span> lo <span class="re5">-j</span> ACCEPT
&nbsp;
<span class="co0"># accept established, related</span>
iptables <span class="re5">-A</span> INPUT <span class="re5">-m</span> state <span class="re5">--state</span> ESTABLISHED,RELATED <span class="re5">-j</span> ACCEPT
&nbsp;
<span class="co0"># masquerade</span>
iptables <span class="re5">-t</span> nat <span class="re5">-A</span> POSTROUTING <span class="re5">-o</span> <span class="re1">$NET_IF</span> <span class="re5">-j</span> MASQUERADE
&nbsp;
<span class="co0"># ip-forwarding</span>
<span class="kw3">echo</span> <span class="st0">&quot;1&quot;</span> <span class="sy0">&gt;/</span>proc<span class="sy0">/</span>sys<span class="sy0">/</span>net<span class="sy0">/</span>ipv4<span class="sy0">/</span>ip_forward</pre>

</div>

<h1 class="sectionedit4" id="stop_udev_from_renaming_interfaces">Stop Udev from Renaming Interfaces</h1>
<div class="level1">

<p>
On Debian-like Linux systems, including Ubuntu, Udev by default keeps track of the MAC address of network interfaces. If you happen to replace a network card, the operating system increments the interface number instead of reporting just the cards that it finds in the computer at that time. To stop this behavior, the following Udev ruleset can be eliminated:
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="st0">&quot;&quot;</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>etc<span class="sy0">/</span>udev<span class="sy0">/</span>rules.d<span class="sy0">/</span><span class="nu0">70</span>-persistent-net.rules</pre>

<p>
After a reboot, Udev will stop renaming the interfaces (as it should have done from the start).
</p>

<p>
A different way to stop Linux from changing the interface names is to append:
</p>
<pre class="code">net.ifnames=0</pre>

<p>
to the kernel command line (for grub, by editing <code>/etc/default/grub</code> and adding it to <code>GRUB_CMDLINE_LINUX_DEFAULT</code>).
</p>

</div>

<h1 class="sectionedit5" id="crontab_diagram">Crontab Diagram</h1>
<div class="level1">
<pre class="code">
*  *  *  *  * command to execute
|  |  |  |  |
|  |  |  |  +-- day of week (0-7) (Sunday=0 or 7)
|  |  |  +----- month (1-12)
|  |  +-------- day of month (1-31)
|  +----------- hour (0-23)
+-------------- minute (0-59)
</pre>

</div>

<h1 class="sectionedit6" id="get_ip_of_interface">Get IP of Interface</h1>
<div class="level1">

<p>
The following command will return the IP address of the interface <code>eth0</code>:
</p>
<pre class="code bash"><span class="sy0">/</span>sbin<span class="sy0">/</span><span class="kw2">ifconfig</span> eth0 <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st0">&quot;inet addr&quot;</span> <span class="sy0">|</span> <span class="kw2">awk</span> -F: <span class="st_h">'{print $2}'</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{print $1}'</span></pre>

</div>

<h1 class="sectionedit7" id="routing_packets_out_of_the_same_interface">Routing Packets Out of the Same Interface</h1>
<div class="level1">

<p>
A common problem on linux is that packets coming in from an interface do not necessarily get a reply from a server out of the same interface that they came in from. In order to fix this, we have to set-up a few routing tables by editing <code>/etc/iproute2/rt_tables</code> and adding, for example, two tables:
</p>
<pre class="code">100     table_a
101     table_b</pre>

<p>
then, we can route the packets out of the same interface that they came in from using:
</p>
<pre class="code bash"><span class="kw2">ip route</span> add default via <span class="re1">$GATEWAY_A</span> dev <span class="re1">$INTERFACE_A</span> src <span class="re1">$IP_A</span> table table_a
<span class="kw2">ip rule</span> add from <span class="re1">$IP_A</span> table table_b</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>$GATEWAY_A</code> is the gateway IP for an interface.</div>
</li>
<li class="level1"><div class="li"> <code>$INTERFACE_A</code> is the interface that the packets come in from.</div>
</li>
<li class="level1"><div class="li"> <code>$IP_A</code> is the IP address assigned to the interface.</div>
</li>
</ul>

</div>

<h1 class="sectionedit8" id="prelink">Prelink</h1>
<div class="level1">

<p>
To prelink binaries, using the <code>prelink</code> tool:
</p>
<pre class="code bash">prelink <span class="re5">-amR</span></pre>

<p>
To restore:
</p>
<pre class="code bash">prelink <span class="re5">-au</span></pre>

</div>

<h1 class="sectionedit9" id="enable_directory_indexing">Enable Directory Indexing</h1>
<div class="level1">
<pre class="code bash">tune2fs  <span class="re5">-O</span> dir_index <span class="sy0">/</span>dev<span class="sy0">/</span>sda2</pre>

<p>
Where <code>/dev/sda2</code> contains an Ext3 filesystem.
</p>

</div>

<h1 class="sectionedit10" id="get_top_10_cpu_consuming_processes">Get Top 10 CPU Consuming Processes</h1>
<div class="level1">
<pre class="code bash"><span class="kw2">ps</span> <span class="re5">-eo</span> pcpu,pid,user,args <span class="sy0">|</span> <span class="kw2">sort</span> <span class="re5">-k</span> <span class="nu0">1</span> <span class="re5">-r</span> <span class="sy0">|</span> <span class="kw2">head</span> <span class="re5">-10</span></pre>

</div>

<h1 class="sectionedit11" id="recover_linux_password">Recover Linux Password</h1>
<div class="level1">

<p>
Made by <a href="http://www.youtube.com/watch?v=8RCBw3phhAY" class="urlextern" title="http://www.youtube.com/watch?v=8RCBw3phhAY" rel="ugc nofollow">Blagovest ILIEV</a> and adapted to GIF animation.
</p>

<p>
<a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_detail/fuss/linux_recover_password.gif?id=fuss%3Alinux" class="media" title="fuss:linux_recover_password.gif"><img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_media/fuss/linux_recover_password.gif" class="media" alt="" /></a>
</p>

</div>

<h1 class="sectionedit12" id="recompile_custom_kernel_for_debian">Recompile Custom Kernel for Debian</h1>
<div class="level1">

<p>
After downloading the source, applying the necessary patches, issue:
</p>
<pre class="code bash"><span class="kw2">make</span> menuconfig</pre>

<p>
and configure the kernel. After that issue:
</p>
<pre class="code bash">make-kpkg <span class="re5">--initrd</span> kernel_image</pre>

<p>
to make a <code>.deb</code> package which will be placed one level up from the kernel source directory.
</p>

<p>
Note that building an <code>initrd</code> image is essential because it contains the necessary drivers to bootstrap the boot system. If you recompile manually, the old way, Debian will not boot.
</p>

</div>

<h1 class="sectionedit13" id="tripwire_regenerate_configuration_files">Tripwire Regenerate Configuration Files</h1>
<div class="level1">

<p>
After modifying the database configuration at <code>/etc/tripwire/twpol.txt</code>, the following script can be used to regenerate the database:
</p>
<pre class="code bash"><span class="co0">#!/bin/sh -e</span>
twadmin <span class="re5">-m</span> P <span class="re5">-S</span> site.key twpol.txt
twadmin <span class="re5">-m</span> F <span class="re5">-S</span> site.key twcfg.txt
tripwire <span class="re5">-m</span> i</pre>

</div>

<h1 class="sectionedit14" id="create_udev_symlink">Create UDEV Symlink</h1>
<div class="level1">

<p>
For example to link any <code>/dev/grsec</code> device to <code>/dev/grsec2</code>, add a file at <code>/etc/udev/rules.d/60-grsec-compatiblity.rules</code> with the following contents:
</p>
<pre class="code">KERNEL==&quot;grsec*&quot;, SYMLINK+=&quot;grsec2&quot;</pre>

</div>

<h1 class="sectionedit15" id="inherit_group_ownership">Inherit Group Ownership</h1>
<div class="level1">

<p>
Suppose you have a parent directory <code>upper</code>, and that the directory <code>upper</code> is group-owned by a group called <code>maintain</code>.
</p>

<p>
You want that all new directories and files under that parent directory <code>upper</code>, regardless by whom they are created (ie: <code>root</code>) to be group-owned by <code>maintain</code>.
</p>

<p>
This can be accomplished by setting the set-guid flag on the parent directory <code>upper</code>:
</p>
<pre class="code bash"><span class="kw2">chmod</span> g+s upper</pre>

</div>

<h1 class="sectionedit16" id="guess_module_configuration_for_compiling_kernels">Guess Module Configuration for Compiling Kernels</h1>
<div class="level1">

<p>
<code>localmodconfig</code> can be used to auto-detect the necessary modules for the kernel.
</p>
<pre class="code bash"><span class="kw2">make</span> localmodconfig</pre>

</div>

<h1 class="sectionedit17" id="create_bootable_usb">Create Bootable USB</h1>
<div class="level1">

<p>
For a disk with the following partition layout:
</p>

<p>
<img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_media/fuss/linux?ditaa=6fa748971c682937e93fd9bf73e4af30&amp;t=1656106424" class="media" alt=""/>
</p>

<p>
first install <code>syslinux</code> and then issue:
</p>
<pre class="code bash">mkdosfs <span class="re5">-F32</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sdc1</pre>

<p>
to format <code>/dev/sdc1</code> to MS-DOS.
</p>

<p>
Now copy the <code>MBR</code> file to the drive:
</p>
<pre class="code bash"><span class="kw2">dd</span> <span class="re2">if</span>=<span class="sy0">/</span>usr<span class="sy0">/</span>share<span class="sy0">/</span>syslinux<span class="sy0">/</span>mbr.bin <span class="re2">of</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>sdc</pre>

<p>
Finally, install <code>syslinux</code>:
</p>
<pre class="code bash">syslinux <span class="sy0">/</span>dev<span class="sy0">/</span>sdc1</pre>

<p>
Next step is to make the disk bootable with <code>fdisk</code> (run fdisk /dev/sdc and press <code>a</code> to toggle the bootable flag).
</p>

</div>

<h1 class="sectionedit18" id="get_page_size">Get Page Size</h1>
<div class="level1">
<pre class="code bash">getconf PAGE_SIZE</pre>

</div>

<h1 class="sectionedit19" id="measuring_performance">Measuring Performance</h1>
<div class="level1">

<p>
This can be accomplished with:
</p>
<pre class="code bash">dstat <span class="re5">-t</span> <span class="re5">-c</span> <span class="nu0">5</span> <span class="nu0">500</span></pre>

<p>
where <code>t</code> indicates time-based output and <code>c</code> stands for <code>CPU</code>.
</p>

<p>
The output is:
</p>
<pre class="code">----system---- ----total-cpu-usage----
     time     |usr sys idl wai hiq siq
11-02 18:33:24|  3   1  95   0   0   0
11-02 18:33:29| 14   3  83   0   0   0</pre>

<p>
Other options are also available:
</p>
<div class="table sectionedit20"><table class="inline">
	<thead>
	<tr class="row0">
		<th class="col0"> Flag </th><th class="col1"> Meaning </th>
	</tr>
	</thead>
	<tr class="row1">
		<td class="col0"> <code>c</code> </td><td class="col1 leftalign"> <code>CPU</code>    </td>
	</tr>
	<tr class="row2">
		<td class="col0"> <code>d</code> </td><td class="col1"> disk (read, write) </td>
	</tr>
	<tr class="row3">
		<td class="col0"> <code>g</code> </td><td class="col1"> page stats (in, out) </td>
	</tr>
	<tr class="row4">
		<td class="col0"> <code>i</code> </td><td class="col1"> interrupts </td>
	</tr>
	<tr class="row5">
		<td class="col0"> <code>l</code> </td><td class="col1"> load (1min, 5min, 15min) </td>
	</tr>
	<tr class="row6">
		<td class="col0"> <code>m</code> </td><td class="col1"> memory (used, buffers, cache, free) </td>
	</tr>
	<tr class="row7">
		<td class="col0"> <code>n</code> </td><td class="col1"> network (receive, send) </td>
	</tr>
	<tr class="row8">
		<td class="col0"> <code>p</code> </td><td class="col1"> process stats (runnable, uninterruptible, new) </td>
	</tr>
	<tr class="row9">
		<td class="col0"> <code>r</code> </td><td class="col1"> <code>I/O</code> request stats (read, write) </td>
	</tr>
	<tr class="row10">
		<td class="col0"> <code>s</code> </td><td class="col1"> swap stats (used, free) </td>
	</tr>
	<tr class="row11">
		<td class="col0"> <code>y</code> </td><td class="col1"> system stats (interrupts, context switches) </td>
	</tr>
	<tr class="row12">
		<td class="col0"> <code>aio</code> </td><td class="col1"> asynchronous <code>I/O</code> </td>
	</tr>
	<tr class="row13">
		<td class="col0"> <code>fs</code> </td><td class="col1"> filesystem (open files, inodes) </td>
	</tr>
	<tr class="row14">
		<td class="col0"> <code>ipc</code> </td><td class="col1"> IPC stats (queues, semaphores, shared memory) </td>
	</tr>
	<tr class="row15">
		<td class="col0"> <code>lock</code> </td><td class="col1"> file locks (posix, flock, read, write) </td>
	</tr>
	<tr class="row16">
		<td class="col0"> <code>raw</code> </td><td class="col1"> raw sockets </td>
	</tr>
	<tr class="row17">
		<td class="col0"> <code>socket</code> </td><td class="col1"> sockets (total, tcp, udp, raw, ip-fragments) </td>
	</tr>
	<tr class="row18">
		<td class="col0"> <code>tcp</code> </td><td class="col1"> tcp stats (listen, established, syn, time_wait, close) </td>
	</tr>
	<tr class="row19">
		<td class="col0"> <code>udp</code> </td><td class="col1"> udp stats (listen, active) </td>
	</tr>
	<tr class="row20">
		<td class="col0"> <code>unix</code> </td><td class="col1"> unix stats (datagram, stream, listen, active) </td>
	</tr>
	<tr class="row21">
		<td class="col0"> <code>vm</code> </td><td class="col1"> vm stats (hard pagefaults, soft pagefaults, allocated, free) </td>
	</tr>
</table></div>

</div>

<h1 class="sectionedit21" id="renumber_partitions">Renumber Partitions</h1>
<div class="level1">

<p>
To renumber partitions we first dump the table using <code>sfdisk</code>:
</p>
<pre class="code bash">sfdisk <span class="re5">-d</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sda <span class="sy0">&gt;</span> sda.table</pre>

<p>
then, we edit <code>sda.table</code> to edit the partitions:
</p>
<pre class="code"># partition table of /dev/sda
unit: sectors

/dev/sda1 : start=      2048, size=  4194304, Id=82
/dev/sda2 : start=         0, size=        0, Id= 0
/dev/sda3 : start=   4196352, size= 47747546, Id=83, bootable</pre>

<p>
In this case, we will delete the line starting with <code>/dev/sda2</code> and rename <code>/dev/sda3</code> to <code>/dev/sda2</code>:
</p>
<pre class="code"># partition table of /dev/sda
unit: sectors

/dev/sda1 : start=      2048, size=  4194304, Id=82
/dev/sda2 : start=   4196352, size= 47747546, Id=83, bootable</pre>

<p>
Next, we restore the modified table:
</p>
<pre class="code bash">sfdisk <span class="sy0">/</span>dev<span class="sy0">/</span>sda <span class="sy0">&lt;</span> sda.table</pre>

</div>

<h1 class="sectionedit22" id="show_socket_state_counters">Show Socket State Counters</h1>
<div class="level1">
<pre class="code bash"><span class="kw2">netstat</span> <span class="re5">-an</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'/^tcp/ {A[$(NF)]++} END {for (I in A) {printf &quot;%5d %s\n&quot;, A[I], I}}'</span></pre>

</div>

<h1 class="sectionedit23" id="scrolling_virtual_terminal">Scrolling Virtual Terminal</h1>
<div class="level1">

<p>
To scroll the virtual terminal up and down use the keys <kbd class="__keyboard">Shift</kbd>+<kbd class="__keyboard">Page&uarr;</kbd> and <kbd class="__keyboard">Shift</kbd>+<kbd class="__keyboard">Page&darr;</kbd>. In case you are using a Mac keyboard without <kbd class="__keyboard">Page&uarr;</kbd> or <kbd class="__keyboard">Page&darr;</kbd>, then the keys <kbd class="__keyboard">Shift</kbd>+<kbd class="__keyboard">Fn</kbd>+<kbd class="__keyboard">&uarr;</kbd> and <kbd class="__keyboard">Shift</kbd>+<kbd class="__keyboard">Fn</kbd>+<kbd class="__keyboard">&darr;</kbd> should achieve the scrolling.
</p>

</div>

<h1 class="sectionedit24" id="set_date_and_time">Set Date and Time</h1>
<div class="level1">

<p>
<code>date</code> can be used to set the system clock, however <code>hwclock</code> has to also be used to set the hardware clock. First we set a date using <code>date</code>:
</p>
<pre class="code bash"><span class="kw2">date</span> <span class="re5">-s</span> <span class="st0">&quot;1 MAY 2013 10:15:00&quot;</span></pre>

<p>
or in two commands using formatting characters; first the date:
</p>
<pre class="code bash"><span class="kw2">date</span> +<span class="sy0">%</span>Y<span class="sy0">%</span>m<span class="sy0">%</span>d <span class="re5">-s</span> <span class="st0">&quot;20130501&quot;</span></pre>

<p>
then the time:
</p>
<pre class="code bash"><span class="kw2">date</span> +<span class="sy0">%</span>T <span class="re5">-s</span> <span class="st0">&quot;10:15:00&quot;</span></pre>

<p>
After that, the hardware clock has to be set (the hardware clock runs independent of the Linux time and of other hardware, powered by a battery). To set the hardware clock to the system clock (since we have already done that above), issue:
</p>
<pre class="code bash">hwclock <span class="re5">--systohc</span></pre>

<p>
Or, as an independent command, to set the hardware clock to local time:
</p>
<pre class="code bash">hwclock <span class="re5">--set</span> <span class="re5">--date</span>=<span class="st0">&quot;2013-05-01 10:15:00&quot;</span> <span class="re5">--localtime</span></pre>

<p>
of for <code>UTC</code>:
</p>
<pre class="code bash">hwclock <span class="re5">--set</span> <span class="re5">--date</span>=<span class="st0">&quot;2013-05-01 10:15:00&quot;</span> <span class="re5">--utc</span></pre>

</div>

<h1 class="sectionedit25" id="load_average">Load Average</h1>
<div class="level1">

<p>
The load-average is included in the <code>uptime</code> command:
</p>
<pre class="code">09:48:35 up 8 days,  7:03,  5 users,  load average: 0.24, 0.28, 0.25</pre>

<p>
The load average numbers are scaled up to the number of <code>CPU</code>s. For example, on a quad-core CPU, the maximal load-average (when all 4 cores are busy) would be <code>4</code>. The numbers thus represent only a fraction of the total CPU power that is currently being utilised.
</p>

</div>

<h1 class="sectionedit26" id="override_dhcp_client_nameservers">Override DHCP Client Nameservers</h1>
<div class="level1">

<p>
<code>dhclient</code> is responsible in most Linux distributions for acquiring the <code>DHCP</code> parameters from upstream <code>DHCP</code> servers. The configuration can be altered to not pull name-servers and instead prepend some static name-servers. The configuration has to changed such that the domains a prepended:
</p>
<pre class="code">prepend domain-name-servers 1.1.1.1, 2.2.2.2;</pre>

<p>
where <code>1.1.1.1</code> and <code>2.2.2.2</code> represent name-servers <code>IP</code> addresses.
</p>

<p>
Next, the <code>domain-name-servers</code> and <code>domain-search</code> directives should be removed from the <code>request</code> clause, the result looking like:
</p>
<pre class="code">request subnet-mask, broadcast-address, time-offset, routers,
        domain-name, host-name,               
        dhcp6.name-servers, dhcp6.domain-search,
        netbios-name-servers, netbios-scope, interface-mtu,
        rfc3442-classless-static-routes, ntp-servers;</pre>

<p>
After a restart <code>dhclient</code> will prepend the specified name-servers and place them in <code>/etc/resolv.conf</code> as well as ignoring the <code>DHCP</code>&#039;s settings for the <code>domain-name-servers</code> and <code>domain-search</code> directives.
</p>

</div>

<h1 class="sectionedit27" id="using_the_temporary_memory_filesystem">Using the Temporary Memory Filesystem</h1>
<div class="level1">

<p>
The temporary memory filesystem (<code>tmpfs</code>) can be used when you want to temporary store files that will be deleted on the next reboot. This is helpful, for example, when you want to store log-files that are not important over reboots and want to reduce the pressure on the hard-drive.
</p>

<p>
Adding this entry to <code>/etc/fstab</code> will, for example, mount <code>polipo</code>&#039;s cache directory in <code>RAM</code>:
</p>
<pre class="code">tmpfs        /var/cache/polipo       tmpfs nodev,noexec,nodiratime,noatime,nosuid,size=5G,async      0       0</pre>

<p>
using a slab of <code>5G</code>.
</p>

</div>

<h1 class="sectionedit28" id="dynamically_limiting_a_processes_cpu_on_network_idling">Dynamically Limiting a Processes CPU on Network Idling</h1>
<div class="level1">

<p>
This function works together with <code>iptables</code> and the <code>IDLETIMER</code> module in order to limit the <code>CPU</code> consumption of a process (commonly a daemon) when the process does not generate incoming traffic.
</p>
<pre class="code bash"><span class="co0">#!/bin/bash</span>
<span class="co0">###########################################################################</span>
<span class="co0">##  Copyright (C) Wizardry and Steamworks 2014 - License: GNU GPLv3      ##</span>
<span class="co0">##  Please see: http://www.gnu.org/licenses/gpl.html for legal details,  ##</span>
<span class="co0">##  rights of fair usage, the disclaimer and warranty conditions.        ##</span>
<span class="co0">###########################################################################</span>
<span class="co0"># The function suspends or resumes the named process passed as parameter to </span>
<span class="co0"># the fuction, provided that iptables has been set-up to create an idle </span>
<span class="co0"># timer for the named process passed as the parameter to this function.</span>
<span class="co0">#</span>
<span class="co0"># For this function to work properly, you should issue:</span>
<span class="co0"># iptables -A INPUT -p tcp --dport 8085 -j IDLETIMER \</span>
<span class="co0">#	--timeout 60 --label $process_name</span>
<span class="co0"># where $process_name is the parameter passed to this function</span>
<span class="co0">#</span>
<span class="co0"># This script is best called via crontab to periodically check whether a </span>
<span class="co0"># proccess's network traffic is stale and to suspend the process if it is.</span>
<span class="kw1">function</span> idlecpulimit <span class="br0">&#123;</span>
    <span class="co0"># path to the cpulimit daemon</span>
    <span class="kw3">local</span> <span class="re2">cpulimit</span>=<span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>cpulimit
    <span class="co0"># percent to throttle to accounting for multiple CPUs</span>
    <span class="co0"># effective throttle = (CPUs available) x throttle</span>
    <span class="kw3">local</span> <span class="re2">throttle</span>=<span class="nu0">1</span>
    <span class="co0"># get the car and cdr of the daemon</span>
    <span class="kw3">local</span> <span class="re2">car</span>=<span class="sy0">`</span><span class="kw3">echo</span> <span class="re4">$1</span> <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-c</span> <span class="nu0">1</span><span class="sy0">`</span>
    <span class="kw3">local</span> <span class="re2">cdr</span>=<span class="sy0">`</span><span class="kw3">echo</span> <span class="re4">$1</span> <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-c</span> <span class="nu0">2</span>-<span class="sy0">`</span>
    <span class="co0"># get the daemon if it is running</span>
    <span class="kw3">local</span> <span class="re2">daemon</span>=<span class="sy0">`</span><span class="kw2">ps</span> ax <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st0">&quot;[<span class="es2">$car</span>]<span class="es2">$cdr</span>&quot;</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{ print $1 }'</span><span class="sy0">`</span>
    <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re5">-z</span> <span class="re1">$daemon</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
    	<span class="co0"># just bail if it is not running</span>
    	<span class="kw3">return</span>;
    <span class="kw1">fi</span>
    <span class="co0"># get the PID of the cpulimit daemon for the process</span>
    <span class="kw3">local</span> <span class="re2">cpulimit_PID</span>=<span class="sy0">`</span><span class="kw2">ps</span> ax <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st_h">'[c]pulimit'</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re1">$daemon</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{ print $1 }'</span><span class="sy0">`</span>
    <span class="kw1">case</span> <span class="sy0">`</span><span class="kw2">cat</span> <span class="sy0">/</span>sys<span class="sy0">/</span>class<span class="sy0">/</span>xt_idletimer<span class="sy0">/</span>timers<span class="sy0">/</span><span class="re4">$1</span><span class="sy0">`</span> <span class="kw1">in</span>
        <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="co0"># suspend</span>
            <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="re5">-z</span> <span class="re1">$cpulimit_PID</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
                <span class="re1">$cpulimit</span> <span class="re5">-l</span> <span class="re1">$throttle</span> <span class="re5">-p</span> <span class="re1">$daemon</span> <span class="re5">-b</span> <span class="sy0">&gt;/</span>dev<span class="sy0">/</span>null <span class="nu0">2</span><span class="sy0">&gt;&amp;</span><span class="nu0">1</span>
            <span class="kw1">fi</span>
            <span class="sy0">;;</span>
        <span class="sy0">*</span><span class="br0">&#41;</span>
            <span class="co0"># resume</span>
            <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="sy0">!</span> <span class="re5">-z</span> <span class="re1">$cpulimit_PID</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
                <span class="kw3">kill</span> <span class="re5">-s</span> TERM <span class="re1">$cpulimit_PID</span> <span class="sy0">&gt;/</span>dev<span class="sy0">/</span>null <span class="nu0">2</span><span class="sy0">&gt;&amp;</span><span class="nu0">1</span>
            <span class="kw1">fi</span>
            <span class="sy0">;;</span>
    <span class="kw1">esac</span>
<span class="br0">&#125;</span></pre>

<p>
As an example, suppose you had a daemon named <code>mangosd</code> and, as a daemon, it is active when it has inbound connections on port <code>8085</code>. In that case, you would first add a firewall rule:
</p>
<pre class="code bash">iptables <span class="re5">-A</span> INPUT <span class="re5">-p</span> tcp <span class="re5">--dport</span> <span class="nu0">8085</span> <span class="re5">-j</span> IDLETIMER <span class="re5">--timeout</span> <span class="nu0">60</span> <span class="re5">--label</span> mangosd</pre>

<p>
which will start a countdown timer in <code>/sys/class/xt_idletimer/timers/mangosd</code> when the connection is idle.
</p>

<p>
After that, you would create a script containing the function above and call it in your script:
</p>
<pre class="code bash"><span class="kw1">function</span> idlecpulimit <span class="br0">&#123;</span>
    ...
<span class="br0">&#125;</span>
&nbsp;
idlecpulimit mangosd</pre>

<p>
The script will then be placed in <code>/etc/cron.d/cron.minutely</code> and will limit or release the <code>CPU</code> limitation when the daemon receives traffic.
</p>

</div>

<h1 class="sectionedit29" id="rescue_mount">Rescue Mount</h1>
<div class="level1">

<p>
Suppose that you have made a configuration error and you need to boot from a <code>LiveCD</code> and <code>chroot</code> to the filesystem in order to repair the damage. In that case, you will find that you will need the <code>proc</code>, <code>dev</code> and <code>sys</code> filesystems. These can be mounted by using the <code>bind</code> option of <code>mount</code>:
</p>
<pre class="code bash"><span class="kw2">mount</span> <span class="re5">-o</span> <span class="kw3">bind</span> <span class="sy0">/</span>dev <span class="sy0">/</span>mnt<span class="sy0">/</span>chroot<span class="sy0">/</span>dev
<span class="kw2">mount</span> <span class="re5">-o</span> <span class="kw3">bind</span> <span class="sy0">/</span>sys <span class="sy0">/</span>mnt<span class="sy0">/</span>chroot<span class="sy0">/</span>sys
<span class="kw2">mount</span> <span class="re5">-o</span> <span class="kw3">bind</span> <span class="sy0">/</span>proc <span class="sy0">/</span>mnt<span class="sy0">/</span>chroot<span class="sy0">/</span>proc</pre>

<p>
Considering that the damaged filesystem is mounted on <code>/mnt/chroot</code>. After the filesystems are mounted, you can <code>chroot</code> to the filesystem and run commands such as <code>update-grub</code>:
</p>
<pre class="code bash"><span class="kw2">chroot</span> <span class="sy0">/</span>mnt<span class="sy0">/</span><span class="kw2">chroot</span></pre>

</div>

<h1 class="sectionedit30" id="get_communicating_mac_addresses">Get Communicating MAC Addresses</h1>
<div class="level1">
<pre class="code bash">tcpdump <span class="re5">-i</span> eth0 <span class="re5">-s</span> <span class="nu0">30</span> <span class="re5">-e</span> <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-f1</span> <span class="re5">-d</span><span class="st_h">','</span></pre>

<p>
where <code>eth0</code> is the interface.
</p>

</div>

<h1 class="sectionedit31" id="kernel_stack_traceback">Kernel Stack Traceback</h1>
<div class="level1">

<p>
For hung processes, the stack traceback can show where the processes are waiting. The <code>CONFIG_MAGIC_SYSRQ</code> must be enabled in the kernel to enable stack tracebacks. If <code>kernel.sysrq</code> is not set to <code>1</code> with <code>sysctl</code>, then run:
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="nu0">1</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>proc<span class="sy0">/</span>sys<span class="sy0">/</span>kernel<span class="sy0">/</span>sysrq</pre>

<p>
Next, trigger the stack traceback by issuing:
</p>
<pre class="code bash"><span class="kw3">echo</span> t <span class="sy0">&gt;</span> <span class="sy0">/</span>proc<span class="sy0">/</span>sysrq-trigger</pre>

<p>
The results can be found on the console or in <code>/var/log/messages</code>.
</p>

</div>

<h1 class="sectionedit32" id="check_processes_listening_on_ipv6_addresses">Check Processes Listening on IPv6 Addresses</h1>
<div class="level1">
<pre class="code bash"><span class="kw2">netstat</span> <span class="re5">-tunlp</span> <span class="sy0">|</span><span class="kw2">grep</span> p6</pre>

</div>

<h1 class="sectionedit33" id="disable_ipv6">Disable IPv6</h1>
<div class="level1">

<p>
First edit <code>/etc/hosts</code> to comment out any IPv6 addresses:
</p>
<pre class="code"># The following lines are desirable for IPv6 capable hosts
#::1     ip6-localhost ip6-loopback
#fe00::0 ip6-localnet
#ff00::0 ip6-mcastprefix
#ff02::1 ip6-allnodes
#ff02::2 ip6-allrouters</pre>

<p>
After that, if you are using grub, edit <code>/etc/default/grub</code> and add:
</p>
<pre class="code">ipv6.disable=1</pre>

<p>
to the list following <code>GRUB_CMDLINE_LINUX_DEFAULT</code>. 
</p>

<p>
In case you use lilo, edit <code>/etc/lilo.conf</code> instead and modify the <code>append</code> line to include <code>ipv6.disable=1</code>.
</p>

<p>
Issue <code>update-grub</code> or <code>lilo</code> to make those changes.
</p>

<p>
You can also add a sysctl setting:
</p>
<pre class="code">net.ipv6.conf.all.disable_ipv6 = 1</pre>

<p>
to <code>/etc/sysctl.d/local.conf</code>.
</p>

<p>
Additionally, in case you are running a system with a bundled MTA such as exim, you should probably keep it from binding to IPv6 addresses.
</p>

<p>
For exim, edit <code>/etc/exim4/update-exim4.conf.conf</code> and change the <code>dc_local_interfaces</code> to listen only on IPv4:
</p>
<pre class="code">dc_local_interfaces=&#039;127.0.0.1&#039;</pre>

<p>
and then add:
</p>
<pre class="code"># Disable IPv6
disable_ipv6 = true </pre>

<p>
in both <code>/etc/exim4/exim4.conf.template</code> and <code>/etc/exim4/conf.d/main/01_exim4-config_listmacrosdefs</code> and run <code>update-exim4.conf</code> followed by a restart of the service.
</p>

<p>
Otherwise you might receive the error: <code>ALERT: exim paniclog /var/log/exim4/paniclog has non-zero size, mail system possibly broken failed!</code>.
</p>

</div>

<h1 class="sectionedit34" id="clear_semaphores">Clear Semaphores</h1>
<div class="level1">

<p>
<code>ipcs</code> can be used to display all semaphores:
</p>
<pre class="code bash">ipcs <span class="re5">-s</span></pre>

<p>
to remove a semaphore by id, issue:
</p>
<pre class="code bash">ipcrm sem <span class="nu0">2123561</span></pre>

<p>
To clear all semaphores for a user, for example, for apache (as user <code>www-data</code> on Debian):
</p>
<pre class="code bash">ipcs <span class="re5">-s</span> <span class="sy0">|</span> <span class="kw2">grep</span> www-data <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{ print $2 }'</span> <span class="sy0">|</span> <span class="kw1">while</span> <span class="kw3">read</span> i; <span class="kw1">do</span> ipcrm sem <span class="re1">$i</span>; <span class="kw1">done</span></pre>

</div>

<h1 class="sectionedit35" id="watchdog_error_messages">WatchDog Error Messages</h1>
<div class="level1">

<p>
Before the watchdog restarts the system, it fires off an email indicating the problem, for example:
</p>
<pre class="code">Message from watchdog:
The system will be rebooted because of error -3!</pre>

<p>
The error codes can be found in the man page, here is a list of reasons:
</p>
<ul>
<li class="level1"><div class="li"> <code>-1</code> The system will reboot. Does not indicate an error.</div>
</li>
<li class="level1"><div class="li"> <code>-2</code> The system will reboot. Does not indicate an error.</div>
</li>
<li class="level1"><div class="li"> <code>-3</code> The load average has reached its maximum specified value.</div>
</li>
<li class="level1"><div class="li"> <code>-4</code> Temperature too high.</div>
</li>
<li class="level1"><div class="li"> <code>-5</code> <code>/proc/loadavg</code> contains no data or not enough data.</div>
</li>
<li class="level1"><div class="li"> <code>-6</code> The given file was not changed in the given interval.</div>
</li>
<li class="level1"><div class="li"> <code>-7</code> <code>/proc/meminfo</code> content.</div>
</li>
<li class="level1"><div class="li"> <code>-8</code> Child process was killed by a signal.</div>
</li>
<li class="level1"><div class="li"> <code>-9</code> Child process did not return in time.</div>
</li>
<li class="level1"><div class="li"> <code>-10</code> User specified.</div>
</li>
</ul>

</div>

<h1 class="sectionedit36" id="codel_over_wondershaper">Codel over Wondershaper</h1>
<div class="level1">

<p>
On recent Linux distributions, Codel can be enabled which is better than wondershaper. This can be done by editing the sysctl configuration file (<code>/etc/sysctl.d/local.conf</code>) and adding the line:
</p>
<pre class="code">net.core.default_qdisc = fq_codel</pre>

<p>
for general-purpose routers including virtual machine hosts and:
</p>
<pre class="code">net.core.default_qdisc = fq</pre>

<p>
for fat servers.
</p>

</div>

<h1 class="sectionedit37" id="granting_users_permissions_to_files">Granting Users Permissions to Files</h1>
<div class="level1">

<p>
Using POSIX ACLs, it is possible to modify permissions to files (even recursively) such that it is no longer necessary to fiddle with the limited Linux user and group permissions. For example, suppose you wanted to allow a user access to a directory without adding them to a group and then separately modifying all the file permissions to allow that group access. 
</p>

<p>
In that case, you would write:
</p>
<pre class="code bash">setfacl <span class="re5">-R</span> <span class="re5">-m</span> u:bob:rwX Share</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>-R</code> means to recursively change the permissions</div>
</li>
<li class="level1"><div class="li"> <code>-m</code> means modify (and <code>-x</code> means to remove)</div>
</li>
<li class="level1"><div class="li"> <code>u:</code> stands for user (and <code>g:</code> for group)</div>
</li>
<li class="level1"><div class="li"> <code>bob</code> is the user that we want to grant access to</div>
</li>
<li class="level1"><div class="li"> <code>rwX</code> means read (<code>r</code>), write (<code>w</code>) and <code>X</code> (note the capital case) means to only grant execute permissions in case the file already had execute permissions</div>
</li>
<li class="level1"><div class="li"> <code>Share</code> is the directory (or file) to set the permissions on</div>
</li>
</ul>

<p>
The command will thus recursively grant permissions on the file or folder named <code>Share</code> to the user <code>bob</code> allowing <code>bob</code> to read, write and execute the files but only if the file was executable in the first place.
</p>

</div>

<h1 class="sectionedit38" id="change_the_default_text_editor">Change the Default Text Editor</h1>
<div class="level1">

<p>
The following command will let you pick the default editor:
</p>
<pre class="code bash">update-alternatives <span class="re5">--config</span> editor</pre>

</div>

<h1 class="sectionedit39" id="print_all_open_files_sorted_by_number_of_file_handles">Print all Open Files Sorted By Number of File Handles</h1>
<div class="level1">
<pre class="code bash"><span class="kw2">find</span> <span class="sy0">/</span>proc<span class="sy0">/*/</span>fd <span class="re5">-xtype</span> f <span class="re5">-printf</span> <span class="st0">&quot;%l<span class="es1">\n</span>&quot;</span> <span class="sy0">|</span> <span class="kw2">grep</span> <span class="re5">-P</span> <span class="st_h">'^/(?!dev|proc|sys)'</span> <span class="sy0">|</span> <span class="kw2">sort</span> <span class="sy0">|</span> <span class="kw2">uniq</span> <span class="re5">-c</span> <span class="sy0">|</span> <span class="kw2">sort</span> <span class="re5">-n</span></pre>

</div>

<h1 class="sectionedit40" id="reboot_hanging_machine">Reboot Hanging Machine</h1>
<div class="level1">

<p>
In case the machine is hanging and Magic SysRq is enabled in the kernel (enabled by default), then issuing the following combination will reboot the machine more or less gracefully:
</p>

<p>
<kbd class="__keyboard">Alt</kbd>+<kbd class="__keyboard">PrtScrn</kbd>+<kbd class="__keyboard">R</kbd>+<kbd class="__keyboard">S</kbd>+<kbd class="__keyboard">E</kbd>+<kbd class="__keyboard">I</kbd>+<kbd class="__keyboard">U</kbd>+<kbd class="__keyboard">B</kbd>
</p>

<p>
which will perform, in order:
</p>
<ol>
<li class="level1"><div class="li"> <kbd class="__keyboard">R</kbd> give control back to the keyboard</div>
</li>
<li class="level1"><div class="li"> <kbd class="__keyboard">S</kbd> sync</div>
</li>
<li class="level1"><div class="li"> <kbd class="__keyboard">E</kbd> sends all processes but <code>init</code> the <code>TERM</code> signal</div>
</li>
<li class="level1"><div class="li"> <kbd class="__keyboard">I</kbd> sends all processes but the <code>init</code> the <code>KILL</code> signal</div>
</li>
<li class="level1"><div class="li"> <kbd class="__keyboard">U</kbd> mounts all filesystems to read-only to prevent <code>fsck</code> at boot</div>
</li>
<li class="level1"><div class="li"> <kbd class="__keyboard">B</kbd> reboots the system</div>
</li>
</ol>

</div>

<h1 class="sectionedit41" id="check_solid_state_drive_for_trim">Check Solid State Drive for TRIM</h1>
<div class="level1">

<p>
To check whether an attached SSD currently has TRIM enabled, first mount the drive and change directory to the drive:
</p>
<pre class="code bash"><span class="kw3">cd</span> <span class="sy0">/</span>mnt<span class="sy0">/</span>ssd</pre>

<p>
Now create a file:
</p>
<pre class="code bash"><span class="kw2">dd</span> <span class="re2">if</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>urandom <span class="re2">of</span>=<span class="kw2">tempfile</span> <span class="re2">count</span>=<span class="nu0">100</span> <span class="re2">bs</span>=512k <span class="re2">oflag</span>=direct</pre>

<p>
and check the fib-map:
</p>
<pre class="code bash">hdparm <span class="re5">--fibmap</span> <span class="kw2">tempfile</span></pre>

<p>
which will output something like:
</p>
<pre class="code">tempfile:
 filesystem blocksize 4096, begins at LBA 2048; assuming 512 byte sectors.
 byte_offset  begin_LBA    end_LBA    sectors
           0  383099904  383202303     102400</pre>

<p>
Now, note the number under <code>begin_LBA</code> (<code>383099904</code> in this example) and run:
</p>
<pre class="code bash">hdparm <span class="re5">--read-sector</span> <span class="nu0">383099904</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sdc</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>383099904</code> is the number obtained previously</div>
</li>
<li class="level1"><div class="li"> <code>/dev/sdc</code> is the device for the SSD drive</div>
</li>
</ul>

<p>
The last command should output a long string of characters for those sectors.
</p>

<p>
Now, issue:
</p>
<pre class="code bash"><span class="kw2">rm</span> <span class="kw2">tempfile</span>
<span class="kw2">sync</span></pre>

<p>
and repeat the previous <code>hdparm</code> command:
</p>
<pre class="code bash">hdparm <span class="re5">--read-sector</span> <span class="nu0">383099904</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sdc</pre>

<p>
if now the output consists of only zeroes then automatic TRIM is in place otherwise, wait for a while and run the last <code>hdparm</code> again.
</p>

</div>

<h1 class="sectionedit42" id="automatically_mount_filesystems_on_demand">Automatically Mount Filesystems on Demand</h1>
<div class="level1">

<p>
On distributions based on <code>systemd</code>, filesystems can be mounted on demand instead of using <code>/etc/fstab</code> in order to let the main system boot while all the requests to the <code>systemd</code> managed filesystems can buffer-up.
</p>

<p>
Suppose you have a <code>/home</code> partition that you want mounted on demand with <code>systemd</code>. In that case, you can modify the <code>/etc/fstab</code> options to read:
</p>
<pre class="code bash">noauto,x-systemd.automount</pre>

<p>
where <code>noauto</code> prevents Linux from mounting the partition on boot and <code>x-systemd.automount</code> will use <code>systemd</code> to auto-mount the partition on demand.
</p>

<p>
Additionally, the parameter <code>x-systemd.device-timeout=1min</code> can be added to the mount options which will allow for 1 minute before giving up trying to mount the resource which can be useful for network-mounted devices.
</p>

</div>

<h1 class="sectionedit43" id="automatically_reboot_after_kernel_panic">Automatically Reboot after Kernel Panic</h1>
<div class="level1">

<p>
In order to have Linux automatically reboot after a kernel panic, add a setting to sysctl - on Debian systems, you will have to edit the file <code>/etc/sysctl.d/local.conf</code>:
</p>
<pre class="code">kernel.panic = 30
kernel.panic_on_oops = 30</pre>

<p>
which will make the machine restart in <code>30</code> seconds.
</p>

</div>

<h1 class="sectionedit44" id="list_top_memory_consuming_processes">List Top Memory Consuming Processes</h1>
<div class="level1">
<pre class="code bash"><span class="kw2">ps</span> <span class="re5">-eo</span> pmem,pcpu,rss,vsize,args <span class="sy0">|</span> <span class="kw2">sort</span> <span class="re5">-k</span> <span class="nu0">1</span> <span class="re5">-r</span> <span class="sy0">|</span> <span class="kw2">less</span></pre>

</div>

<h1 class="sectionedit45" id="get_the_most_frequently_used_commands">Get the Most Frequently Used Commands</h1>
<div class="level1">

<p>
The following snippet pipes the second field from the <code>history</code> command and counts the number of time it appears:
</p>
<pre class="code bash"><span class="kw3">history</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{ a[$2]++ } END { for(i in a) { print a[i] &quot; &quot; i } }'</span> <span class="sy0">|</span> <span class="kw2">sort</span> <span class="re5">-urn</span> <span class="sy0">|</span> <span class="kw2">head</span> <span class="re5">-n</span> <span class="nu0">20</span></pre>

<p>
which then gets sorted and the top most <code>20</code> results are displayed.
</p>

</div>

<h1 class="sectionedit46" id="force_a_filesystem_check_on_reboot">Force a Filesystem Check on Reboot</h1>
<div class="level1">

<p>
You can add: <code>fsck.mode=force</code> and <code>fsck.repair=preen</code> to the grub parameter line on reboot in order to trigger a filesystem recheck. Alternatively, if you feel bold, you can add <code>fsck.repair=yes</code> instead of <code>fsck.repair=preen</code> in order to have Linux automatically fix the errors. This is especially useful to recover from a damaged root filesystem.
</p>

</div>

<h1 class="sectionedit47" id="enable_multi-queue_block_io_queuing_mechanism">Enable Multi-Queue Block IO Queuing Mechanism</h1>
<div class="level1">

<p>
Edit <code>/etc/default/grub</code> and add:
</p>
<pre class="code">scsi_mod.use_blk_mq=1</pre>

<p>
to the kernel command line parameters.
</p>

</div>

<h1 class="sectionedit48" id="export_linux_passwords">Export Linux Passwords</h1>
<div class="level1">

<p>
This helper script can be useful in case you wish to export a bunch of &quot;real&quot; users by scanning the home directory and extracting only users that have a folder inside that directory.
</p>
<dl class="file">
<dt><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_export/code/fuss/linux?codeblock=74" title="Download Snippet" class="mediafile mf_sh">exportusers.sh</a></dt>
<dd><pre class="code file bash"><span class="co0">###########################################################################</span>
<span class="co0">##  Copyright (C) Wizardry and Steamworks 2016 - License: GNU GPLv3      ##</span>
<span class="co0">###########################################################################</span>
<span class="re2">HOMES</span>=<span class="st0">&quot;/home&quot;</span>
<span class="re2">FILES</span>=<span class="st0">&quot;/etc/passwd /etc/passwd- /etc/shadow /etc/shadow-&quot;</span>
&nbsp;
<span class="kw2">ls</span> <span class="re5">-l</span> <span class="re1">$HOMES</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{ print $3 }'</span> <span class="sy0">|</span> <span class="kw2">sort</span> <span class="re5">-u</span> <span class="sy0">|</span> <span class="kw1">while</span> <span class="kw3">read</span> u; <span class="kw1">do</span>
    <span class="kw1">for</span> <span class="kw2">file</span> <span class="kw1">in</span> <span class="re1">$FILES</span>; <span class="kw1">do</span> 
        <span class="kw2">cat</span> <span class="re1">$file</span> <span class="sy0">|</span> <span class="kw1">while</span> <span class="kw3">read</span> p; <span class="kw1">do</span>
            <span class="re2">ENTRY</span>=<span class="sy0">`</span><span class="kw3">echo</span> <span class="re1">$p</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="re5">-F</span><span class="st_h">':'</span> <span class="st_h">'{ print $1 }'</span><span class="sy0">`</span>
            <span class="kw1">if</span> <span class="br0">&#91;</span> <span class="st0">&quot;<span class="es2">$ENTRY</span>&quot;</span> == <span class="st0">&quot;<span class="es2">$u</span>&quot;</span> <span class="br0">&#93;</span>; <span class="kw1">then</span>
	        <span class="kw3">echo</span> <span class="re1">$p</span> <span class="sy0">&gt;&gt;</span> <span class="sy0">`</span><span class="kw2">basename</span> <span class="re1">$file</span><span class="sy0">`</span>
            <span class="kw1">fi</span>
        <span class="kw1">done</span>
    <span class="kw1">done</span>
<span class="kw1">done</span></pre>
</dd></dl>

<p>
When the script runs, it will scan all folders under the <code>/home</code> directory, grab the users that the folders belong to and scan the Linux password files (<code>/etc/passwd</code>, <code>/etc/passwd-</code>, <code>/etc/shadow</code> and <code>/etc/shadow-</code>) for entries for that user. It will then generate Linux password files from the matching home directories that can be later inserted into the Linux password files of a different machine.
</p>

</div>

<h1 class="sectionedit49" id="create_sparse_image_of_device">Create Sparse Image of Device</h1>
<div class="level1">

<p>
<code>dd</code> dumps an entire device but has no options that are aware of the number of zeroes on the device. The following command:
</p>
<pre class="code bash"><span class="kw2">dd</span> <span class="re2">if</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>sda <span class="sy0">|</span> <span class="kw2">cp</span> <span class="re5">--sparse</span>=always <span class="sy0">/</span>dev<span class="sy0">/</span>stdin image.img</pre>

<p>
will create an image named <code>image.img</code> of the device <code>/dev/sda</code> such that the image file will not contain any zeroes.
</p>

<p>
To check that the image was created successfully, you can then issue:
</p>
<pre class="code bash">md5sum image.img</pre>

<p>
and
</p>
<pre class="code bash">md5sum <span class="sy0">/</span>dev<span class="sy0">/</span>sda</pre>

<p>
and check that the hashes are identical.
</p>

</div>

<h1 class="sectionedit50" id="bind_to_reserved_ports_as_non-root_user">Bind to Reserved Ports as Non-Root User</h1>
<div class="level1">

<p>
Binding to reserved ports (ports under <code>1024</code>) can be done under Linux by issuing:
</p>
<pre class="code bash">setcap <span class="st_h">'cap_net_bind_service=+ep'</span> <span class="sy0">/</span>path<span class="sy0">/</span>to<span class="sy0">/</span>binary</pre>

</div>

<h1 class="sectionedit51" id="mount_apple_images">Mount Apple Images</h1>
<div class="level1">

<p>
DMG files are usually compressed; in fact, if you issue in a terminal:
</p>
<pre class="code bash"><span class="kw2">file</span> someimage.dmg</pre>

<p>
you may get output such as:
</p>
<pre class="code">someimage.dmg: bzip2 compressed data, block size = 100k</pre>

<p>
indicating a bzip2 compressed file, or:
</p>
<pre class="code">someimage.dmg: zlib compressed data</pre>

<p>
You can then uncompress the DMG image under Linux by issing:
</p>
<pre class="code bash">bzip <span class="re5">-dc</span> someimage.dmg <span class="sy0">&gt;</span> someimage.dmg.uncompressed</pre>

<p>
Now, if you inspect the uncompressed image (in this example <code>someimage.dmg.uncompressed</code>):
</p>
<pre class="code bash"><span class="kw2">file</span> someimage.dmg.uncompressed</pre>

<p>
you will get some interesting info such as:
</p>
<pre class="code bash">someimage.dmg.uncompressed: Apple Driver Map, blocksize <span class="nu0">512</span>, blockcount <span class="nu0">821112</span>, devtype <span class="nu0">0</span>, devid <span class="nu0">0</span>, descriptors <span class="nu0">0</span>, contains<span class="br0">&#91;</span><span class="sy0">@</span>0x200<span class="br0">&#93;</span>: Apple Partition Map, map block count <span class="nu0">3</span>, start block <span class="nu0">1</span>, block count <span class="nu0">63</span>, name Apple, <span class="kw3">type</span> Apple_partition_map, contains<span class="br0">&#91;</span><span class="sy0">@</span>0x400<span class="br0">&#93;</span>: Apple Partition Map, map block count <span class="nu0">3</span>, start block <span class="nu0">64</span>, block count <span class="nu0">861104</span>, name disk image, <span class="kw3">type</span> Apple_HFS, contains<span class="br0">&#91;</span><span class="sy0">@</span>0x600<span class="br0">&#93;</span>: Apple Partition Map, map block count <span class="nu0">3</span>, start block <span class="nu0">811148</span>, block count <span class="nu0">4</span>, <span class="kw3">type</span> Apple_Free</pre>

<p>
indicating an uncompressed image.
</p>

<p>
To convert the DMG into an image that can be mounted, you can use the tool<code>dmg2img</code>:
</p>
<pre class="code bash">dmg2img someimage.dmg someimage.dmg.uncompressed</pre>

<p>
You can now mount the image using the HFS+ filesystem:
</p>
<pre class="code bash"><span class="kw2">mount</span> <span class="re5">-t</span> hfsplus <span class="re5">-o</span> ro someimage.dmg.uncompressed <span class="sy0">/</span>mnt<span class="sy0">/</span>media</pre>

</div>

<h1 class="sectionedit52" id="purge_all_e-mails_from_command-line">Purge all E-Mails from Command-Line</h1>
<div class="level1">

<p>
To purge all inbox e-mails on Linux from the command line, you can use the <code>mail</code> command with the following sequence of instructions:
</p>
<pre class="code">d *
q</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>mail</code> is the mail reader program, </div>
</li>
<li class="level1"><div class="li"> <code>d *</code> instructs <code>mail</code> to delete all messages,</div>
</li>
<li class="level1"><div class="li"> <code>q</code> tells <code>mail</code> to quit</div>
</li>
</ul>

</div>

<h1 class="sectionedit53" id="remount_root_filesystem_as_read-write">Remount Root Filesystem as Read-Write</h1>
<div class="level1">

<p>
There are cases where a Linux system boots with the root <code>/</code> mounted as read-only. This can occur for various reasons but the standard way of recovering is to issue:
</p>
<pre class="code bash"><span class="kw2">mount</span> <span class="re5">-o</span> remount,rw <span class="sy0">/</span></pre>

<p>
which should mount the root filesystem in read-write mode.
</p>

<p>
However, assuming that you have bad options in <code>/etc/fstab</code>, that will not work and you will get errors in <code>dmesg</code> along the lines of:
</p>
<pre class="code">Unrecognized mount option ... or missing value</pre>

<p>
this is due to <code>mount</code> reading <code>/etc/fstab</code> when you do not specify the source and the target. To work around the problem, you can mount the root manually by specifying both:
</p>
<pre class="code bash"><span class="kw2">mount</span> <span class="re5">-t</span> ext4 <span class="sy0">/</span>dev<span class="sy0">/</span>vda1 <span class="sy0">/</span> <span class="re5">-o</span> remount,rw</pre>

<p>
which should give you enough leverage to adjust the entries in your <code>/etc/fstab</code> file.
</p>

</div>

<h1 class="sectionedit54" id="enable_metadata_checksumming_on_ext4">Enable Metadata Checksumming on EXT4</h1>
<div class="level1">

<p>
Metadata checksumming provides better data safety protection - you will need e2fsprogs version <code>1.43</code> or beyond. On Debian you can check your current e2fsprogs with <code>apt-cache policy e2fsprogs</code> and upgrade to <code>unstable</code> or <code>testing</code> if needed.
</p>

<p>
On new systems, to enable metadata checksumming at format time, you would issue:
</p>
<pre class="code bash">mkfs.ext4 <span class="re5">-O</span> metadata_csum <span class="sy0">/</span>dev<span class="sy0">/</span>sda1</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>/dev/sda1</code> is the path to the device to be formatted as EXT4</div>
</li>
</ul>

<p>
On existing systems, the filesystem must be unmounted first (using a LiveCD, for instance). With the filesystem unmounted and assuming that <code>/dev/sda1</code> contains the EXT4 filesystem for which metadata checksumming is to be enabled, issue:
</p>
<pre class="code bash">e2fsck <span class="re5">-Df</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sda1</pre>

<p>
in order to optimise the filesystem; followed by:
</p>
<pre class="code bash">resize2fs <span class="re5">-b</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sda1</pre>

<p>
to convert the filesystem to 64bit and finally:
</p>
<pre class="code bash">tune2fs <span class="re5">-O</span> metadata_csum <span class="sy0">/</span>dev<span class="sy0">/</span>sda1</pre>

<p>
to enable metadata checksumming.
</p>

<p>
If you want, you can see the result by issuing:
</p>
<pre class="code bash">dumpe2fs <span class="re5">-h</span> <span class="sy0">/</span>dev<span class="sy0">/</span>sda1</pre>

<p>
Now that metadata checksumming is enabled, you may have some performance gain by adding the a module to initrd called <code>crypto-crc32c</code> that will enable hardware acceleration for the CRC routines. On Debian, adding the <code>crypto-crc32c</code> module to initrd is a matter of <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/debian#add_modules_to_initd" class="wikilink1" title="fuss:debian" data-wiki-id="fuss:debian">editing a file and rebuilding the initramfs</a>.
</p>

</div>

<h1 class="sectionedit55" id="get_a_list_of_imap_users_from_logs">Get a List of IMAP Users from Logs</h1>
<div class="level1">

<p>
The following command will read in <code>/var/log/mail.log</code> and compile a list of unique IMAP users.
</p>
<pre class="code bash"><span class="kw2">cat</span> <span class="sy0">/</span>var<span class="sy0">/</span>log<span class="sy0">/</span>mail.log <span class="sy0">|</span> \
  <span class="kw2">grep</span> imap-login:\ Login <span class="sy0">|</span> \
  <span class="kw2">sed</span> <span class="re5">-e</span> <span class="st_h">'s/.*Login: user=&lt;\(.*\)&gt;, method=.*/\1/g'</span> <span class="sy0">|</span> <span class="kw2">sort</span> <span class="sy0">|</span> <span class="kw2">uniq</span></pre>

</div>

<h1 class="sectionedit56" id="disable_console_blanking">Disable Console Blanking</h1>
<div class="level1">

<p>
To disable the linux console blanking (turning off), the following methods can be mentioned:
</p>
<ul>
<li class="level1"><div class="li"> append <code>consoleblank=0</code> to the linux kernel parameters (ie: edit <code>/etc/default/grub</code> on Debian),</div>
</li>
<li class="level1"><div class="li"> issue <code>setterm -blank 0 -powerdown 0</code> on the console to turn off blanking on,</div>
</li>
<li class="level1"><div class="li"> issue <code>echo -ne &quot;\033[9;0]&quot; &gt;/dev/ttyX</code>; where <code>X</code> is the console number to turn off blanking for,</div>
</li>
<li class="level1"><div class="li"> issue <code>echo -ne &quot;\033[9;0]&quot; &gt;/etc/issue</code> to turn off blanking (<code>/etc/issue</code> is loaded on console boot).</div>
</li>
</ul>

<p>
Note that <code>setterm -blank 0</code> and <code>echo -ne &quot;\033[9;0]&quot;</code> are equivalent such that you can redirect both their output to a <code>tty</code> device.
</p>

</div>

<h1 class="sectionedit57" id="manipulating_linux_console">Manipulating Linux Console</h1>
<div class="level1">

<p>
Most console-oriented commands that are meant to work on virtual terminals expect a proper terminal to be set up and to be executed on a virtual terminal. The <code>openvt</code> command can be used to execute a program on the Linux virtual terminal. For instance, to force the screen to blank whilst being logged-in via an SSH session (<code>/dev/pts</code>), issue:
</p>
<pre class="code bash"><span class="re2">TERM</span>=linux <span class="kw2">openvt</span> <span class="re5">-c</span> <span class="nu0">1</span> <span class="re5">-f</span> <span class="re5">--</span> <span class="kw2">setterm</span> <span class="re5">-blank</span> force</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>TERM=linux</code> sets the terminal type to <code>linux</code> otherwise the terminal type of the terminal used for the SSH session is going to be assumed,</div>
</li>
<li class="level1 node"><div class="li"> <code>openvt</code> makes the command run on a virtual terminal,</div>
<ul>
<li class="level2"><div class="li"> <code>1</code> refers to <code>/dev/tty1</code>,</div>
</li>
<li class="level2"><div class="li"> <code>-f</code> forces the command to run even if the virtual terminal is occupied (this is by default the case for login terminals),</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <code>--</code> is the separator between <code>openvt</code> parameters and the command to be executed,</div>
</li>
<li class="level1"><div class="li"> <code>setterm</code> is the command to execute and,</div>
</li>
<li class="level1"><div class="li"> <code>-blank force</code> instructs the terminal to blank.</div>
</li>
</ul>

</div>

<h1 class="sectionedit58" id="resetting_usb_device_from_command_line">Resetting USB Device from Command Line</h1>
<div class="level1">

<p>
<a href="http://www.usb.org/developers/wusb/" class="urlextern" title="http://www.usb.org/developers/wusb/" rel="ugc nofollow">Wireless USB</a>, by consequence, has brought to Linux the capability of simulating an USB disconnect and reconnect - this is particularly useful if the device is connected on the inside of the machine such that the device cannot be removed (even logically) because it cannot be replugged.
</p>

<p>
The first step is to identify the device you want to reset by issuing:
</p>
<pre class="code bash">lsusb</pre>

<p>
and checking the column with the device ID. For instance, you would want to reset the device:
</p>
<pre class="code">Bus 001 Device 007: ID 05b7:11aa Canon, Inc. </pre>

<p>
such that the relevant bit to retain is the vendor ID <code>05b7</code> and the product id <code>11aa</code>.
</p>

<p>
Next, locate the device on the USB HUB by issuing:
</p>
<pre class="code bash"><span class="kw2">find</span> <span class="re5">-L</span> <span class="sy0">/</span>sys<span class="sy0">/</span>bus<span class="sy0">/</span>usb<span class="sy0">/</span>devices<span class="sy0">/</span> <span class="re5">-maxdepth</span> <span class="nu0">2</span> <span class="re5">-name</span> <span class="kw2">id</span><span class="sy0">*</span> <span class="re5">-print</span> <span class="re5">-exec</span> <span class="kw2">cat</span> <span class="st_h">'{}'</span> \; <span class="sy0">|</span> <span class="kw2">xargs</span> <span class="re5">-L</span> <span class="nu0">4</span></pre>

<p>
and then locate the <code>/sys</code> path to the device you would like to reset. In this case, the line matching the vendor and product ID would be:
</p>
<pre class="code">/sys/bus/usb/devices/1-8/idProduct 11aa /sys/bus/usb/devices/1-8/idVendor 05b7</pre>

<p>
Finally deauthorize the device by issuing:
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="nu0">0</span> <span class="sy0">&gt;/</span>sys<span class="sy0">/</span>bus<span class="sy0">/</span>usb<span class="sy0">/</span>devices<span class="sy0">/</span><span class="nu0">1</span>-<span class="nu0">8</span><span class="sy0">/</span>authorized</pre>

<p>
and re-authorize the device by issuing:
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="nu0">1</span> <span class="sy0">&gt;/</span>sys<span class="sy0">/</span>bus<span class="sy0">/</span>usb<span class="sy0">/</span>devices<span class="sy0">/</span><span class="nu0">1</span>-<span class="nu0">8</span><span class="sy0">/</span>authorized</pre>

<p>
The above is sufficient to trigger and udev hotplug event - in case you are debugging udev scripts.
</p>

</div>

<h1 class="sectionedit59" id="set_cpu_governor_for_all_cpus">Set CPU Governor for all CPUs</h1>
<div class="level1">

<p>
The following command will set the CPU governor to <code>powersave</code> for all CPUs installed in the system:
</p>
<pre class="code bash"><span class="kw1">for</span> i <span class="kw1">in</span> <span class="sy0">`</span><span class="kw2">find</span> <span class="sy0">/</span>sys<span class="sy0">/</span>devices<span class="sy0">/</span>system<span class="sy0">/</span>cpu<span class="sy0">/</span>cpu<span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="sy0">*</span> <span class="re5">-type</span> d <span class="sy0">|</span> <span class="kw2">awk</span> <span class="re5">-F</span><span class="st_h">'/'</span> <span class="st_h">'{ print $6 }'</span> <span class="sy0">|</span> <span class="kw2">sort</span> <span class="re5">-g</span> -k1.4,<span class="nu0">1</span> <span class="re5">-u</span> <span class="sy0">|</span> <span class="kw2">cut</span> <span class="re5">-c</span> <span class="nu0">4</span>-<span class="sy0">`</span>; <span class="kw1">do</span> cpufreq-set <span class="re5">-c</span> <span class="re1">$i</span> <span class="re5">-g</span> powersave; <span class="kw1">done</span></pre>

</div>

<h1 class="sectionedit60" id="enable_persistent_journal_logging">Enable Persistent Journal Logging</h1>
<div class="level1">

<p>
From man (8) <code>systemd-journald</code>:
</p>
<pre class="code bash"><span class="kw2">mkdir</span> <span class="re5">-p</span> <span class="sy0">/</span>var<span class="sy0">/</span>log<span class="sy0">/</span>journal
systemd-tmpfiles <span class="re5">--create</span> <span class="re5">--prefix</span> <span class="sy0">/</span>var<span class="sy0">/</span>log<span class="sy0">/</span>journal</pre>

</div>

<h1 class="sectionedit61" id="home_folder_permissions">Home Folder Permissions</h1>
<div class="level1">
<ul>
<li class="level1"><div class="li"> <code>711</code> if you dont want to add groups as well or</div>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> <code>751</code> so that public can&#039;t read your home directory</div>
</li>
</ul>

</div>

<h1 class="sectionedit62" id="correctetchosts_setup">Correct /etc/hosts Setup</h1>
<div class="level1">

<p>
In the event that Linux decides to answer with an IPv6 address when pinging <code>localhost</code>, for example:
</p>
<pre class="code">PING localhost(localhost (::1)) 56 data bytes
64 bytes from localhost (::1): icmp_seq=1 ttl=64 time=0.226 ms
64 bytes from localhost (::1): icmp_seq=2 ttl=64 time=0.291 ms
64 bytes from localhost (::1): icmp_seq=3 ttl=64 time=0.355 ms
64 bytes from localhost (::1): icmp_seq=4 ttl=64 time=0.353 ms</pre>

<p>
then the issue is an incorrect setup of <code>/etc/hosts</code> - notably, the IPv6 addresses are not setup correctly and Linux answers with the IPv6 equivalent address of <code>localhost</code>.
</p>

<p>
Open <code>/etc/hosts</code> and modify the IPv6 section to contain the following:
</p>
<pre class="code"># The following lines are desirable for IPv6 capable hosts
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts</pre>

<p>
and all services should start working properly again.
</p>

</div>

<h1 class="sectionedit63" id="disk_dump_with_progress">Disk Dump with Progress</h1>
<div class="level1">

<p>
On newer Linux systems, the command:
</p>
<pre class="code bash"><span class="kw2">dd</span> <span class="re2">if</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>xxx <span class="re2">of</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>yyy <span class="re2">bs</span>=8M <span class="re2">status</span>=progress</pre>

<p>
will display progress status whilst copying. Unfortunately, that does not include a convenient progress bar to check for completion.
</p>

<p>
Alternatively, the corresponding command:
</p>
<pre class="code bash">pv <span class="re5">-tpreb</span> <span class="sy0">/</span>dev<span class="sy0">/</span>xxx <span class="sy0">|</span> <span class="kw2">dd</span> <span class="re2">of</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>yyy <span class="re2">bs</span>=8M</pre>

<p>
will use <code>pv</code> and display a progress bar.
</p>

</div>

<h1 class="sectionedit64" id="disable_spectre_and_meltdown_patches">Disable Spectre and Meltdown Patches</h1>
<div class="level1">

<p>
Add to the command line in <code>/etc/default/grub</code>, the kernel parameters:
</p>
<pre class="code">nopti kpti=0 noibrs noibpb l1tf=off mds=off nospectre_v1 nospectre_v2 spectre_v2_user=off spec_store_bypass_disable=off nospec_store_bypass_disable ssbd=force-off no_stf_barrier tsx_async_abort=off nx_huge_pages=off kvm.nx_huge_pages=off kvm-intel.vmentry_l1d_flush=never mitigations=off</pre>

<p>
and execute:
</p>
<pre class="code bash">update-grub</pre>

<p>
After a reboot, the patches should be disabled and the performance will be back!
</p>

</div>

<h1 class="sectionedit65" id="allow_binding_privileged_ports">Allow Binding Privileged Ports</h1>
<div class="level1">
<pre class="code bash">setcap <span class="st_h">'cap_net_bind_service=+ep'</span> <span class="sy0">/</span>path<span class="sy0">/</span>to<span class="sy0">/</span>program</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>program</code> is an _executable_ - not a script.</div>
</li>
</ul>

</div>

<h1 class="sectionedit66" id="determining_the_last_power_on_method">Determining the Last Power On Method</h1>
<div class="level1">

<p>
<code>dmidecode</code> can be used to retrieve BIOS information and, amongst which, can also tell what the last power on method has been:
</p>
<pre class="code bash">dmidecode <span class="re5">-t</span> system <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st_h">'Wake-Up Type'</span></pre>

<p>
will print the last wake-up type.
</p>

</div>

<h1 class="sectionedit67" id="issues_with_stuck_cores">Issues with Stuck Cores</h1>
<div class="level1">

<p>
It may happen that logs fill up with messages indicating that some power management policy cannot be enforced on a given CPU core:
</p>
<pre class="code">cpufreqd: cpufreqd_loop            : Cannot set policy, Rule unchanged (&quot;none&quot;).
cpufreqd: cpufreqd_set_profile     : Couldn&#039;t set profile &quot;Performance High&quot; set for cpu4 (100-100-performance)</pre>

<p>
It may be that the CPU core is simply stuck and may need replugging. The following two commands will take the CPU offline and the next one will start the CPU back up:
</p>
<pre class="code bash"><span class="kw3">echo</span> <span class="st0">&quot;0&quot;</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>sys<span class="sy0">/</span>devices<span class="sy0">/</span>system<span class="sy0">/</span>cpu<span class="sy0">/</span>cpu4<span class="sy0">/</span>cpufreq<span class="sy0">/</span>online
<span class="kw3">echo</span> <span class="st0">&quot;1&quot;</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>sys<span class="sy0">/</span>devices<span class="sy0">/</span>system<span class="sy0">/</span>cpu<span class="sy0">/</span>cpu4<span class="sy0">/</span>cpufreq<span class="sy0">/</span>online</pre>

<p>
In doing so, the power management issue seems to be resolved.
</p>

</div>

<h1 class="sectionedit68" id="automatically_add_all_rndis_devices_to_a_bridge">Automatically Add all RNDIS Devices to a Bridge</h1>
<div class="level1">

<p>
Edit or create the file at <code>/etc/udev/rules.d/70-persistent-net.rules</code> with the following contents:
</p>
<pre class="code">SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, ATTRS{idProduct}==&quot;a4a2&quot;, ATTRS{idVendor}==&quot;0525&quot;, RUN+=&quot;/bin/sh -c &#039;/sbin/ip link set dev %k up &amp;&amp; /sbin/brctl addif br0 %k&#039;&quot;</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>br0</code> is the interface name of the bridge that the RNDIS devices will be added to.</div>
</li>
</ul>

<p>
followed by the command:
</p>
<pre class="code bash">udevadm control <span class="re5">--reload</span></pre>

<p>
to reload all udev rules.
</p>

<p>
The reason this works is due to <code>a4a2</code> and <code>0525</code> respectively being the identifiers for the RNDIS driver and not for the device itself. For instance, by issuing:
</p>
<pre class="code bash">udevadm info <span class="re5">-a</span> <span class="sy0">/</span>sys<span class="sy0">/</span>class<span class="sy0">/</span>net<span class="sy0">/</span>usb0</pre>

<p>
will show at the top the RNDIS device without any identifiers whereas the parent <code>RNDIS/Ethernet Gadget</code> matches the identifiers.
</p>

<p>
One usage case for this rule is to connect a bunch of RNDIS devices to an USB hub and have them join the network automatically as they are hotplugged; for instance, Raspberry Pis <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/raspberry_pi#logging-in_via_ssh_over_usb" class="wikilink1" title="fuss:raspberry_pi" data-wiki-id="fuss:raspberry_pi">can be configured as USB gadgets</a> and then connected to an USB hub.
</p>

</div>

<h1 class="sectionedit69" id="scraping_a_site_automatically_using_systemd">Scraping a Site Automatically using SystemD</h1>
<div class="level1">

<p>
FTP sites can be scraped elegantly by using systemd and tmux on Linux. By starting a <code>tmux</code> detached terminal, <code>wget</code> can run in the background and download a website entirely whilst also allowing the user to check up on the progress by manually attaching and detaching from <code>tmux</code>.
</p>

<p>
The following script contains a few parameters underneath the <code>Configuration</code> comment and up to <code>Internals</code> in order to set:
</p>
<ul>
<li class="level1"><div class="li"> the download path (<code>DOWNLOAD_DIRECTORY</code>),</div>
</li>
<li class="level1"><div class="li"> the <code>wget</code> download URL (all protocols supported by <code>wget</code> such as FTP or HTTP) (<code>DOWNLOAD_URL</code>),</div>
</li>
<li class="level1"><div class="li"> a descriptive name for the <code>tmux</code> session (<code>TMUX_SESSION_NAME</code>)</div>
</li>
</ul>
<pre class="code bash"><span class="br0">&#91;</span>Unit<span class="br0">&#93;</span>
<span class="re2">Description</span>=Scrape FTP Site
<span class="re2">Requires</span>=network.target local-fs.target remote-fs.target
<span class="re2">After</span>=network.target local-fs.target remote-fs.target
&nbsp;
<span class="br0">&#91;</span>Install<span class="br0">&#93;</span>
<span class="re2">WantedBy</span>=multi-user.target
&nbsp;
<span class="br0">&#91;</span>Service<span class="br0">&#93;</span>
<span class="co0"># Configuration</span>
<span class="re2">Environment</span>=<span class="re2">DOWNLOAD_DIRECTORY</span>=<span class="st0">&quot;/path/to/directory&quot;</span>
<span class="re2">Environment</span>=<span class="re2">DOWNLOAD_URL</span>=<span class="st0">&quot;ftp://somesite.tld/somedirectory&quot;</span>
<span class="re2">Environment</span>=<span class="re2">TMUX_SESSION_NAME</span>=<span class="st0">&quot;somesite.tld-download&quot;</span>
<span class="co0"># Internals</span>
<span class="re2">Type</span>=oneshot
<span class="re2">KillMode</span>=none
<span class="re2">User</span>=root
ExecStartPre = -<span class="sy0">/</span>bin<span class="sy0">/</span><span class="kw2">mkdir</span> <span class="re5">-p</span> <span class="co3">\&quot;</span><span class="st0">&quot;<span class="es2">$DOWNLOAD_DIRECTORY</span>&quot;</span><span class="co3">\&quot;</span>
<span class="re2">ExecStart</span>=<span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>tmux new-session <span class="re5">-d</span> <span class="re5">-c</span> <span class="st0">&quot;<span class="es1">\&quot;</span><span class="es2">$DOWNLOAD_DIRECTORY</span><span class="es1">\&quot;</span>&quot;</span> <span class="re5">-s</span> <span class="st0">&quot;<span class="es2">$TMUX_SESSION_NAME</span>&quot;</span> <span class="re5">-n</span> <span class="st0">&quot;<span class="es2">$TMUX_SESSION_NAME</span>&quot;</span> <span class="st0">&quot;/usr/bin/wget -c -r <span class="es1">\&quot;</span><span class="es2">$DOWNLOAD_URL</span><span class="es1">\&quot;</span> -P <span class="es1">\&quot;</span><span class="es2">$DOWNLOAD_DIRECTORY</span><span class="es1">\&quot;</span>&quot;</span>
<span class="re2">ExecStop</span>=<span class="sy0">/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span>tmux send-keys <span class="re5">-t</span> <span class="st0">&quot;<span class="es2">$TMUX_SESSION_NAME</span>&quot;</span> C-c
<span class="re2">RemainAfterExit</span>=<span class="kw2">yes</span></pre>

<p>
The file should be placed under <code>/etc/systemd/system</code>, then systemd has to be reloaded by issuing <code>systemctl daemon-reload</code>, the service should then be loaded with <code>systemctl enable SERVICE_FILE_NAME</code> where <code>SERVICE_FILE_NAME</code> is the name of the file copied into <code>/etc/systemd/system</code> and finally started by issuing <code>systemctl start SERVICE_FILE_NAME</code>.
</p>

<p>
Upon every reboot, the service file will create a detached tmux terminal and start scraping files from the URL.
</p>

</div>

<h1 class="sectionedit70" id="access_directory_underneath_mountpoint">Access Directory Underneath Mountpoint</h1>
<div class="level1">

<p>
In order to access a directory underneath a mountpoint without unmounting, create a bind mount of the root filesystem to a directory and then access the content via the bind mount.
</p>

<p>
Ie, to access the contents of the directory <code>/mnt/usb</code> on top of which a filesystem has been mounted, create a directory:
</p>
<pre class="code bash"><span class="kw2">mkdir</span> <span class="sy0">/</span>mnt<span class="sy0">/</span>root</pre>

<p>
and create a bind mount:
</p>
<pre class="code bash"><span class="kw2">mount</span> <span class="re5">-o</span> <span class="kw3">bind</span> <span class="sy0">/</span> <span class="sy0">/</span>mnt<span class="sy0">/</span>root</pre>

<p>
Finally access the original underlying content via the path <code>/mnt/root/mnt/usb2</code>.
</p>

</div>

<h1 class="sectionedit71" id="self-delete_shell_script">Self-Delete Shell Script</h1>
<div class="level1">
<pre class="code">rm -rf -- &quot;$@&quot;</pre>

</div>

<h1 class="sectionedit72" id="resize_last_partition_and_filesystem_in_image_file">Resize Last Partition and Filesystem in Image File</h1>
<div class="level1">

<p>
Assuming that an image file is available and named, for example, <code>raspios.img</code> then the following procedure will extend the last partition and the filesystem by a given size.
</p>

<p>
First, extend the image file <code>raspios.img</code> itself with zeroes:
</p>
<pre class="code bash"><span class="kw2">dd</span> <span class="re2">if</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>zero <span class="re2">bs</span>=1M <span class="re2">count</span>=<span class="nu0">500</span> <span class="sy0">&gt;&gt;</span> raspios.img</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>1M</code> is the block size,</div>
</li>
<li class="level1"><div class="li"> <code>500</code> is the amount of blocks to copy over</div>
</li>
</ul>

<p>
In this case, the image file <code>raspios.img</code> is extended by <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/imgbc91e6cc157fbb03930170d28a51c4c2.png" class="latex_inline" alt="$500MiB$" title="Math" />. Alternatively, <code>qemu-img</code> can be used to extend the image file:
</p>
<pre class="code bash">qemu-img resize raspios.img +500M</pre>

<p>
The next step is to run <code>parted</code> and extend the last partition inside the image file. Open the image file with <code>parted</code>:
</p>
<pre class="code bash">parted raspios.img</pre>

<p>
and then resize the partition, for example:
</p>
<pre class="code bash"><span class="br0">&#40;</span>parted<span class="br0">&#41;</span> resizepart <span class="nu0">2</span> <span class="nu0">100</span><span class="sy0">%</span></pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>2</code> is the partition number</div>
</li>
</ul>

<p>
The <code>parted</code> command will resize the second partition to fill 100% of the available space (in this example, it will extend the second partition by <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/imgbc91e6cc157fbb03930170d28a51c4c2.png" class="latex_inline" alt="$500MiB$" title="Math" />).
</p>

<p>
The final step is to enlarge the filesystem within the second partition that has just been extended by <img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/fetch.php?media=wiki:latex:/imgbc91e6cc157fbb03930170d28a51c4c2.png" class="latex_inline" alt="$500MiB$" title="Math" />. <code>kpartx</code> will create mapped devices for each of the partitions contained within the <code>raspios.img</code> image file:
</p>
<pre class="code bash">kpartx <span class="re5">-avs</span> raspios.img</pre>

<p>
First, the existing filesystem has to be checked:
</p>
<pre class="code bash">e2fsck <span class="re5">-f</span> <span class="sy0">/</span>dev<span class="sy0">/</span>mapper<span class="sy0">/</span>loop0p2</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>/dev/mapper/loop0p2</code> is the last partition reported by <code>kpartx</code></div>
</li>
</ul>

<p>
and then finally the filesystem is extended to its maximum size:
</p>
<pre class="code bash">resize2fs <span class="sy0">/</span>dev<span class="sy0">/</span>mapper<span class="sy0">/</span>loop0p2</pre>

</div>

<h1 class="sectionedit73" id="delete_files_older_than_x_days">Delete Files Older than X Days</h1>
<div class="level1">
<pre class="code bash"><span class="kw2">find</span> <span class="sy0">/</span>path <span class="re5">-mtime</span> +N <span class="re5">-delete</span></pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>N</code> is the number of days</div>
</li>
</ul>

</div>

<h1 class="sectionedit74" id="elusive_errors_from_crontab">Elusive Errors from Crontab</h1>
<div class="level1">

<p>
Sometimes the error:
</p>
<pre class="code bash"><span class="sy0">/</span>bin<span class="sy0">/</span>sh: <span class="nu0">1</span>: root: not found</pre>

<p>
might be reported by cron.
</p>

<p>
The reason might be that an user ran <code>crontab /etc/crontab</code> in which case separate crontabs would have been created at <code>/var/spool/cron/crontabs/</code>. To remedy the situation, simply delete <code>/var/spool/cron/crontabs/</code> and reload the cron daemon.
</p>

</div>

<h1 class="sectionedit75" id="clear_framebuffer_device">Clear Framebuffer Device</h1>
<div class="level1">

<p>
The following command will clear a <code>1024x768</code> resolution Linux framebuffer:
</p>
<pre class="code bash"><span class="kw2">dd</span> <span class="re2">if</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>zero <span class="re2">count</span>=$<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="nu0">1024</span> <span class="sy0">*</span> <span class="nu0">768</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="re2">bs</span>=<span class="nu0">1024</span> <span class="sy0">&gt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>fb0</pre>

</div>

<h1 class="sectionedit76" id="adding_mount_point_dependencies_to_systemd_service_files">Adding Mount Point Dependencies to SystemD Service Files</h1>
<div class="level1">

<p>
To get a list of filesystems that are configured (ie: via <code>/etc/fstab</code>), issue:
</p>
<pre class="code bash">systemctl list-units <span class="sy0">|</span> <span class="kw2">grep</span> <span class="st_h">'/path/to/mount'</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{ print $1 }'</span></pre>

<p>
The command will return a list of mount units all ending in <code>.mount</code>.
</p>

<p>
Edit the SystemD service file in <code>/etc/systemd/system/</code> and add:
</p>
<pre class="code">After=... FS.MOUNT
Requires=... FS.MOUNT</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>FS.MOUNT</code> is the mount unit retrieved with the previous command</div>
</li>
</ul>

</div>

<h1 class="sectionedit77" id="detaching_a_crytpsetup_header_from_an_existing_encrypted_disk">Detaching a Crytpsetup Header from an Existing Encrypted Disk</h1>
<div class="level1">

<p>
Creating an encrypted container with a detached header adds some plausible deniability since the partition or drive signature will not be observable to someone obtaining the disk drive. 
</p>

<p>
An encrypted volume with a detached header can be created using the <code>cryptsetup</code> utility on Linux but the question is whether the header can be &quot;detached&quot; at a time later than the creation time. Fortunately, the encrypted drive header is very straightforward and compares easily with any other filesystem header that resides at the start of the disk such that &quot;detaching&quot; the header involves dumping the header to a file and deleting the header from the disk drive.
</p>

<p>
Given an encrypted disk drive recognized as <code>/dev/sdb</code> on Linux, the first operation would be to dump the header:
</p>
<pre class="code bash">cryptsetup luksHeaderBackup <span class="sy0">/</span>dev<span class="sy0">/</span>sdb <span class="re5">--header-backup-file</span> <span class="sy0">/</span>opt<span class="sy0">/</span>sdb.header</pre>

<p>
Next, the <code>/dev/sdb</code> drive has to be inspected in order to find out how large the LUKS header is:
</p>
<pre class="code bash">cryptsetup luksDump <span class="sy0">/</span>dev<span class="sy0">/</span>sdb</pre>

<p>
which will print out something similar to the following:
</p>
<pre class="code">LUKS header information
Version:        2
Epoch:          3
Metadata area:  12475 [bytes]
Keyslots area:  18312184 [bytes]
UUID:           26e2b280-de17-6345-f3ac-2ef43682faa2
Label:          (no label)
Subsystem:      (no subsystem)
Flags:          (no flags)

Data segments:
  0: crypt
        offset: 22220875 [bytes]
        length: (whole device)
        cipher: aes-xts-plain64
        sector: 512 [bytes]

Keyslots:
  0: luks2
        Key:        256 bits
...</pre>

<p>
The important part here is the offset:
</p>
<pre class="code">...
Data segments:
  0: crypt
        offset: 22220875 [bytes]
        length: (whole device)
...</pre>

<p>
<code>22220875</code> is the number of bytes from the start of the disk representing the length of the header.
</p>

<p>
The next step is thus to delete the header:
</p>
<pre class="code">dd if=/dev/zero of=/dev/sdb bs=22220875 count=1</pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>22220875</code> is the length of the header</div>
</li>
</ul>

<p>
Finally, the disk can be opened using <code>cryptsetup</code> and by providing the header file created previously at <code>/opt/sdb.header</code>:
</p>
<pre class="code bash">cryptsetup luksOpen <span class="re5">--header</span> <span class="sy0">/</span>opt<span class="sy0">/</span>sdb.header <span class="sy0">/</span>dev<span class="sy0">/</span>sdb mydrive</pre>

<p>
The command should now open the drive with the header detached and placed at <code>/opt/sdb.header</code>.
</p>

</div>

<h1 class="sectionedit78" id="block_transfers_over_the_network">Block Transfers over the Network</h1>
<div class="level1">

<p>
When transferring large files over the network the following considerations must be observed:
</p>
<ul>
<li class="level1"><div class="li"> encryption - whether encryption is necessary or not; encryption will slow down a transfer particularly if there is no hardware acceleration available,</div>
</li>
<li class="level1"><div class="li"> compression - depending on the files being transferred, compression can reduce the amount of data being transferred; nevertheless, in case compression uses a single CPU, the CPU will become the bottleneck during transfer</div>
</li>
</ul>

<p>
For instances, with both encryption and compression, the following commands executed on the client and the server will transfer <code>/dev/device</code> over the network.
</p>

<p>
On the server (receiver), issue:
</p>
<pre class="code bash">nc <span class="re5">-l</span> <span class="re5">-p</span> <span class="nu0">6500</span> <span class="sy0">|</span> \                                        <span class="co0"># listens on port 6500</span>
    openssl aes-<span class="nu0">256</span>-cbc <span class="re5">-d</span> <span class="re5">-salt</span> <span class="re5">-pass</span> pass:mysecret <span class="sy0">|</span> \ <span class="co0"># decrypts with password mysecret</span>
    <span class="kw2">pigz</span> <span class="re5">-d</span> <span class="sy0">|</span> \                                          <span class="co0"># decompresses</span>
    <span class="kw2">dd</span> <span class="re2">bs</span>=16M <span class="re2">of</span>=<span class="sy0">/</span>dev<span class="sy0">/</span>device                             <span class="co0"># writes the stream to /dev/device</span></pre>

<p>
where:
</p>
<ul>
<li class="level1"><div class="li"> <code>aes-256-cbc</code> is the symmetric cipher to use (execute <code>cryptsetup benchmark</code> for example to get a speed estimate of the available ciphers and hopefully find a hardware accelerated cipher),</div>
</li>
<li class="level1"><div class="li"> <code>pigz</code> is a parallel gzip tool that will make use of all CPUs, avoiding thereby for the (de)compression to become a CPU bottleneck,</div>
</li>
</ul>

<p>
on the client (sender), issue:
</p>
<pre class="code bash">pv <span class="re5">-b</span> <span class="re5">-e</span> <span class="re5">-r</span> <span class="re5">-t</span> <span class="re5">-p</span> <span class="sy0">/</span>dev<span class="sy0">/</span>device <span class="sy0">|</span>                       <span class="co0"># reads from /dev/device (with stats)</span>
    <span class="kw2">pigz</span> <span class="re5">-1</span> <span class="sy0">|</span> \                                       <span class="co0"># compresses the stream</span>
    openssl aes-<span class="nu0">256</span>-cbc <span class="re5">-salt</span> <span class="re5">-pass</span> pass:mysecret <span class="sy0">|</span> \ <span class="co0"># encrypts with password mysecret</span>
    nc server.lan <span class="nu0">6500</span> <span class="re5">-q</span> <span class="nu0">1</span>                           <span class="co0"># connects to server.lan on port 6500</span></pre>

<p>
where:
</p>
<ul>
<li class="level1 node"><div class="li"> <code>-b -e -r -t -p</code> are all flags that turn on, in turn:</div>
<ul>
<li class="level2"><div class="li"> <code>-b</code> a byte counter that will count the number of bytes read,</div>
</li>
<li class="level2"><div class="li"> <code>-e</code> turns on an estimated ETA for reading the entire device,</div>
</li>
<li class="level2"><div class="li"> <code>-r</code> the rate counter and will display the current rate of data transfer,</div>
</li>
<li class="level2"><div class="li"> <code>-t</code> a timer that will display the total elapsed time spent reading,</div>
</li>
<li class="level2"><div class="li"> <code>-p</code> will enable a progress bar,</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <code>-q 1</code> indicates that <code>nc</code> should terminate after one second in case <code>EOF</code> has been reached while reading <code>/dev/device</code></div>
</li>
</ul>

<p>
Alternatively, if no compression or encryption is desired, <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/libvirt/automatic_virtual_machine_cloning_using_network_block_devices#server" class="wikilink1" title="libvirt:automatic_virtual_machine_cloning_using_network_block_devices" data-wiki-id="libvirt:automatic_virtual_machine_cloning_using_network_block_devices">the Network Block Device (NBD)</a> might be more convenient.
</p>

</div>

<h1 class="sectionedit79" id="determine_if_system_is_big-_or_little_endian">Determine if System is Big- or Little Endian</h1>
<div class="level1">
<pre class="code bash"><span class="kw3">echo</span> <span class="re5">-n</span> I <span class="sy0">|</span> <span class="kw2">hexdump</span> <span class="re5">-o</span> <span class="sy0">|</span> <span class="kw2">awk</span> <span class="st_h">'{ print substr($2,6,1); exit}'</span></pre>

<p>
will display:
</p>
<ul>
<li class="level1"><div class="li"> <code>0</code> on a big endian system,</div>
</li>
<li class="level1"><div class="li"> <code>1</code> on a little endian system</div>
</li>
</ul>

</div>

                    <!-- wikipage stop -->
                                    </div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <div class="docInfo"><bdi>fuss/linux.txt</bdi> · Last modified: 2022/04/29 20:22 by <bdi>office</bdi></div>

            <!-- PAGE ACTIONS -->
            <!-- <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Revisions [O]"><span>Revisions</span></a></li><li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux?do=export_pdf"  class="action export_pdf" rel="nofollow" title="Export to PDF"><span>Export to PDF</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div>--><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer">
    <!-- <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div> -->

		<!-- BREADCRUMBS -->
					<div class="breadcrumbs">
									<div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss" class="wikilink1" title="fuss" data-wiki-id="fuss">fuss</a></bdi> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux" class="wikilink1" title="fuss:linux" data-wiki-id="fuss:linux">linux</a></bdi></div>
											</div>
		
		<!-- ********** BOTTOM BAR ********** -->
		<div class="bar" id="bar__bottom">
		  <div class="bar-left" id="bar__bottomleft">
			<form class="button btn_login" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="" /><button type="submit" title="Log In">Log In</button></div></form>						<form class="button btn_revs" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux"><div class="no"><input type="hidden" name="do" value="revisions" /><button type="submit" accesskey="o" title="Revisions [O]">Revisions</button></div></form>			                        <form class="button btn_pdf" action="?do=export_pdf" method="POST">
                            <button type="submit" title="PDF">PDF</button>
                        </form>
		  </div>
		  <div class="bar-center">
                        <form class="button btn_home" action="/" method="POST">
                            <button type="submit" title="Home">Home</button>
                        </form>
			<form action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="fuss:linux" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			<!-- <form id="osssearchform" method="get" action="renderer">
        <input type="hidden" name="use" value="grimore.org">
        <input type="hidden" name="name" value="default">
        <input type="text" id="osssearchbox" name="query">
        <input type="hidden" name="login" value="search">
        <input type="hidden" name="key" value="1a5f74ab3f4df6ce883c4c158540e25e">
        <input type="submit" value="Search">
</form>
 -->
		  </div>
		  <div class="bar-right" id="bar__bottomright">
                        <form class="button btn_contact" action="mailto:%6F%66%66%69%63%65%40%67%72%69%6D%6F%72%65%2E%6F%72%67" method="POST">
                            <button type="submit" title="Contact">Contact</button>
                        </form>
                        <form class="button btn_news" action="/feed.php?mode=recent&amp;type=rss" method="POST">
                            <button type="submit" title="News">News</button>
                        </form>
			<form class="button btn_admin" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/fuss/linux"><div class="no"><input type="hidden" name="do" value="admin" /><button type="submit" title="Admin">Admin</button></div></form>								  </div>
		  		</div>

		
</div><!-- /footer -->

<div style="text-align: center;">
    <div style="display:inline-block;">
      <p>
        <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion">
          <img src="/lib/tpl/was/images/button-tor.png" alt="Access website using Tor" />
        </a> 
        <a href="http://ioujrf2uwqairs7l3vyvqp7n2pia3x3wg5w5qtcqvg32zezuezza.b32.i2p/" />
          <img src="/lib/tpl/was/images/button-i2p.png" alt="Access website using i2p" />
        </a>
        <a href="http://pgp.grimore.org/" />
          <img src="/lib/tpl/was/images/button-pgp.png" alt="Wizardry and Steamworks PGP Key" />
        </a>
      </p>
    </div>
<!--    <div style="display:inline-block;">
      <p>
        <a href="http://ij4lpzuyyng6cc4jw5mxibcyjv4rx4uk6x5jijoduglkgjh7mmya.b32.i2p">
          <img src="/lib/tpl/was/images/button-i2p.png" alt="Access website using i2p" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="http://cydia.grimore.org/">
          <img src="/lib/tpl/was/images/button-cydia.png" alt="Wizardry and Steamworks Cydia Repository" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="http://debian.grimore.org/">
          <img src="/lib/tpl/was/images/button-debian.png" alt="Wizardry and Steamworks Debian Repository" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="/opt/pasteboard/" rel="external nofollow">
          <img src="/lib/tpl/was/images/button-live.png" alt="Live Pasteboard" />
        </a> 
      </p>
    </div> -->
    
<br/>

    <p>
      For the copyright, license, warranty and privacy terms for the usage of this website please see the <a
      href="/wiki:license">license</a>, <a href="/wiki:privacy">privacy</a>, <a
      href="/wiki:copyright">copyright</a>
      and the <a href="/wiki:plagiarism">plagiarism</a> pages.
    </p>
</div>
    </div></div><!-- /site -->

    <div class="no"><img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/taskrunner.php?id=fuss%3Alinux&amp;1657305313" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if lte IE 8 ]></div><![endif]-->
</body>
</html>
