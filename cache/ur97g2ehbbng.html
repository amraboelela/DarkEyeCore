<!DOCTYPE html>
<html lang="was" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>cracks:grappler [Wizardry and Steamworks]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="cracks,grappler"/>
<link rel="search" type="application/opensearchdescription+xml" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/opensearch.php" title="Wizardry and Steamworks"/>
<link rel="start" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/"/>
<link rel="contents" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler?do=index" title="Sitemap"/>
<link rel="manifest" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Changes" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/feed.php?mode=list&amp;ns=cracks"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_export/xhtml/cracks/grappler"/>
<link rel="canonical" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler"/>
<link rel="stylesheet" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/css.php?t=was&amp;tseed=432e89e3541f30e5cde17d6daf3c6afb"/>
<!--[if gte IE 9]><!-->
<script >/*<![CDATA[*/var NS='cracks';var JSINFO = {"plugin_imagemap_mldummy":"http:\/\/3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion\/_media\/wiki\/dokuwiki-128.png","isadmin":0,"isauth":0,"plugin_pdfjs":{"hide_download_button":0},"plugins":{"vshare":{"youtube":"youtube\\.com\/.*[&?]v=([a-z0-9_\\-]+)","vimeo":"vimeo\\.com\\\/(\\d+)","slideshare":"slideshare.*id=(\\d+)","dailymotion":"dailymotion\\.com\/video\/([a-z0-9]+)","archiveorg":"archive\\.org\/(?:embed|details)\/([a-zA-Z0-9_\\-]+)","soundcloud":"soundcloud\\.com\/([\\w-]+\/[\\w-]+)","niconico":"nicovideo\\.jp\/watch\/(sm[0-9]+)","bitchute":"bitchute\\.com\\\/video\\\/([a-zA-Z0-9_\\-]+)","coub":"coub\\.com\\\/view\\\/([a-zA-Z0-9_\\-]+)","odysee":"odysee\\.com\/\\$\/(?:embed|download)\/([-%_?=\/a-zA-Z0-9]+)","youku":"v\\.youku\\.com\/v_show\/id_([0-9A-Za-z=]+)\\.html","bilibili":"bilibili\\.com\\\/video\\\/(BV[0-9A-Za-z]+)","msoffice":"(?:office\\.com.*[&?]videoid=([a-z0-9\\-]+))","msstream":"microsoftstream\\.com\\\/video\\\/([a-f0-9\\-]{36})"}},"id":"cracks:grappler","namespace":"cracks","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script charset="utf-8" src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/jquery.php?tseed=34a552433bc33cc9c3bc32527289a0b2"></script>
<script charset="utf-8" src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/js.php?t=was&amp;tseed=432e89e3541f30e5cde17d6daf3c6afb&amp;template=was"></script>
<!--<![endif]-->
    <!-- <link rel="shortcut icon" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/favicon.ico" />
<link rel="apple-touch-icon" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/apple-touch-icon.png" />
 -->
    <!-- Viewport -->
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!-- Favicon -->
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png?v=2">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png?v=2">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png?v=2">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png?v=2">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png?v=2">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png?v=2">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png?v=2">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png?v=2">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png?v=2">
<link rel="icon" type="image/png" href="/favicon-32x32.png?v=2" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png?v=2" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png?v=2" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png?v=2" sizes="16x16">
<link rel="manifest" href="/manifest.json?v=2">
<link rel="shortcut icon" href="/favicon.ico?v=2">
<meta name="apple-mobile-web-app-title" content="[Wizardry and Steamworks]">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png?v=2">
<meta name="application-name" content="[Wizardry and Steamworks]">
<meta name="theme-color" content="#ffffff">
    <!-- <script async type="text/javascript" src="/lib/tpl/was/loadCSS.js"></script>
    <script async type="text/javascript" src="/lib/tpl/was/cssrelpreload.js"></script> -->
</head>

<body>
    <!--[if lte IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_was     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header">

	    
	<!-- ********** TOP BAR ********** -->
	<div class="bar" id="bar__top">
		<div class="bar-left" id="bar__topleft">
			<form class="button btn_login" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="" /><button type="submit" title="Log In">Log In</button></div></form>						<form class="button btn_revs" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler"><div class="no"><input type="hidden" name="do" value="revisions" /><button type="submit" accesskey="o" title="Revisions [O]">Revisions</button></div></form>						<form class="button btn_pdf" action="?do=export_pdf" method="POST">
			    <button type="submit" title="PDF">PDF</button>
                        </form>
		</div>
		<div class="bar-center">
		        <form class="button btn_home" action="/" method="POST">
                            <button type="submit" title="Home">Home</button>
                        </form>
			<form action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="cracks:grappler" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			<!-- <form id="osssearchform" method="get" action="renderer">
        <input type="hidden" name="use" value="grimore.org">
        <input type="hidden" name="name" value="default">
        <input type="text" id="osssearchbox" name="query">
        <input type="hidden" name="login" value="search">
        <input type="hidden" name="key" value="1a5f74ab3f4df6ce883c4c158540e25e">
        <input type="submit" value="Search">
</form>
 -->
		</div>
		<div class="bar-right" id="bar__topright">
		        <form class="button btn_contact" action="mailto:%6F%66%66%69%63%65%40%67%72%69%6D%6F%72%65%2E%6F%72%67" method="POST">
			    <button type="submit" title="Contact">Contact</button>
                        </form>
                        <form class="button btn_news" action="/feed.php?type=rss2&amp;ns=cracks:grappler&amp;linkto=page&amp;content=abstract" method="POST">
			    <button type="submit" title="News">News</button>
                        </form>
			<form class="button btn_admin" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler"><div class="no"><input type="hidden" name="do" value="admin" /><button type="submit" title="Admin">Admin</button></div></form>								</div>
			</div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks" class="wikilink1" title="cracks" data-wiki-id="cracks">cracks</a></bdi> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler" class="wikilink1" title="cracks:grappler" data-wiki-id="cracks:grappler">grappler</a></bdi></div>
                                </div>
    
    <hr class="a11y" />
</div><!-- /header -->

        <div class="wrapper group">

            <!--  -->

            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <!-- <div class="pageId"><span>cracks:grappler</span></div> -->

                <div class="page group">
                                                            <!-- wikipage start -->
                    
<h1 class="sectionedit1" id="shortnote">Shortnote</h1>
<div class="level1">

<p>
Grappler is a software package able to download and search movies for OSX. It allows downloading YouTube movies even with the new redesign of their webpages. The trial contains limits imposed on the number of downloads.
</p>

<p>
First check whether the application has expired is to be found in the <code>checkRegistration</code> method at <code>0x100002878</code>:
</p>
<pre class="code asm">                                            methImpl_GrapplerAppDelegate_checkRegistration<span class="sy1">:</span>
<span class="co2">00000001</span><span class="nu0">00002878</span> <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">rbp</span>
<span class="co2">00000001</span><span class="nu0">00002879</span> <span class="nu0">4889E5</span>                          <span class="kw1">mov</span>        <span class="kw4">rbp</span><span class="sy1">,</span> <span class="kw4">rsp</span>
<span class="co2">00000001</span>0000287c <span class="nu0">4157</span>                            <span class="kw1">push</span>       <span class="kw4">r15</span>
<span class="co2">00000001</span>0000287e <span class="nu0">4156</span>                            <span class="kw1">push</span>       <span class="kw4">r14</span>
<span class="co2">00000001</span><span class="nu0">00002880</span> <span class="nu0">53</span>                              <span class="kw1">push</span>       <span class="kw4">rbx</span>
<span class="co2">00000001</span><span class="nu0">00002881</span> <span class="nu0">50</span>                              <span class="kw1">push</span>       <span class="kw4">rax</span>
<span class="co2">00000001</span><span class="nu0">00002882</span> 4989FE                          <span class="kw1">mov</span>        <span class="kw4">r14</span><span class="sy1">,</span> <span class="kw4">rdi</span>
<span class="co2">00000001</span><span class="nu0">00002885</span> 488B0544070400                  <span class="kw1">mov</span>        <span class="kw4">rax</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>_OBJC_IVAR_<span class="sy2">$</span>_GrapplerAppDelegate<span class="sy1">.</span>checkedRegistration<span class="br0">&#93;</span>
<span class="co2">00000001</span>0000288c 41C6040601                      <span class="kw1">mov</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">r14</span><span class="sy1">+</span><span class="kw4">rax</span><span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x1</span>
<span class="co2">00000001</span><span class="nu0">00002891</span> B001                            <span class="kw1">mov</span>        <span class="kw4">al</span><span class="sy1">,</span> <span class="nu0">0x1</span>
<span class="co2">00000001</span><span class="nu0">00002893</span> 488B0D3E070400                  <span class="kw1">mov</span>        <span class="kw4">rcx</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>_OBJC_IVAR_<span class="sy2">$</span>_GrapplerAppDelegate<span class="sy1">.</span>checkedRegistrationIsExpired<span class="br0">&#93;</span>
<span class="co2">00000001</span>0000289a 41803C0E00                      <span class="kw1">cmp</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">r14</span><span class="sy1">+</span><span class="kw4">rcx</span><span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x0</span>
<span class="co2">00000001</span><span class="nu0">0000289f</span> E9BA000000                      <span class="kw1">jmp</span>        <span class="nu0">0x10000295E</span>
<span class="sy1">...</span>
<span class="co2">00000001</span>0000295e 0FB6C0                          <span class="kw1">movzx</span>      <span class="kw4">eax</span><span class="sy1">,</span> <span class="kw4">al</span>                       <span class="co1">; XREF=0x10000289f</span>
<span class="co2">00000001</span><span class="nu0">00002961</span> 4883C408                        <span class="kw1">add</span>        <span class="kw4">rsp</span><span class="sy1">,</span> <span class="nu0">0x8</span>
<span class="co2">00000001</span><span class="nu0">00002965</span> 5B                              <span class="kw1">pop</span>        <span class="kw4">rbx</span>
<span class="co2">00000001</span><span class="nu0">00002966</span> 415E                            <span class="kw1">pop</span>        <span class="kw4">r14</span>
<span class="co2">00000001</span><span class="nu0">00002968</span> <span class="nu0">415F</span>                            <span class="kw1">pop</span>        <span class="kw4">r15</span>
<span class="co2">00000001</span>0000296a 5D                              <span class="kw1">pop</span>        <span class="kw4">rbp</span>
<span class="co2">00000001</span>0000296b C3                              <span class="kw1">ret</span></pre>

<p>
The <code>canAnotherFileStart</code> method is responsible for checking whether the number of downloads has been reached. We jump over that at <code>0x100004e90</code>:
</p>
<pre class="code asm">                                            methImpl_GrapplerAppDelegate_canAnotherFileStart<span class="sy1">:</span>
<span class="co2">00000001</span>00004e5c <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">rbp</span>
<span class="co2">00000001</span>00004e5d <span class="nu0">4889E5</span>                          <span class="kw1">mov</span>        <span class="kw4">rbp</span><span class="sy1">,</span> <span class="kw4">rsp</span>
<span class="co2">00000001</span><span class="nu0">00004e60</span> <span class="nu0">4157</span>                            <span class="kw1">push</span>       <span class="kw4">r15</span>
<span class="co2">00000001</span><span class="nu0">00004e62</span> <span class="nu0">4156</span>                            <span class="kw1">push</span>       <span class="kw4">r14</span>
<span class="co2">00000001</span><span class="nu0">00004e64</span> <span class="nu0">53</span>                              <span class="kw1">push</span>       <span class="kw4">rbx</span>
<span class="co2">00000001</span><span class="nu0">00004e65</span> <span class="nu0">50</span>                              <span class="kw1">push</span>       <span class="kw4">rax</span>
<span class="co2">00000001</span><span class="nu0">00004e66</span> 4989FE                          <span class="kw1">mov</span>        <span class="kw4">r14</span><span class="sy1">,</span> <span class="kw4">rdi</span>
<span class="co2">00000001</span><span class="nu0">00004e69</span> 488B3540B90300                  <span class="kw1">mov</span>        <span class="kw4">rsi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_sel_sharedRegistrationManager<span class="br0">&#93;</span> <span class="co1">; @selector(sharedRegistrationManager)</span>
<span class="co2">00000001</span><span class="nu0">00004e70</span> 488B3D59CF0300                  <span class="kw1">mov</span>        <span class="kw4">rdi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>bind__OBJC_CLASS_<span class="sy2">$</span>_AFRegistrationManager<span class="br0">&#93;</span>
<span class="co2">00000001</span><span class="nu0">00004e77</span> 488B1D92320300                  <span class="kw1">mov</span>        <span class="kw4">rbx</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>imp___got__objc_msgSend<span class="br0">&#93;</span>
<span class="co2">00000001</span>00004e7e FFD3                            <span class="kw1">call</span>       <span class="kw4">rbx</span>
<span class="co2">00000001</span><span class="nu0">00004e80</span> 488B3591BC0300                  <span class="kw1">mov</span>        <span class="kw4">rsi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_sel_isRegistered<span class="br0">&#93;</span> <span class="co1">; @selector(isRegistered)</span>
<span class="co2">00000001</span><span class="nu0">00004e87</span> 4889C7                          <span class="kw1">mov</span>        <span class="kw4">rdi</span><span class="sy1">,</span> <span class="kw4">rax</span>
<span class="co2">00000001</span>00004e8a FFD3                            <span class="kw1">call</span>       <span class="kw4">rbx</span>
<span class="co2">00000001</span>00004e8c B101                            <span class="kw1">mov</span>        <span class="kw4">cl</span><span class="sy1">,</span> <span class="nu0">0x1</span>
<span class="co2">00000001</span>00004e8e 84C0                            <span class="kw1">test</span>       <span class="kw4">al</span><span class="sy1">,</span> <span class="kw4">al</span>
<span class="co2">00000001</span><span class="nu0">00004e90</span> E943000000                      <span class="kw1">jmp</span>        <span class="nu0">0x100004ED8</span>
<span class="sy1">...</span>
<span class="co2">00000001</span>00004ed8 0FB6C1                          <span class="kw1">movzx</span>      <span class="kw4">eax</span><span class="sy1">,</span> <span class="kw4">cl</span>                       <span class="co1">; XREF=0x100004e90</span>
<span class="co2">00000001</span>00004edb 4883C408                        <span class="kw1">add</span>        <span class="kw4">rsp</span><span class="sy1">,</span> <span class="nu0">0x8</span>
<span class="co2">00000001</span>00004edf 5B                              <span class="kw1">pop</span>        <span class="kw4">rbx</span>
<span class="co2">00000001</span>00004ee0 415E                            <span class="kw1">pop</span>        <span class="kw4">r14</span>
<span class="co2">00000001</span>00004ee2 <span class="nu0">415F</span>                            <span class="kw1">pop</span>        <span class="kw4">r15</span>
<span class="co2">00000001</span>00004ee4 5D                              <span class="kw1">pop</span>        <span class="kw4">rbp</span>
<span class="co2">00000001</span>00004ee5 C3                              <span class="kw1">ret</span></pre>

<p>
Additionally we avoid incrementing the counter in the <code>fileDidComplete</code> method by jumping at <code>0x100004e13</code>:
</p>
<pre class="code asm">                                            methImpl_GrapplerAppDelegate_fileDidComplete_<span class="sy1">:</span>
<span class="co2">00000001</span>00004d07 <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">rbp</span>
<span class="sy1">...</span>
<span class="co2">00000001</span>00004d61 E9AB000000                      <span class="kw1">jmp</span>        <span class="nu0">0x100004E11</span>
<span class="co2">00000001</span>00004d66 <span class="nu0">90</span>                              <span class="kw1">nop</span>
<span class="co2">00000001</span>00004d66 <span class="nu0">90</span>                              <span class="kw1">nop</span>        
<span class="co2">00000001</span>00004d67 488B3542BA0300                  <span class="kw1">mov</span>        <span class="kw4">rsi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_sel_sharedRegistrationManager<span class="br0">&#93;</span> <span class="co1">; @selector(sharedRegistrationManager)</span>
<span class="co2">00000001</span>00004d6e 488B3D5BD00300                  <span class="kw1">mov</span>        <span class="kw4">rdi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>bind__OBJC_CLASS_<span class="sy2">$</span>_AFRegistrationManager<span class="br0">&#93;</span>
<span class="co2">00000001</span>00004d75 4C8B3594330300                  <span class="kw1">mov</span>        <span class="kw4">r14</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>imp___got__objc_msgSend<span class="br0">&#93;</span>
<span class="co2">00000001</span>00004d7c 41FFD6                          <span class="kw1">call</span>       <span class="kw4">r14</span>
<span class="co2">00000001</span>00004d7f 488B357ABD0300                  <span class="kw1">mov</span>        <span class="kw4">rsi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_sel_incrementTrial<span class="br0">&#93;</span> <span class="co1">; @selector(incrementTrial)</span>
<span class="sy1">...</span>
<span class="co2">00000001</span><span class="nu0">00004e11</span> 84DB                            <span class="kw1">test</span>       <span class="kw4">bl</span><span class="sy1">,</span> <span class="kw4">bl</span>                        <span class="co1">; XREF=0x100004d61</span>
<span class="co2">00000001</span><span class="nu0">00004e13</span> 74EF                            <span class="kw1">je</span>         <span class="nu0">0x100004E04</span></pre>

</div>

<h1 class="sectionedit2" id="framework">Framework</h1>
<div class="level1">

<p>
The registration frameworks to be found at <code>Grappler.app/Contents/Frameworks/AFRegistration.framework/Versions/A/AFRegistration</code> contains further checks.
</p>

<p>
First, the nag screen can be avoided altogether by suppressing the <code>showTrial</code> method.
</p>
<pre class="code asm">                                            methImpl_AFRegistrationWindowController_showTrial<span class="sy1">:</span>
<span class="co2">00000000</span>00002f00 <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">rbp</span>
<span class="sy1">...</span>
<span class="co2">00000000</span>00002f44 488B35DD490100                  <span class="kw1">mov</span>        <span class="kw4">rsi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_sel_supressNagWindow<span class="br0">&#93;</span> <span class="co1">; @selector(supressNagWindow)</span>
<span class="co2">00000000</span>00002f4b 4889C7                          <span class="kw1">mov</span>        <span class="kw4">rdi</span><span class="sy1">,</span> <span class="kw4">rax</span>
<span class="co2">00000000</span>00002f4e 41FFD6                          <span class="kw1">call</span>       <span class="kw4">r14</span>
<span class="co2">00000000</span>00002f51 3C01                            <span class="kw1">cmp</span>        <span class="kw4">al</span><span class="sy1">,</span> <span class="nu0">0x1</span>
<span class="co2">00000000</span>00002f53 E902000000                      <span class="kw1">jmp</span>        <span class="nu0">0x2F5A</span>
<span class="co2">00000000</span>00002f58 5D                              <span class="kw1">pop</span>        <span class="kw4">rbp</span>
<span class="co2">00000000</span>00002f59 C3                              <span class="kw1">ret</span>        
<span class="co2">00000000</span>00002f5a 488B35CF490100                  <span class="kw1">mov</span>        <span class="kw4">rsi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_sel_close<span class="br0">&#93;</span> <span class="co1">; @selector(close) XREF=0x2f53</span>
<span class="co2">00000000</span>00002f61 4889DF                          <span class="kw1">mov</span>        <span class="kw4">rdi</span><span class="sy1">,</span> <span class="kw4">rbx</span>
<span class="co2">00000000</span>00002f64 5B                              <span class="kw1">pop</span>        <span class="kw4">rbx</span>
<span class="co2">00000000</span>00002f65 415E                            <span class="kw1">pop</span>        <span class="kw4">r14</span>
<span class="co2">00000000</span>00002f67 5D                              <span class="kw1">pop</span>        <span class="kw4">rbp</span>
<span class="co2">00000000</span>00002f68 FF25FA100100                    <span class="kw1">jmp</span>        <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>imp___got__objc_msgSend<span class="br0">&#93;</span></pre>

<p>
Similarly, we avoid incrementing the trial count:
</p>
<pre class="code asm">                                            methImpl_AFRegistrationManager_incrementTrial<span class="sy1">:</span>
<span class="co2">00000000</span>0000577e <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">rbp</span>
<span class="sy1">...</span>
<span class="co2">00000000</span>000057d4 E925000000                      <span class="kw1">jmp</span>        <span class="nu0">0x57FE</span>
<span class="co2">00000000</span>000057d9 <span class="nu0">7523</span>                            <span class="kw1">jne</span>        <span class="nu0">0x57FE</span>
<span class="co2">00000000</span>000057db 488B05C6490100                  <span class="kw1">mov</span>        <span class="kw4">rax</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>_OBJC_IVAR_<span class="sy2">$</span>_AFRegistrationManager<span class="sy1">.</span>delegate<span class="br0">&#93;</span>
<span class="co2">00000000</span><span class="nu0">000057e2</span> 488B3C03                        <span class="kw1">mov</span>        <span class="kw4">rdi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">rbx</span><span class="sy1">+</span><span class="kw4">rax</span><span class="br0">&#93;</span>
<span class="co2">00000000</span><span class="nu0">000057e6</span> 488B1553240100                  <span class="kw1">mov</span>        <span class="kw4">rdx</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_sel_registrationExpired<span class="br0">&#93;</span> <span class="co1">; @selector(registrationExpired)</span>
<span class="co2">00000000</span>000057ed 488D359C2A0100                  <span class="kw1">lea</span>        <span class="kw4">rsi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_msg_respondsToSelector_<span class="br0">&#93;</span> <span class="co1">; @selector(respondsToSelector:)</span>
<span class="co2">00000000</span>000057f4 FF15962A0100                    <span class="kw1">call</span>       <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_msg_respondsToSelector_<span class="br0">&#93;</span> <span class="co1">; @selector(respondsToSelector:)</span>
<span class="co2">00000000</span>000057fa 84C0                            <span class="kw1">test</span>       <span class="kw4">al</span><span class="sy1">,</span> <span class="kw4">al</span>
<span class="co2">00000000</span>000057fc 750B                            <span class="kw1">jne</span>        <span class="nu0">0x5809</span>
<span class="co2">00000000</span>000057fe 4883C408                        <span class="kw1">add</span>        <span class="kw4">rsp</span><span class="sy1">,</span> <span class="nu0">0x8</span>                      <span class="co1">; XREF=0x57d4, 0x57d9</span>
<span class="co2">00000000</span><span class="nu0">00005802</span> 5B                              <span class="kw1">pop</span>        <span class="kw4">rbx</span>
<span class="co2">00000000</span><span class="nu0">00005803</span> 415E                            <span class="kw1">pop</span>        <span class="kw4">r14</span>
<span class="co2">00000000</span><span class="nu0">00005805</span> <span class="nu0">415F</span>                            <span class="kw1">pop</span>        <span class="kw4">r15</span>
<span class="co2">00000000</span><span class="nu0">00005807</span> 5D                              <span class="kw1">pop</span>        <span class="kw4">rbp</span>
<span class="co2">00000000</span><span class="nu0">00005808</span> C3                              <span class="kw1">ret</span></pre>

<p>
Finally, we set the application to never expire:
</p>
<pre class="code asm">                                            methImpl_AFRegistrationManager_isTrialExpired<span class="sy1">:</span>
<span class="co2">00000000</span><span class="nu0">00004728</span> <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">rbp</span>
<span class="co2">00000000</span><span class="nu0">00004729</span> <span class="nu0">4889E5</span>                          <span class="kw1">mov</span>        <span class="kw4">rbp</span><span class="sy1">,</span> <span class="kw4">rsp</span>
<span class="co2">00000000</span>0000472c <span class="nu0">4156</span>                            <span class="kw1">push</span>       <span class="kw4">r14</span>
<span class="co2">00000000</span>0000472e <span class="nu0">53</span>                              <span class="kw1">push</span>       <span class="kw4">rbx</span>
<span class="co2">00000000</span><span class="nu0">0000472f</span> 4889FB                          <span class="kw1">mov</span>        <span class="kw4">rbx</span><span class="sy1">,</span> <span class="kw4">rdi</span>
<span class="co2">00000000</span><span class="nu0">00004732</span> 488B05775A0100                  <span class="kw1">mov</span>        <span class="kw4">rax</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>_OBJC_IVAR_<span class="sy2">$</span>_AFRegistrationManager<span class="sy1">.</span>configuration<span class="br0">&#93;</span>
<span class="co2">00000000</span><span class="nu0">00004739</span> 488B3C03                        <span class="kw1">mov</span>        <span class="kw4">rdi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">rbx</span><span class="sy1">+</span><span class="kw4">rax</span><span class="br0">&#93;</span>
<span class="co2">00000000</span>0000473d 488B35F4330100                  <span class="kw1">mov</span>        <span class="kw4">rsi</span><span class="sy1">,</span> <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>objc_sel_expirationDate<span class="br0">&#93;</span> <span class="co1">; @selector(expirationDate)</span>
<span class="co2">00000000</span><span class="nu0">00004744</span> FF151EF90000                    <span class="kw1">call</span>       <span class="kw6">qword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span>imp___got__objc_msgSend<span class="br0">&#93;</span>
<span class="co2">00000000</span>0000474a 30C9                            <span class="kw1">xor</span>        <span class="kw4">cl</span><span class="sy1">,</span> <span class="kw4">cl</span>
<span class="co2">00000000</span>0000474c 4885C0                          <span class="kw1">test</span>       <span class="kw4">rax</span><span class="sy1">,</span> <span class="kw4">rax</span>
<span class="co2">00000000</span><span class="nu0">0000474f</span> E945000000                      <span class="kw1">jmp</span>        <span class="nu0">0x4799</span>
<span class="sy1">...</span>
<span class="co2">00000000</span><span class="nu0">00004799</span> 0FB6C1                          <span class="kw1">movzx</span>      <span class="kw4">eax</span><span class="sy1">,</span> <span class="kw4">cl</span>                       <span class="co1">; XREF=0x474f, 0x4795</span>
<span class="co2">00000000</span>0000479c 5B                              <span class="kw1">pop</span>        <span class="kw4">rbx</span>
<span class="co2">00000000</span>0000479d 415E                            <span class="kw1">pop</span>        <span class="kw4">r14</span>
<span class="co2">00000000</span><span class="nu0">0000479f</span> 5D                              <span class="kw1">pop</span>        <span class="kw4">rbp</span>
<span class="co2">00000000</span>000047a0 C3                              <span class="kw1">ret</span></pre>

</div>

                    <!-- wikipage stop -->
                                    </div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <div class="docInfo"><bdi>cracks/grappler.txt</bdi> · Last modified: 2022/04/19 09:28 (external edit)</div>

            <!-- PAGE ACTIONS -->
            <!-- <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Revisions [O]"><span>Revisions</span></a></li><li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler?do=export_pdf"  class="action export_pdf" rel="nofollow" title="Export to PDF"><span>Export to PDF</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div>--><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer">
    <!-- <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div> -->

		<!-- BREADCRUMBS -->
					<div class="breadcrumbs">
									<div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks" class="wikilink1" title="cracks" data-wiki-id="cracks">cracks</a></bdi> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler" class="wikilink1" title="cracks:grappler" data-wiki-id="cracks:grappler">grappler</a></bdi></div>
											</div>
		
		<!-- ********** BOTTOM BAR ********** -->
		<div class="bar" id="bar__bottom">
		  <div class="bar-left" id="bar__bottomleft">
			<form class="button btn_login" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="" /><button type="submit" title="Log In">Log In</button></div></form>						<form class="button btn_revs" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler"><div class="no"><input type="hidden" name="do" value="revisions" /><button type="submit" accesskey="o" title="Revisions [O]">Revisions</button></div></form>			                        <form class="button btn_pdf" action="?do=export_pdf" method="POST">
                            <button type="submit" title="PDF">PDF</button>
                        </form>
		  </div>
		  <div class="bar-center">
                        <form class="button btn_home" action="/" method="POST">
                            <button type="submit" title="Home">Home</button>
                        </form>
			<form action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="cracks:grappler" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			<!-- <form id="osssearchform" method="get" action="renderer">
        <input type="hidden" name="use" value="grimore.org">
        <input type="hidden" name="name" value="default">
        <input type="text" id="osssearchbox" name="query">
        <input type="hidden" name="login" value="search">
        <input type="hidden" name="key" value="1a5f74ab3f4df6ce883c4c158540e25e">
        <input type="submit" value="Search">
</form>
 -->
		  </div>
		  <div class="bar-right" id="bar__bottomright">
                        <form class="button btn_contact" action="mailto:%6F%66%66%69%63%65%40%67%72%69%6D%6F%72%65%2E%6F%72%67" method="POST">
                            <button type="submit" title="Contact">Contact</button>
                        </form>
                        <form class="button btn_news" action="/feed.php?mode=recent&amp;type=rss" method="POST">
                            <button type="submit" title="News">News</button>
                        </form>
			<form class="button btn_admin" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/grappler"><div class="no"><input type="hidden" name="do" value="admin" /><button type="submit" title="Admin">Admin</button></div></form>								  </div>
		  		</div>

		
</div><!-- /footer -->

<div style="text-align: center;">
    <div style="display:inline-block;">
      <p>
        <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion">
          <img src="/lib/tpl/was/images/button-tor.png" alt="Access website using Tor" />
        </a> 
        <a href="http://ioujrf2uwqairs7l3vyvqp7n2pia3x3wg5w5qtcqvg32zezuezza.b32.i2p/" />
          <img src="/lib/tpl/was/images/button-i2p.png" alt="Access website using i2p" />
        </a>
        <a href="http://pgp.grimore.org/" />
          <img src="/lib/tpl/was/images/button-pgp.png" alt="Wizardry and Steamworks PGP Key" />
        </a>
      </p>
    </div>
<!--    <div style="display:inline-block;">
      <p>
        <a href="http://ij4lpzuyyng6cc4jw5mxibcyjv4rx4uk6x5jijoduglkgjh7mmya.b32.i2p">
          <img src="/lib/tpl/was/images/button-i2p.png" alt="Access website using i2p" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="http://cydia.grimore.org/">
          <img src="/lib/tpl/was/images/button-cydia.png" alt="Wizardry and Steamworks Cydia Repository" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="http://debian.grimore.org/">
          <img src="/lib/tpl/was/images/button-debian.png" alt="Wizardry and Steamworks Debian Repository" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="/opt/pasteboard/" rel="external nofollow">
          <img src="/lib/tpl/was/images/button-live.png" alt="Live Pasteboard" />
        </a> 
      </p>
    </div> -->
    
<br/>

    <p>
      For the copyright, license, warranty and privacy terms for the usage of this website please see the <a
      href="/wiki:license">license</a>, <a href="/wiki:privacy">privacy</a>, <a
      href="/wiki:copyright">copyright</a>
      and the <a href="/wiki:plagiarism">plagiarism</a> pages.
    </p>
</div>
    </div></div><!-- /site -->

    <div class="no"><img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/taskrunner.php?id=cracks%3Agrappler&amp;1657242367" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if lte IE 8 ]></div><![endif]-->
</body>
</html>
