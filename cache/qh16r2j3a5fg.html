<!DOCTYPE html>
<html lang="was" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>cracks:securityspy [Wizardry and Steamworks]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="robots" content="index,follow"/>
<meta name="keywords" content="cracks,securityspy"/>
<link rel="search" type="application/opensearchdescription+xml" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/opensearch.php" title="Wizardry and Steamworks"/>
<link rel="start" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/"/>
<link rel="contents" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy?do=index" title="Sitemap"/>
<link rel="manifest" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Changes" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Current namespace" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/feed.php?mode=list&amp;ns=cracks"/>
<link rel="alternate" type="text/html" title="Plain HTML" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/_export/xhtml/cracks/securityspy"/>
<link rel="canonical" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy"/>
<link rel="stylesheet" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/css.php?t=was&amp;tseed=24551d22639bdaeb736aec3dca86fd82"/>
<!--[if gte IE 9]><!-->
<script >/*<![CDATA[*/var NS='cracks';var JSINFO = {"plugin_imagemap_mldummy":"http:\/\/3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion\/_media\/wiki\/dokuwiki-128.png","isadmin":0,"isauth":0,"plugin_pdfjs":{"hide_download_button":0},"plugins":{"vshare":{"youtube":"youtube\\.com\/.*[&?]v=([a-z0-9_\\-]+)","vimeo":"vimeo\\.com\\\/(\\d+)","slideshare":"slideshare.*id=(\\d+)","dailymotion":"dailymotion\\.com\/video\/([a-z0-9]+)","archiveorg":"archive\\.org\/(?:embed|details)\/([a-zA-Z0-9_\\-]+)","soundcloud":"soundcloud\\.com\/([\\w-]+\/[\\w-]+)","niconico":"nicovideo\\.jp\/watch\/(sm[0-9]+)","bitchute":"bitchute\\.com\\\/video\\\/([a-zA-Z0-9_\\-]+)","coub":"coub\\.com\\\/view\\\/([a-zA-Z0-9_\\-]+)","odysee":"odysee\\.com\/\\$\/(?:embed|download)\/([-%_?=\/a-zA-Z0-9]+)","youku":"v\\.youku\\.com\/v_show\/id_([0-9A-Za-z=]+)\\.html","bilibili":"bilibili\\.com\\\/video\\\/(BV[0-9A-Za-z]+)","msoffice":"(?:office\\.com.*[&?]videoid=([a-z0-9\\-]+))","msstream":"microsoftstream\\.com\\\/video\\\/([a-f0-9\\-]{36})"}},"id":"cracks:securityspy","namespace":"cracks","ACT":"show","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script charset="utf-8" src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/jquery.php?tseed=34a552433bc33cc9c3bc32527289a0b2"></script>
<script charset="utf-8" src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/js.php?t=was&amp;tseed=24551d22639bdaeb736aec3dca86fd82&amp;template=was"></script>
<!--<![endif]-->
    <!-- <link rel="shortcut icon" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/favicon.ico" />
<link rel="apple-touch-icon" href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/apple-touch-icon.png" />
 -->
    <!-- Viewport -->
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!-- Favicon -->
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png?v=2">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png?v=2">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png?v=2">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png?v=2">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png?v=2">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png?v=2">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png?v=2">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png?v=2">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png?v=2">
<link rel="icon" type="image/png" href="/favicon-32x32.png?v=2" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png?v=2" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png?v=2" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png?v=2" sizes="16x16">
<link rel="manifest" href="/manifest.json?v=2">
<link rel="shortcut icon" href="/favicon.ico?v=2">
<meta name="apple-mobile-web-app-title" content="[Wizardry and Steamworks]">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png?v=2">
<meta name="application-name" content="[Wizardry and Steamworks]">
<meta name="theme-color" content="#ffffff">
    <!-- <script async type="text/javascript" src="/lib/tpl/was/loadCSS.js"></script>
    <script async type="text/javascript" src="/lib/tpl/was/cssrelpreload.js"></script> -->
</head>

<body>
    <!--[if lte IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_was     ">

        
<!-- ********** HEADER ********** -->
<div id="dokuwiki__header">

	    
	<!-- ********** TOP BAR ********** -->
	<div class="bar" id="bar__top">
		<div class="bar-left" id="bar__topleft">
			<form class="button btn_login" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="" /><button type="submit" title="Log In">Log In</button></div></form>						<form class="button btn_revs" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy"><div class="no"><input type="hidden" name="do" value="revisions" /><button type="submit" accesskey="o" title="Revisions [O]">Revisions</button></div></form>						<form class="button btn_pdf" action="?do=export_pdf" method="POST">
			    <button type="submit" title="PDF">PDF</button>
                        </form>
		</div>
		<div class="bar-center">
		        <form class="button btn_home" action="/" method="POST">
                            <button type="submit" title="Home">Home</button>
                        </form>
			<form action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="cracks:securityspy" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			<!-- <form id="osssearchform" method="get" action="renderer">
        <input type="hidden" name="use" value="grimore.org">
        <input type="hidden" name="name" value="default">
        <input type="text" id="osssearchbox" name="query">
        <input type="hidden" name="login" value="search">
        <input type="hidden" name="key" value="1a5f74ab3f4df6ce883c4c158540e25e">
        <input type="submit" value="Search">
</form>
 -->
		</div>
		<div class="bar-right" id="bar__topright">
		        <form class="button btn_contact" action="mailto:%6F%66%66%69%63%65%40%67%72%69%6D%6F%72%65%2E%6F%72%67" method="POST">
			    <button type="submit" title="Contact">Contact</button>
                        </form>
                        <form class="button btn_news" action="/feed.php?type=rss2&amp;ns=cracks:securityspy&amp;linkto=page&amp;content=abstract" method="POST">
			    <button type="submit" title="News">News</button>
                        </form>
			<form class="button btn_admin" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy"><div class="no"><input type="hidden" name="do" value="admin" /><button type="submit" title="Admin">Admin</button></div></form>								</div>
			</div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                            <div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks" class="wikilink1" title="cracks" data-wiki-id="cracks">cracks</a></bdi> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy" class="wikilink1" title="cracks:securityspy" data-wiki-id="cracks:securityspy">securityspy</a></bdi></div>
                                </div>
    
    <hr class="a11y" />
</div><!-- /header -->

        <div class="wrapper group">

            <!--  -->

            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <!-- <div class="pageId"><span>cracks:securityspy</span></div> -->

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc" class="dw__toc">
<h3 class="toggle">Table of Contents</h3>
<div>

<ul class="toc">
<li class="level1"><div class="li"><a href="#shortnote">Shortnote</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="#disabling_demo_overlay">Disabling DEMO Overlay</a></div></li>
<li class="level2"><div class="li"><a href="#enabling_ddns">Enabling DDNS</a></div></li>
<li class="level2"><div class="li"><a href="#trialperiodexpiredflag">TrialPeriodExpiredFlag</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->

<h1 class="sectionedit1" id="shortnote">Shortnote</h1>
<div class="level1">

<p>
SecuritySpy is an application that allows you to remotely monitor cameras. It has motion detection, the ability to record videos and a lot of other features. Cracking the application is rather simple because it relies on a flag named <code>gTrialPeriodExpiredFlag</code> to hold the information regarding the trial expiration. Similarly, it uses functions to overlay <code>DEMO</code> messages which are easily circumvented.
</p>

</div>

<h2 class="sectionedit2" id="disabling_demo_overlay">Disabling DEMO Overlay</h2>
<div class="level2">
<pre class="code asm">&nbsp;
====== B E G I N   O F   P R O C E D U R E ======
&nbsp;
&nbsp;
                                       <span class="co1">; Basic Block Input Regs: ebp -  Killed Regs: eax ecx ebx esi edi</span>
                                    _DrawDemoMessage_4edb0<span class="sy1">:</span>
<span class="co2">0004edb0</span> <span class="nu0">55</span>                              <span class="kw1">push</span>       <span class="kw4">ebp</span>                                   <span class="co1">; XREF=0x4a191</span>
<span class="co2">0004edb1</span> <span class="nu0">89E5</span>                            <span class="kw1">mov</span>        <span class="kw4">ebp</span><span class="sy1">,</span> <span class="kw4">esp</span>
<span class="co2">0004edb3</span> <span class="nu0">53</span>                              <span class="kw1">push</span>       <span class="kw4">ebx</span>
<span class="co2">0004edb4</span> <span class="nu0">57</span>                              <span class="kw1">push</span>       <span class="kw4">edi</span>
<span class="co2">0004edb5</span> <span class="nu0">56</span>                              <span class="kw1">push</span>       <span class="kw4">esi</span>
<span class="co2">0004edb6</span> 83EC4C                          <span class="kw1">sub</span>        <span class="kw4">esp</span><span class="sy1">,</span> <span class="nu0">0x4C</span>
<span class="co2">0004edb9</span> E800000000                      <span class="kw1">call</span>       <span class="nu0">0x4EDBE</span>
<span class="co2">0004edbe</span> <span class="nu0">59</span>                              <span class="kw1">pop</span>        <span class="kw4">ecx</span>                                   <span class="co1">; XREF=0x4edb9</span>
<span class="co2">0004edbf</span> 0FBF4508                        <span class="kw1">movsx</span>      <span class="kw4">eax</span><span class="sy1">,</span> <span class="kw6">word</span> <span class="br0">&#91;</span><span class="kw4">ss</span><span class="sy1">:</span><span class="kw4">ebp</span><span class="sy1">-</span><span class="nu0">0x58</span><span class="sy1">+</span>arg_0<span class="br0">&#93;</span>
<span class="co2">0004edc3</span> 69F090170000                    <span class="kw1">imul</span>       <span class="kw4">esi</span><span class="sy1">,</span> <span class="kw4">eax</span><span class="sy1">,</span> <span class="nu0">0x1790</span>
<span class="co2">0004edc9</span> 8BB96E420A00                    <span class="kw1">mov</span>        <span class="kw4">edi</span><span class="sy1">,</span> <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">ecx</span><span class="sy1">-</span><span class="nu0">0x4edbe</span><span class="sy1">+</span><span class="nu0">0xF302C</span><span class="br0">&#93;</span>
<span class="co2">0004edcf</span> 8B5C377C                        <span class="kw1">mov</span>        <span class="kw4">ebx</span><span class="sy1">,</span> <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">edi</span><span class="sy1">+</span><span class="kw4">esi</span><span class="sy1">+</span><span class="nu0">0x7C</span><span class="br0">&#93;</span>
<span class="co2">0004edd3</span> 8B8C3794000000                  <span class="kw1">mov</span>        <span class="kw4">ecx</span><span class="sy1">,</span> <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">edi</span><span class="sy1">+</span><span class="kw4">esi</span><span class="sy1">+</span><span class="nu0">0x94</span><span class="br0">&#93;</span>
<span class="co2">0004edda</span> 85C9                            <span class="kw1">test</span>       <span class="kw4">ecx</span><span class="sy1">,</span> <span class="kw4">ecx</span>
<span class="co2">0004eddc</span> 751C                            <span class="kw1">jne</span>        <span class="nu0">0x4EDFA</span>
                                       <span class="co1">; Basic Block Input Regs: eax -  Killed Regs: eax esp</span>
<span class="co2">0004edde</span> 0FBFC0                          <span class="kw1">movsx</span>      <span class="kw4">eax</span><span class="sy1">,</span> <span class="kw4">ax</span>
<span class="co2">0004ede1</span> <span class="nu0">890424</span>                          <span class="kw1">mov</span>        <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ss</span><span class="sy1">:</span><span class="kw4">esp</span><span class="br0">&#93;</span><span class="sy1">,</span> <span class="kw4">eax</span>
<span class="co2">0004ede4</span> E8978D0100                      <span class="kw1">call</span>       _GenerateDemoMessageGWorld_67b80
<span class="co2">0004ede9</span> 85C0                            <span class="kw1">test</span>       <span class="kw4">eax</span><span class="sy1">,</span> <span class="kw4">eax</span>
<span class="co2">0004edeb</span> 0F8569040000                    <span class="kw1">jne</span>        <span class="nu0">0x4F25A</span></pre>

<p>
We turn the <code>jne</code> to <code>0x4EDFA</code> into a jump to <code>0x4F25A</code>. This is because the first <code>jne</code> leads to the code segment responsible with displaying he <code>DEMO</code> message when SecuritySpy is running in Active mode.
</p>

</div>

<h2 class="sectionedit3" id="enabling_ddns">Enabling DDNS</h2>
<div class="level2">
<pre class="code asm"><span class="co2">00042f03</span> 0F8497000000                    <span class="kw1">je</span>         <span class="nu0">0x42FA0</span>
                                       <span class="co1">; Basic Block Input Regs: eax edi -  Killed Regs: eax ecx ebx esp ebp esi</span>
<span class="co2">00042f09</span> E8423D0900                      <span class="kw1">call</span>       imp___symbol_stub__CFBundleGetMainBundle
<span class="co2">00042f0e</span> 8D8B2F6D0B00                    <span class="kw1">lea</span>        <span class="kw4">ecx</span><span class="sy1">,</span> <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">ebx</span><span class="sy1">-</span><span class="nu0">0x42a91</span><span class="sy1">+</span>cfstring_DDNS_disabled_because_your_trial_period_has_expired<span class="br0">&#93;</span> <span class="co1">; @&quot;DDNS disabled because your trial period has expired&quot;</span></pre>

<p>
Simple enough, the <code>je</code> takes us over the block so we turn the <code>je</code> into a <code>jmp</code> to the same address.
</p>

<p>
There is an additional protection:
</p>
<pre class="code asm"><span class="co2">0004399f</span> 750D                            <span class="kw1">jne</span>        <span class="nu0">0x439AE</span>
<span class="co2">000439a1</span> E8AA320900                      <span class="kw1">call</span>       imp___symbol_stub__CFBundleGetMainBundle
<span class="co2">000439a6</span> 8D8B2F6D0B00                    <span class="kw1">lea</span>        <span class="kw4">ecx</span><span class="sy1">,</span> <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">ebx</span><span class="sy1">+</span><span class="nu0">0xB6D2F</span><span class="br0">&#93;</span>           <span class="co1">; @&quot;DDNS disabled because your trial period has expired&quot;</span>
<span class="co2">000439ac</span> EBA4                            <span class="kw1">jmp</span>        <span class="nu0">0x43952</span>
<span class="co2">000439ae</span> 80F945                          <span class="kw1">cmp</span>        <span class="kw4">cl</span><span class="sy1">,</span> <span class="nu0">0x45</span>                              <span class="co1">; XREF=0x4399f</span></pre>

<p>
Easy enough, we eliminate this check by turning the <code>jne</code> into a <code>jmp</code>.
</p>

</div>

<h2 class="sectionedit4" id="trialperiodexpiredflag">TrialPeriodExpiredFlag</h2>
<div class="level2">

<p>
So that the trial never expires, we never set it to <code>0x1</code>. This is around <code>0x953f</code>:
</p>
<pre class="code asm"><span class="co2">0000953d</span> <span class="nu0">7609</span>                            <span class="kw1">jbe</span>        <span class="nu0">0x9548</span>
                                       <span class="co1">; Basic Block Input Regs: &lt;nothing&gt; -  Killed Regs: esi</span>
<span class="co2">0000953f</span> C68667580F0001                  <span class="kw1">mov</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">esi</span><span class="sy1">-</span><span class="nu0">0x5aa1</span><span class="sy1">+</span>_gTrialPeriodExpiredFlag<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x1</span>
                                       <span class="co1">; Basic Block Input Regs: eax -  Killed Regs: eax</span>
<span class="co2">00009546</span> 31C0                            <span class="kw1">xor</span>        <span class="kw4">eax</span><span class="sy1">,</span> <span class="kw4">eax</span>                              <span class="co1">; XREF=0x5e2d, 0x6205</span>
                                       <span class="co1">; Basic Block Input Regs: ebp -  Killed Regs: ecx</span>
<span class="co2">00009548</span> 8B8D9CFDFFFF                    <span class="kw1">mov</span>        <span class="kw4">ecx</span><span class="sy1">,</span> <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ss</span><span class="sy1">:</span><span class="kw4">ebp</span><span class="sy1">-</span><span class="nu0">0x278</span><span class="sy1">+</span>var_20<span class="br0">&#93;</span>      <span class="co1">; XREF=0x5b60, 0x5e07, 0x953d, 0x5c46, 0x5c7a, 0x60b3, ...</span></pre>

<p>
We just set the <code>jbe</code> to a <code>jmp</code> in order to avoid setting the <code>gTrialPeriodExpiredFlag</code> to <code>0x1</code>.
</p>

<p>
Another sequence where the flag is set:
</p>
<pre class="code asm"><span class="co2">0000ffda</span> <span class="nu0">7607</span>                            <span class="kw1">jbe</span>        <span class="nu0">0xFFE3</span>
                                       <span class="co1">; Basic Block Input Regs: &lt;nothing&gt; -  Killed Regs: edi</span>
<span class="co2">0000ffdc</span> C687D7B70E0001                  <span class="kw1">mov</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">edi</span><span class="sy1">-</span><span class="nu0">0xfb31</span><span class="sy1">+</span>_gTrialPeriodExpiredFlag<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x1</span>
                                       <span class="co1">; Basic Block Input Regs: ebp -  Killed Regs: eax</span>
<span class="co2">0000ffe3</span> 8B85D4FEFFFF                    <span class="kw1">mov</span>        <span class="kw4">eax</span><span class="sy1">,</span> <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ss</span><span class="sy1">:</span><span class="kw4">ebp</span><span class="sy1">-</span><span class="nu0">0x158</span><span class="sy1">+</span>var_44<span class="br0">&#93;</span>      <span class="co1">; XREF=0xffc3, 0xffda</span></pre>

<p>
We turn the <code>jbe</code> into a <code>jmp</code> to void setting it.
</p>

<p>
Now we could stop because the flag is never set. But we can go on and mess with the conditionals where the flag is checked. One of those instances is at <code>0x11068</code>:
</p>
<pre class="code asm">                                       <span class="co1">; Basic Block Input Regs: ebx -  Killed Regs: &lt;nothing&gt;</span>
<span class="co2">00011068</span> 80BB67A80E0000                  <span class="kw1">cmp</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">ebx</span><span class="sy1">-</span><span class="nu0">0x10aa1</span><span class="sy1">+</span>_gTrialPeriodExpiredFlag<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x0</span>
<span class="co2">0001106f</span> <span class="nu0">7405</span>                            <span class="kw1">je</span>         <span class="nu0">0x11076</span>
                                       <span class="co1">; Basic Block Input Regs: &lt;nothing&gt; -  Killed Regs: &lt;nothing&gt;</span>
<span class="co2">00011071</span> E8BA5B0300                      <span class="kw1">call</span>       _DisplayTrialPeriodExpiredMessage_46c30
                                       <span class="co1">; Basic Block Input Regs: ebx edi -  Killed Regs: ebx edi</span>
<span class="co2">00011076</span> 31FF                            <span class="kw1">xor</span>        <span class="kw4">edi</span><span class="sy1">,</span> <span class="kw4">edi</span>                              <span class="co1">; XREF=0x1106f</span></pre>

<p>
roughly translates to &quot;if the <code>gTrialPeriodExpiredFlag</code> is <code>0x0</code> then do not display the trial expired message&quot;. So we turn the <code>je</code> into a <code>jmp</code>. This is not necessary, of course, if we avoid the setting of the flag to <code>0x1</code> initially.
</p>

<p>
We find the same sequence later on:
</p>
<pre class="code asm">                                       <span class="co1">; Basic Block Input Regs: edi -  Killed Regs: &lt;nothing&gt;</span>
<span class="co2">0003ebe5</span> 80BF2AC80B0000                  <span class="kw1">cmp</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">edi</span><span class="sy1">-</span><span class="nu0">0x3eade</span><span class="sy1">+</span>_gTrialPeriodExpiredFlag<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x0</span>
<span class="co2">0003ebec</span> <span class="nu0">7405</span>                            <span class="kw1">je</span>         <span class="nu0">0x3EBF3</span>
                                       <span class="co1">; Basic Block Input Regs: &lt;nothing&gt; -  Killed Regs: &lt;nothing&gt;</span>
<span class="co2">0003ebee</span> E83D800000                      <span class="kw1">call</span>       _DisplayTrialPeriodExpiredMessage_46c30
                                       <span class="co1">; Basic Block Input Regs: esi edi -  Killed Regs: esi edi</span>
<span class="co2">0003ebf3</span> 31F6                            <span class="kw1">xor</span>        <span class="kw4">esi</span><span class="sy1">,</span> <span class="kw4">esi</span>                              <span class="co1">; XREF=0x3ebec</span></pre>

<p>
Again, we turn the <code>je</code> into a <code>jmp</code>.
</p>

<p>
On the same wavelength but with a small difference is:
</p>
<pre class="code asm">                                       <span class="co1">; Basic Block Input Regs: eax -  Killed Regs: &lt;nothing&gt;</span>
<span class="co2">000414cf</span> 80B85AA00B0000                  <span class="kw1">cmp</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">eax</span><span class="sy1">-</span><span class="nu0">0x412ae</span><span class="sy1">+</span>_gTrialPeriodExpiredFlag<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x0</span>
<span class="co2">000414d6</span> 750A                            <span class="kw1">jne</span>        <span class="nu0">0x414E2</span>
                                       <span class="co1">; Basic Block Input Regs: eax esi -  Killed Regs: esi edi</span>
<span class="co2">000414d8</span> 31F6                            <span class="kw1">xor</span>        <span class="kw4">esi</span><span class="sy1">,</span> <span class="kw4">esi</span>
<span class="co2">000414da</span> 8BB87E1D0B00                    <span class="kw1">mov</span>        <span class="kw4">edi</span><span class="sy1">,</span> <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">eax</span><span class="sy1">-</span><span class="nu0">0x412ae</span><span class="sy1">+</span><span class="nu0">0xF302C</span><span class="br0">&#93;</span>
<span class="co2">000414e0</span> EB1E                            <span class="kw1">jmp</span>        <span class="nu0">0x41500</span>
                                       <span class="co1">; Basic Block Input Regs: eax esi -  Killed Regs: esi edi</span>
<span class="co2">000414e2</span> 89C7                            <span class="kw1">mov</span>        <span class="kw4">edi</span><span class="sy1">,</span> <span class="kw4">eax</span>                              <span class="co1">; XREF=0x414d6</span>
<span class="co2">000414e4</span> E847570000                      <span class="kw1">call</span>       _DisplayTrialPeriodExpiredMessage_46c30
<span class="co2">000414e9</span> 31F6                            <span class="kw1">xor</span>        <span class="kw4">esi</span><span class="sy1">,</span> <span class="kw4">esi</span>
<span class="co2">000414eb</span> 8BBF7E1D0B00                    <span class="kw1">mov</span>        <span class="kw4">edi</span><span class="sy1">,</span> <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">edi</span><span class="sy1">+</span><span class="nu0">0xB1D7E</span><span class="br0">&#93;</span>
<span class="co2">000414f1</span> 6666666666662E0F1F840000000000  <span class="kw1">nop</span>        <span class="kw6">word</span> <span class="br0">&#91;</span><span class="kw4">cs</span><span class="sy1">:</span><span class="kw4">eax</span><span class="sy1">+</span><span class="kw4">eax</span><span class="sy1">-</span><span class="nu0">0x412ae</span><span class="sy1">+</span><span class="nu0">0x412AE</span><span class="br0">&#93;</span>
                                       <span class="co1">; Basic Block Input Regs: edi -  Killed Regs: &lt;nothing&gt;</span>
<span class="co2">00041500</span> 803F00                          <span class="kw1">cmp</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">edi</span><span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x0</span>                    <span class="co1">; XREF=0x414e0, 0x41535</span>
<span class="co2">00041503</span> <span class="nu0">7422</span>                            <span class="kw1">je</span>         <span class="nu0">0x41527</span></pre>

<p>
Where we <code>nop</code> the <code>jne</code> instead of replacing it the jump. The conditional is inverted in this case.
</p>

<p>
More of turning to <code>jmp</code>:
</p>
<pre class="code asm">                                       <span class="co1">; Basic Block Input Regs: ebx esi -  Killed Regs: edi</span>
<span class="co2">00068443</span> 80BEF730090000                  <span class="kw1">cmp</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">esi</span><span class="sy1">-</span><span class="nu0">0x68211</span><span class="sy1">+</span>_gTrialPeriodExpiredFlag<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x0</span> <span class="co1">; XREF=0x68437</span>
<span class="co2">0006844a</span> 6689DF                          <span class="kw1">mov</span>        <span class="kw4">di</span><span class="sy1">,</span> <span class="kw4">bx</span>
<span class="co2">0006844d</span> 0F841F010000                    <span class="kw1">je</span>         <span class="nu0">0x68572</span>
                                       <span class="co1">; Basic Block Input Regs: eax ebx ebp -  Killed Regs: eax ecx ebx esp ebp esi edi</span>
<span class="co2">00068453</span> E8F8E70600                      <span class="kw1">call</span>       imp___symbol_stub__CFBundleGetMainBundle
<span class="co2">00068458</span> 8D8EDF170900                    <span class="kw1">lea</span>        <span class="kw4">ecx</span><span class="sy1">,</span> <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">esi</span><span class="sy1">-</span><span class="nu0">0x68211</span><span class="sy1">+</span>cfstring_TRIAL_PERIOD_EXPIRED<span class="br0">&#93;</span> <span class="co1">; @&quot;TRIAL PERIOD EXPIRED&quot;</span></pre>

<p>
And again:
</p>
<pre class="code asm"><span class="co2">00067d35</span> 80B87737090000                  <span class="kw1">cmp</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">eax</span><span class="sy1">-</span><span class="nu0">0x67b91</span><span class="sy1">+</span>_gTrialPeriodExpiredFlag<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x0</span>
<span class="co2">00067d3c</span> 89D9                            <span class="kw1">mov</span>        <span class="kw4">ecx</span><span class="sy1">,</span> <span class="kw4">ebx</span>
<span class="co2">00067d3e</span> <span class="nu0">740F</span>                            <span class="kw1">je</span>         <span class="nu0">0x67D4F</span>
                                       <span class="co1">; Basic Block Input Regs: &lt;nothing&gt; -  Killed Regs: ebp</span>
<span class="co2">00067d40</span> 66838526FFFFFF28                <span class="kw1">add</span>        <span class="kw6">word</span> <span class="br0">&#91;</span><span class="kw4">ss</span><span class="sy1">:</span><span class="kw4">ebp</span><span class="sy1">-</span><span class="nu0">0x128</span><span class="sy1">+</span>var_78<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x28</span>
<span class="co2">00067d48</span> 66D1A524FFFFFF                  <span class="kw1">shl</span>        <span class="kw6">word</span> <span class="br0">&#91;</span><span class="kw4">ss</span><span class="sy1">:</span><span class="kw4">ebp</span><span class="sy1">-</span><span class="nu0">0x128</span><span class="sy1">+</span>var_76<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x1</span>
                                       <span class="co1">; Basic Block Input Regs: eax ecx edi -  Killed Regs: eax ebx ebp esi</span>
<span class="co2">00067d4f</span> 89C6                            <span class="kw1">mov</span>        <span class="kw4">esi</span><span class="sy1">,</span> <span class="kw4">eax</span>                              <span class="co1">; XREF=0x67d3e</span></pre>

<p>
Finally, we even set it to <code>0x0</code>:
</p>
<pre class="code asm"><span class="co2">0003de3d</span> <span class="nu0">7408</span>                            <span class="kw1">je</span>         <span class="nu0">0x3DE47</span>
                                       <span class="co1">; Basic Block Input Regs: eax -  Killed Regs: esp</span>
<span class="co2">0003de3f</span> <span class="nu0">890424</span>                          <span class="kw1">mov</span>        <span class="kw6">dword</span> <span class="br0">&#91;</span><span class="kw4">ss</span><span class="sy1">:</span><span class="kw4">esp</span><span class="br0">&#93;</span><span class="sy1">,</span> <span class="kw4">eax</span>
<span class="co2">0003de42</span> E87B8E0900                      <span class="kw1">call</span>       imp___symbol_stub__CFRelease
                                       <span class="co1">; Basic Block Input Regs: ebp esi -  Killed Regs: eax ecx esp edi</span>
<span class="co2">0003de47</span> C68787DB0B0000                  <span class="kw1">mov</span>        <span class="kw6">byte</span> <span class="br0">&#91;</span><span class="kw4">ds</span><span class="sy1">:</span><span class="kw4">edi</span><span class="sy1">-</span><span class="nu0">0x3d781</span><span class="sy1">+</span>_gTrialPeriodExpiredFlag<span class="br0">&#93;</span><span class="sy1">,</span> <span class="nu0">0x0</span> <span class="co1">; XREF=0x3de3d</span></pre>

<p>
by replacing the <code>je</code> at <code>0x3de3d</code> with a <code>jmp</code>.
</p>

</div>

                    <!-- wikipage stop -->
                                    </div>

                            </div></div><!-- /content -->

            <hr class="a11y" />

            <div class="docInfo"><bdi>cracks/securityspy.txt</bdi> · Last modified: 2022/04/19 09:28 (external edit)</div>

            <!-- PAGE ACTIONS -->
            <!-- <div id="dokuwiki__pagetools">
                <h3 class="a11y">Page Tools</h3>
                <div class="tools">
                    <ul>
                        <li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy?do=revisions"  class="action revs" accesskey="o" rel="nofollow" title="Revisions [O]"><span>Revisions</span></a></li><li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy?do=backlink"  class="action backlink" rel="nofollow" title="Backlinks"><span>Backlinks</span></a></li><li><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy?do=export_pdf"  class="action export_pdf" rel="nofollow" title="Export to PDF"><span>Export to PDF</span></a></li><li><a href="#dokuwiki__top"  class="action top" accesskey="t" rel="nofollow" title="Back to top [T]"><span>Back to top</span></a></li>                    </ul>
                </div>
            </div>
        </div>--><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer">
    <!-- <div class="buttons">
                <a href="http://www.dokuwiki.org/donate" title="Donate" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="http://www.php.net" title="Powered by PHP" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="http://dokuwiki.org/" title="Driven by DokuWiki" ><img
            src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/tpl/was/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" /></a>
    </div> -->

		<!-- BREADCRUMBS -->
					<div class="breadcrumbs">
									<div class="youarehere"><span class="bchead">You are here: </span><span class="home"><bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" class="wikilink1" title="start" data-wiki-id="start">start</a></bdi></span> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks" class="wikilink1" title="cracks" data-wiki-id="cracks">cracks</a></bdi> / <bdi><a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy" class="wikilink1" title="cracks:securityspy" data-wiki-id="cracks:securityspy">securityspy</a></bdi></div>
											</div>
		
		<!-- ********** BOTTOM BAR ********** -->
		<div class="bar" id="bar__bottom">
		  <div class="bar-left" id="bar__bottomleft">
			<form class="button btn_login" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy"><div class="no"><input type="hidden" name="do" value="login" /><input type="hidden" name="sectok" value="" /><button type="submit" title="Log In">Log In</button></div></form>						<form class="button btn_revs" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy"><div class="no"><input type="hidden" name="do" value="revisions" /><button type="submit" accesskey="o" title="Revisions [O]">Revisions</button></div></form>			                        <form class="button btn_pdf" action="?do=export_pdf" method="POST">
                            <button type="submit" title="PDF">PDF</button>
                        </form>
		  </div>
		  <div class="bar-center">
                        <form class="button btn_home" action="/" method="POST">
                            <button type="submit" title="Home">Home</button>
                        </form>
			<form action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/start" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="cracks:securityspy" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Search" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Search">Search</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>			<!-- <form id="osssearchform" method="get" action="renderer">
        <input type="hidden" name="use" value="grimore.org">
        <input type="hidden" name="name" value="default">
        <input type="text" id="osssearchbox" name="query">
        <input type="hidden" name="login" value="search">
        <input type="hidden" name="key" value="1a5f74ab3f4df6ce883c4c158540e25e">
        <input type="submit" value="Search">
</form>
 -->
		  </div>
		  <div class="bar-right" id="bar__bottomright">
                        <form class="button btn_contact" action="mailto:%6F%66%66%69%63%65%40%67%72%69%6D%6F%72%65%2E%6F%72%67" method="POST">
                            <button type="submit" title="Contact">Contact</button>
                        </form>
                        <form class="button btn_news" action="/feed.php?mode=recent&amp;type=rss" method="POST">
                            <button type="submit" title="News">News</button>
                        </form>
			<form class="button btn_admin" method="get" action="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/cracks/securityspy"><div class="no"><input type="hidden" name="do" value="admin" /><button type="submit" title="Admin">Admin</button></div></form>								  </div>
		  		</div>

		
</div><!-- /footer -->

<div style="text-align: center;">
    <div style="display:inline-block;">
      <p>
        <a href="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion">
          <img src="/lib/tpl/was/images/button-tor.png" alt="Access website using Tor" />
        </a> 
        <a href="http://ioujrf2uwqairs7l3vyvqp7n2pia3x3wg5w5qtcqvg32zezuezza.b32.i2p/" />
          <img src="/lib/tpl/was/images/button-i2p.png" alt="Access website using i2p" />
        </a>
        <a href="http://pgp.grimore.org/" />
          <img src="/lib/tpl/was/images/button-pgp.png" alt="Wizardry and Steamworks PGP Key" />
        </a>
      </p>
    </div>
<!--    <div style="display:inline-block;">
      <p>
        <a href="http://ij4lpzuyyng6cc4jw5mxibcyjv4rx4uk6x5jijoduglkgjh7mmya.b32.i2p">
          <img src="/lib/tpl/was/images/button-i2p.png" alt="Access website using i2p" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="http://cydia.grimore.org/">
          <img src="/lib/tpl/was/images/button-cydia.png" alt="Wizardry and Steamworks Cydia Repository" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="http://debian.grimore.org/">
          <img src="/lib/tpl/was/images/button-debian.png" alt="Wizardry and Steamworks Debian Repository" />
        </a> 
      </p>
    </div>
    <div style="display:inline-block;">
      <p>
        <a href="/opt/pasteboard/" rel="external nofollow">
          <img src="/lib/tpl/was/images/button-live.png" alt="Live Pasteboard" />
        </a> 
      </p>
    </div> -->
    
<br/>

    <p>
      For the copyright, license, warranty and privacy terms for the usage of this website please see the <a
      href="/wiki:license">license</a>, <a href="/wiki:privacy">privacy</a>, <a
      href="/wiki:copyright">copyright</a>
      and the <a href="/wiki:plagiarism">plagiarism</a> pages.
    </p>
</div>
    </div></div><!-- /site -->

    <div class="no"><img src="http://3wymlmcsvxiaqzmbepsdawqpk6o2qsk65jhms72qqjulk5u4bgmvs3qd.onion/lib/exe/taskrunner.php?id=cracks%3Asecurityspy&amp;1657302566" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div>    <!--[if lte IE 8 ]></div><![endif]-->
</body>
</html>
